Imports System.Data
Imports System.Data.OleDb
Imports System
Imports M1SubGetData
Imports M1SubUpInsData
Imports System.Collections
Imports System.IO.StringWriter
Imports System.Math
Imports System.Web.UI.HtmlTextWriter
Partial Class Pages_Market1_CAGR_PivotReport
    Inherits System.Web.UI.Page
#Region "Get Set Variables"
    Dim _lErrorLble As Label
    Dim _iUserId As Integer
    Dim _strUserRole As String
    Dim _btnLogOff As ImageButton
    Dim _btnUpdate As ImageButton
    Dim _divMainHeading As HtmlGenericControl
    Dim _ctlContentPlaceHolder As ContentPlaceHolder
    Dim engmetId As String = 1
    Dim _iRepId As Integer
    Dim _btnChart As ImageButton

    Public Property REPId() As Integer
        Get
            Return _iRepId
        End Get
        Set(ByVal Value As Integer)
            _iRepId = Value
        End Set
    End Property

    Public Property ErrorLable() As Label
        Get

            Return _lErrorLble
        End Get
        Set(ByVal Value As Label)
            _lErrorLble = Value
        End Set
    End Property

    Public Property UserId() As Integer
        Get
            Return _iUserId
        End Get
        Set(ByVal Value As Integer)
            _iUserId = Value
        End Set
    End Property

    Public Property UserRole() As String
        Get
            Return _strUserRole
        End Get
        Set(ByVal Value As String)
            _strUserRole = Value
        End Set
    End Property

    Public Property LogOffbtn() As ImageButton
        Get
            Return _btnLogOff
        End Get
        Set(ByVal value As ImageButton)
            _btnLogOff = value
        End Set
    End Property

    Public Property Updatebtn() As ImageButton
        Get
            Return _btnUpdate
        End Get
        Set(ByVal value As ImageButton)
            _btnUpdate = value
        End Set
    End Property

    Public Property MainHeading() As HtmlGenericControl
        Get
            Return _divMainHeading
        End Get
        Set(ByVal value As HtmlGenericControl)
            _divMainHeading = value
        End Set
    End Property

    Public Property ctlContentPlaceHolder() As ContentPlaceHolder
        Get
            Return _ctlContentPlaceHolder
        End Get
        Set(ByVal value As ContentPlaceHolder)
            _ctlContentPlaceHolder = value
        End Set
    End Property

    Public Property Chartbtn() As ImageButton
        Get
            Return _btnChart
        End Get
        Set(ByVal value As ImageButton)
            _btnChart = value
        End Set
    End Property

#End Region

#Region "MastePage Content Variables"

    Protected Sub GetMasterPageControls()
        GetErrorLable()
        GetLogOffbtn()
        GetUpdatebtn()
        GetMainHeadingdiv()
        GetGraphbtn()

        'GetContentPlaceHolder()
    End Sub

    Protected Sub GetGraphbtn()
        Chartbtn = Page.Master.FindControl("imgGraph")
        Chartbtn.Visible = True
        Chartbtn.OnClientClick = "return Chart('ChartReport.aspx?RepID=" + Request.QueryString("RepId").ToString() + "&Type=Prop','PivotChart');"

        ' AddHandler Chartbtn.Click, AddressOf Chartbtn_Click
    End Sub

    Protected Sub GetErrorLable()
        ErrorLable = Page.Master.FindControl("lblError")
        ErrorLable.Text = String.Empty
    End Sub

    Protected Sub GetLogOffbtn()
        LogOffbtn = Page.Master.FindControl("imgLogoff")
        LogOffbtn.Visible = False
    End Sub

    Protected Sub GetUpdatebtn()
        Updatebtn = Page.Master.FindControl("imgUpdate")
        Updatebtn.Visible = True
        AddHandler Updatebtn.Click, AddressOf Update_Click
    End Sub

    Protected Sub GetMainHeadingdiv()
        MainHeading = Page.Master.FindControl("divMainHeading")
        MainHeading.Attributes.Add("onmouseover", "Tip('Market1 Subscription Reports')")
        MainHeading.Attributes.Add("onmouseout", "UnTip()")
        ' MainHeading.InnerHtml = "Market1 Reports"

    End Sub

    Protected Sub GetContentPlaceHolder()
        ctlContentPlaceHolder = Page.Master.FindControl("Market1ContentPlaceHolder")
    End Sub

#End Region

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Try
            GetMasterPageControls()
            REPId = Request.QueryString("RepId").ToString()
            hidReportVal.Value = REPId
            If Not IsPostBack Then
                'tblCAGR = New Table()
                tblCAGR.Rows.Clear()
                Session("dsPref" + REPId.ToString()) = ""
                Session("dsRows" + REPId.ToString()) = ""
                Session("dsColumns" + REPId.ToString()) = ""
                Session("dsFilters" + REPId.ToString()) = ""
                Session("dsData" + REPId.ToString()) = ""
                Session("PrefChange" + REPId.ToString()) = "0"
                hidReport.Value = "0"
                hidReportData.Value = "0"
                GetReportDetails()
                GetPageDetails()

                Dim dsRpt As New DataSet
                Dim objUpIns As New M1SubUpInsData.UpdateInsert()
                Dim objGetData As New Selectdata()
                dsRpt = objGetData.GetReportDetails(REPId)
                If Session("UpIns") Is Nothing Then
                    objUpIns.InsertLog(Session("UserId"), Session("MLogInLog"), "4", REPId.ToString(), "Pivot", dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString(), "2", REPId.ToString(), Session.SessionID)
                Else
                    Session("UpIns") = Nothing
                End If
               

                rdbActual.Checked = True
                hidReportIDD.Value = "0"
            End If
            'Else
            '    If Session("PrefChange" + REPId.ToString()) = "1" Then
            '        hidReport.Value = "0"
            '        hidReportData.Value = "0"
            '        Session("PrefChange" + REPId.ToString()) = "0"
            '    End If
            '    If hidReportIDD.Value <> "0" Then
            '        Session("dsPref" + REPId.ToString()) = ""
            '        Session("dsRows" + REPId.ToString()) = ""
            '        Session("dsColumns" + REPId.ToString()) = ""
            '        Session("dsFilters" + REPId.ToString()) = ""
            '        Session("dsData" + REPId.ToString()) = ""
            '        hidReport.Value = "0"
            '        hidReportData.Value = "0"
            '        hidReportIDD.Value = "0"
            '    End If
            'End If
        Catch ex As Exception
        End Try
    End Sub
    Protected Sub GetReportDetails()
        Dim objGetData As New M1GetData.Selectdata()
        Dim ds As New DataSet
        Try
            If Request.QueryString("Type").ToString() = "Base" Then
                'ds = objGetData.GetBaseReportsByRptId(REPId.ToString().ToString())
                ds = objGetData.GetUserCustomReportsByRptId(REPId.ToString())
                lblheading.Text = "Base Report Results"
            Else
                ds = objGetData.GetUserCustomReportsByRptId(REPId.ToString())
                lblheading.Text = "Proprietary Report Results"
            End If
            If ds.Tables(0).Rows.Count > 0 Then
                hidReportType.Value = ds.Tables(0).Rows(0).Item("RPTTYPE").ToString()
                lblReportID.Text = ds.Tables(0).Rows(0).Item("REPORTID").ToString()
                'If ds.Tables(0).Rows(0).Item("RPTTYPEDES").ToString() = "GROUP" Then
                'lblReportType.Text = ds.Tables(0).Rows(0).Item("RPTTYPE").ToString() + " (MOD)"
                ' Else
                lblReportType.Text = ds.Tables(0).Rows(0).Item("RPTTYPE").ToString() + " (" + ds.Tables(0).Rows(0).Item("RPTTYPEDES").ToString() + ")"
                ' End If

                lblReportDe2.Text = ds.Tables(0).Rows(0).Item("REPORTNAME").ToString()
            End If
        Catch ex As Exception
            ErrorLable.Text = "Error:GetReportDetails:" + ex.Message.ToString()
        End Try
    End Sub
    Protected Sub GetPageDetails()
        Dim objGetData As New Selectdata()
        Dim objUpIns As New UpdateInsert()
        Dim dsRpt As New DataSet()
        Dim rptType As String = String.Empty
        Try
            rptType = Request.QueryString("Type").ToString()
            If rptType = "Base" Then
                dsRpt = objGetData.GetBaseReportsByRptId(REPId.ToString())
            Else
                dsRpt = objGetData.GetUserCustomReportsByRptId(REPId.ToString())
            End If


            If dsRpt.Tables(0).Rows(0)("RPTTYPE").ToString() = "PIVOT" Then
                'objUpIns.InsertLog(Session("UserId"), Session("MLogInLog"), "4", REPId.ToString(), "Pivot", dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString(), "2", REPId.ToString(), Session.SessionID)


                If REPId = 4021 Or REPId = 4032 Then
                    SetUniformReportProdPackMat(dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString(), rptType)
                ElseIf REPId = 4044 Or REPId = 4140 Then
                    SetUniformReportProdPackMatEMEA(dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString(), rptType)
                ElseIf REPId = 4023 Or REPId = 4033 Then
                    SetUniformReport_MAT_PACK_PROD(dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString(), rptType)
                ElseIf REPId = 4025 Or REPId = 4034 Then
                    SetUniformReportPACKPRODMAT_CNTRY(dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString(), rptType)
                ElseIf REPId = 4024 Or REPId = 4035 Then
                    SetUniformReportPACKPRODMAT_REGION(dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString(), rptType)
                ElseIf REPId = 4026 Or REPId = 4036 Then
                    SetUniformReportByRegion(dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString(), rptType)
                ElseIf REPId = 4027 Or REPId = 4037 Then
                    SetUniformReportByCountry(dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString(), rptType)
                ElseIf REPId = 4138 Then
                    SetUniformReportProdRegBuyers(dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString(), rptType)
                ElseIf dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "GROUP" Then
                    SetPivotGrpReportFrameWorkTemp(REPId.ToString())
                ElseIf dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "PROD" Then
                    SetPivotProdReportFrameWorkTemp(REPId.ToString())
                ElseIf dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "MAT" Then
                    SetPivotMatReportFrameWorkTemp(REPId.ToString())
                ElseIf dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "COMPONENT" Then
                    SetPivotCompReportFrameWorkTemp(REPId.ToString())
                ElseIf dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "REGION" Then
                    SetPivotRegReportFrameWorkTemp(REPId.ToString())
                ElseIf dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "PACK" Then
                    SetPivotPackReportFrameWorkTemp(REPId.ToString())
                ElseIf dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "CNTRY" Then
                    SetPivotCntryReportFrameWorkTemp(REPId.ToString())
                End If


                'SetUniformReport_MAT_PACK_PROD(dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString(), rptType)
            ElseIf dsRpt.Tables(0).Rows(0)("RPTTYPE").ToString() = "MIXED" Then
                SetMixedReport(dsRpt.Tables(0).Rows(0)("RPTTYPEDES").ToString(), rptType)
            End If
        Catch ex As Exception
            ErrorLable.Text = "Error:GetPageDetails:" + ex.Message.ToString() + ""
        End Try
    End Sub

    Private Sub SetUniformReportByCountry(ByVal reportDes As String, ByVal rptType As String)
        Dim objGetData As New Selectdata()
        Dim dsRptRws As New DataSet()

        Dim dsRptFilter As New DataSet()

        Dim dsRptFilterValue As New DataSet()
        Dim dsUnitPref As New DataSet
        Dim ColCnt As New Integer
        Dim RowCnt As New Integer
        Dim FiltCnt As New Integer
        Dim groupId As String = String.Empty
        Dim Dr() As DataRow
        Dim i As New Integer
        Dim j As New Integer
        Dim l As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim lbl As New Label
        Dim Fact As New Decimal
        Dim Link As New HyperLink
        Dim hyd As New HiddenField
        Dim CountryFilter As Boolean
        Dim k1 As Integer = 0
        Dim ProdId As String = ""
        Dim ProdTbl(11) As String
        Dim PackId As String = ""
        Dim Unit As String = ""
        Dim YearId As String = ""
        Dim dValue As Integer = 1
        Dim dsTables As New DataSet
        Dim dvTables As New DataView
        Dim dtTables As New DataTable
        Dim dsProd As New DataSet
        Dim dvProd As New DataView
        Dim dtProd As New DataTable
        Dim dsRptAct As New DataSet()
        Dim dvRptAct As New DataView()
        Dim dtRptAct As New DataTable()
        Dim dsRow As New DataSet
        Dim dvRow As New DataView
        Dim dtRow As New DataTable
        Dim dsPack As New DataSet
        Dim dvPack As New DataView
        Dim dtPack As New DataTable
        Dim dsRptCols As New DataSet()
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsCoun As New DataSet

        If rdbActual.Checked = True Then
            dValue = 1
        ElseIf rdbMil.Checked = True Then
            dValue = 1000000
        ElseIf rdbBil.Checked = True Then
            dValue = 1000000000
        ElseIf rdbThou.Checked = True Then
            dValue = 1000
        End If


        If hidReport.Value <> "0" Then
            dsUnitPref = Session("dsPref" + REPId.ToString())
            dsRptRws = Session("dsRows" + REPId.ToString())
            dsRptCols = Session("dsColumns" + REPId.ToString())
            dsRptFilter = Session("dsFilters" + REPId.ToString())
        Else
            dsUnitPref = objGetData.GetPref(REPId.ToString())
            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            dsRptCols = objGetData.GetUsersDynamicReportCols(REPId.ToString())
            dsRptFilter = objGetData.GetUsersReportFilters(REPId.ToString())

            Session("dsPref" + REPId.ToString()) = dsUnitPref
            Session("dsRows" + REPId.ToString()) = dsRptRws
            Session("dsColumns" + REPId.ToString()) = dsRptCols
            Session("dsFilters" + REPId.ToString()) = dsRptFilter

            hidReport.Value = "1"
        End If
        Unit = objGetData.GetPivotUnit(REPId.ToString())
        For a = 0 To dsRptCols.Tables(0).Rows.Count - 1
            If dsRptCols.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                YearId = YearId + "" + dsRptCols.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
            End If
        Next
        YearId = YearId.Remove(YearId.Length - 1)

        For a = 0 To dsRptFilter.Tables(0).Rows.Count - 1
            If dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    For b = 0 To dsTables.Tables(0).Rows.Count - 1
                        ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                        ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                        RowCnt += 1
                    Next
                    dtTables = dsTables.Tables(0)
                    ProdId = ProdId.Remove(ProdId.Length - 1)
                Else
                    ProdId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                    dtTables = dvTables.ToTable()
                    ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                    RowCnt += 1
                End If
            ElseIf dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    If ProdId <> "" Then
                        dsPack = objGetData.GetPivotPackage(ProdId)
                    Else

                    End If
                    For b = 0 To dsPack.Tables(0).Rows.Count - 1
                        PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("ID").ToString() + ","
                        'RowCnt += 1
                    Next
                    PackId = PackId.Remove(PackId.Length - 1)
                Else
                    PackId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsPack = objGetData.GetProductTypeByPack(PackId)
                End If

            End If
        Next

        groupId = Session("M1SubGroupId").ToString()
        dsRptAct = objGetData.GetPivotReportDataREGION(ProdTbl, "COUNTRY", YearId, PackId, Unit.ToString(), dsTables.Tables(0).Rows.Count, 639)
        dsProd = objGetData.GetProductDescription(ProdId)
        dsRow = objGetData.GetPivotMaterialss(ProdId, PackId)
        dsCoun = objGetData.GetPivotCountry()

        If dsRptCols.Tables.Count > 0 Then
            ColCnt = dsRptCols.Tables(0).Rows.Count
        End If
        If dsRptFilter.Tables.Count > 0 Then
            FiltCnt = dsRptFilter.Tables(0).Rows.Count
        End If

        Dim count As Integer = FiltCnt + ColCnt

        tblCAGR.Rows.Clear()
        'filter row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                For l = 0 To FiltCnt - 1
                    Link = New HyperLink
                    hyd = New HiddenField
                    lbl = New Label
                    Link.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    lbl.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    hyd.Value = dsRptFilter.Tables(0).Rows(l).Item("USERREPORTFILTERID").ToString()
                    Link.ID = "Filter_" + (l + 1).ToString()
                    hyd.ID = "Filter_ID_" + (l + 1).ToString()
                    Link.CssClass = "LinkM"

                    GetFilterLink(dsRptFilter.Tables(0).Rows(l).Item("FILTERSEQUENCE").ToString(), Link, dsRptFilter.Tables(0).Rows(l).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                    If rptType = "Base" Then
                        HeaderTd.Controls.Add(lbl)
                    Else
                        HeaderTd.Controls.Add(Link)
                    End If
                    'HeaderTd.Controls.Add(lbl)
                    HeaderTd.Controls.Add(hyd)
                Next
                HeaderTdSetting(HeaderTd, "200px", "", "1")
            Else
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)

        'Hedaer Row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                lbl = New Label
                If reportDes = "REGION" Then
                    lbl.Text = "GEOGRAPHIC REGIONS"
                ElseIf reportDes = "PACKGRP" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "PROD" Then
                    lbl.Text = "PRODUCTS"
                ElseIf reportDes = "MAT" Then
                    lbl.Text = "MATERIALS"
                ElseIf reportDes = "PACK" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "GROUP" Then
                    lbl.Text = "GROUP111"
                ElseIf reportDes = "CNTRY" Then
                    lbl.Text = "COUNTRIES"
                End If
                HeaderTd.Controls.Add(lbl)
                HeaderTdSetting(HeaderTd, "200px", "", "1")
            Else
                hyd = New HiddenField
                Link = New HyperLink
                lbl = New Label
                Dim k As New Integer
                k = j - 1

                If dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString() + "(" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE1").ToString() + "/" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE2").ToString() + ")"
                Else
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString()
                End If
                lbl.Text = Link.Text
                Link.ID = "Column_" + k.ToString()
                hyd.ID = "Column_ID_" + k.ToString()
                hyd.Value = dsRptCols.Tables(0).Rows(k).Item("USERREPORTCOLUMNID").ToString()
                Link.CssClass = "LinkM"
                GetColLink(dsRptCols.Tables(0).Rows(k).Item("COLUMNSEQUENCE").ToString(), Link, dsRptCols.Tables(0).Rows(k).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                If rptType = "Base" Then
                    HeaderTd.Controls.Add(lbl)
                Else
                    HeaderTd.Controls.Add(Link)
                End If

                HeaderTd.Controls.Add(hyd)
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)


        'SET THE UNIT & SUMMERY PART
        For i = 0 To 0
            Tr = New TableRow()
            For j = 0 To ColCnt
                Td = New TableCell()
                lbl = New Label
                If j = 0 Then
                    HeaderTdSetting(Td, "200px", "", "1")
                    If i = 0 Then
                        lbl.Text = "UNIT"
                    End If
                Else
                    HeaderTdSetting(Td, "100px", "", "1")
                    If i = 0 Then

                        lbl.ID = "lbl_" + j.ToString()
                        If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                            lbl.Text = "(%)"
                        Else
                            'lbl.Text = "(" + dsUnitPref.Tables(0).Rows(0).Item("TITLE1").ToString() + ")"
                            lbl.Text = "(US$)"

                            hidUnitShort.Value = lbl.Text
                        End If
                        Td.Style.Add("text-align", "Center")

                    End If
                End If

                Td.Font.Size = 8
                Td.Font.Name = "Verdana"
                Td.Font.Bold = False
                Td.Controls.Add(lbl)
                Tr.Controls.Add(Td)
            Next
            tblCAGR.Controls.Add(Tr)
        Next

        dvProd = dsProd.Tables(0).DefaultView
        dvRptAct = dsRptAct.Tables(0).DefaultView
        dvRow = dsRow.Tables(0).DefaultView
        dvPack = dsPack.Tables(0).DefaultView
        dvRptCols1 = dsRptCols.Tables(0).DefaultView
        dvRptCols2 = dsRptCols.Tables(0).DefaultView

        Dim btn As New Button
        'Inner Row
        For i = 0 To RowCnt - 1
            dvProd.RowFilter = "FACTID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString()
            dtProd = dvProd.ToTable()
            dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString()
            dtRptAct = dvRptAct.ToTable()

            If dtRptAct.Rows.Count > 0 Then
                For c = 0 To 0
                    Tr = New TableRow()
                    For j = 0 To ColCnt
                        Td = New TableCell()
                        If j = 0 Then
                            HeaderTdSetting(Td, "200px", "", "1")
                            btn = New Button
                            btn.ID = "btn" + dtProd.Rows(0).Item("CATEGORYNAME").ToString() + "_" + (i + 1).ToString()
                            btn.Text = "+"
                            btn.OnClientClick = "javascript:return showLines('" + btn.ID + "');"
                            lbl = New Label
                            lbl.Text = "<span class='icon'>+</span><b> " + dtProd.Rows(0).Item("CATEGORYNAME").ToString() ' dtRow.Rows(a).Item("DES").ToString() '+ "(" + dsRptRws.Tables(0).Rows(i).Item("UNITSHRT").ToString() + ")"

                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            'Td.Controls.Add(btn)
                            Td.Controls.Add(lbl)
                            Tr.Controls.Add(Td)
                            'tblCAGR.Controls.Add(Tr)
                        Else
                            HeaderTdSetting(Td, "150px", "", "1")
                            lbl = New Label
                            If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                Dim ProdCount As New Double
                                dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                            If Unit = 1 Then
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            ElseIf Unit = 2 Then
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            ElseIf Unit = 4 Then
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            Else
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            End If
                                        Else
                                            If Unit = 1 Then
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                            ElseIf Unit = 2 Then
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                            ElseIf Unit = 3 Then
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                            ElseIf Unit = 4 Then
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            Else
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            End If
                                        End If
                                        'ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    Next
                                End If
                                lbl.Text = ProdCount.ToString()
                            Else
                                Dim count1 As New Double
                                Dim count2 As New Double
                                Dim diff As New Double
                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                dtRptCols1 = dvRptCols1.ToTable()
                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                dtRptCols2 = dvRptCols2.ToTable()

                                dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                            If Unit = 1 Then
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            ElseIf Unit = 2 Then
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            ElseIf Unit = 4 Then
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            Else
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            End If
                                        Else
                                            If Unit = 1 Then
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                            ElseIf Unit = 2 Then
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                            ElseIf Unit = 3 Then
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                            ElseIf Unit = 4 Then
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            Else
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            End If
                                        End If
                                        'count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    Next
                                End If

                                dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                            If Unit = 1 Then
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            ElseIf Unit = 2 Then
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            ElseIf Unit = 4 Then
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            Else
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            End If
                                        Else
                                            If Unit = 1 Then
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                            ElseIf Unit = 2 Then
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                            ElseIf Unit = 3 Then
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                            ElseIf Unit = 4 Then
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            Else
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            End If
                                        End If
                                        'count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    Next
                                End If

                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                            End If

                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Right")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-right", "5px")
                            'Td.Controls.Add(lbl)
                            'Td.CssClass = "AlterNateColor2"
                            Tr.Controls.Add(Td)

                        End If
                    Next
                    Tr.CssClass = "header"
                    tblCAGR.Controls.Add(Tr)
                Next
                dvPack.RowFilter = "FACTID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString()
                dtPack = dvPack.ToTable()
                For a = 0 To dtPack.Rows.Count - 1
                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                    dtRptAct = dvRptAct.ToTable()
                    If dtRptAct.Rows.Count > 0 Then
                        Tr = New TableRow()
                        Tr.ID = dtProd.Rows(0).Item("CATEGORYNAME").ToString() + "_" + (a + 1).ToString()
                        For j = 0 To ColCnt
                            Td = New TableCell()
                            If j = 0 Then
                                HeaderTdSetting(Td, "200px", "", "1")
                                lbl = New Label
                                lbl.Text = dtPack.Rows(a).Item("VALUE").ToString()

                                Td.Style.Add("text-align", "Left")
                                Td.Font.Size = 10
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = True
                                Td.Style.Add("padding-left", "40px")
                                Td.Controls.Add(lbl)

                            Else
                                'HeaderTdSetting(Td, "150px", "", "1")
                                lbl = New Label
                                If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                    Dim PackCount As New Double
                                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        For l = 0 To dtRptAct.Rows.Count - 1
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If Unit = 1 Then
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf Unit = 2 Then
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf Unit = 4 Then
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If Unit = 1 Then
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                                ElseIf Unit = 2 Then
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                                ElseIf Unit = 3 Then
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                                ElseIf Unit = 4 Then
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                            'PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        Next
                                    End If
                                    lbl.Text = PackCount.ToString()

                                Else
                                    Dim count1 As New Double
                                    Dim count2 As New Double
                                    Dim diff As New Double
                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                    dtRptCols1 = dvRptCols1.ToTable()
                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                    dtRptCols2 = dvRptCols2.ToTable()

                                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        For l = 0 To dtRptAct.Rows.Count - 1
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If Unit = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf Unit = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf Unit = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If Unit = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                                ElseIf Unit = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                                ElseIf Unit = 3 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                                ElseIf Unit = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                            'count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        Next
                                    End If

                                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        For l = 0 To dtRptAct.Rows.Count - 1
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If Unit = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf Unit = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf Unit = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If Unit = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                                ElseIf Unit = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                                ElseIf Unit = 3 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                                ElseIf Unit = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                            'count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        Next
                                    End If

                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                End If

                                Td.Style.Add("text-align", "Right")
                                Td.Font.Size = 9
                                Td.Font.Name = "Verdana"
                                Td.Style.Add("color", "#660022")
                                Td.CssClass = "AlterNateColor2"
                                Td.Font.Bold = True
                                Td.Style.Add("padding-right", "5px")
                                Td.Controls.Add(lbl)

                            End If
                            Tr.Controls.Add(Td)

                        Next
                        Tr.CssClass = "com"
                        tblCAGR.Controls.Add(Tr)

                        dvRow.RowFilter = "PRODID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString() + " AND PACKTYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                        dtRow = dvRow.ToTable()

                        For b = 0 To dsCoun.Tables(0).Rows.Count - 1
                            dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND COUNTRYID=" + dsCoun.Tables(0).Rows(b).Item("COUNTRYID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                            dtRptAct = dvRptAct.ToTable()
                            If dtRptAct.Rows.Count > 0 Then
                                Tr = New TableRow()
                                For j = 0 To ColCnt
                                    Td = New TableCell()
                                    If j = 0 Then
                                        HeaderTdSetting(Td, "200px", "", "1")
                                        lbl = New Label
                                        lbl.Text = dsCoun.Tables(0).Rows(b).Item("COUNTRYDES").ToString() '+ "(" + dsRptRws.Tables(0).Rows(i).Item("UNITSHRT").ToString() + ")"

                                        Td.Style.Add("text-align", "Left")
                                        Td.Font.Size = 10
                                        Td.Font.Name = "Verdana"
                                        Td.Font.Bold = True
                                        Td.Style.Add("padding-left", "50px")
                                        Td.Controls.Add(lbl)
                                    Else
                                        If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                            dvRptAct.RowFilter = "YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + "AND CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND COUNTRYID=" + dsCoun.Tables(0).Rows(b).Item("COUNTRYID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                                            dtRptAct = dvRptAct.ToTable()
                                            If dtRptAct.Rows.Count > 0 Then
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If Unit = 1 Then
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    ElseIf Unit = 2 Then
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    ElseIf Unit = 4 Then
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    Else
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    End If
                                                Else
                                                    If Unit = 1 Then
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                                    ElseIf Unit = 2 Then
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                                    ElseIf Unit = 3 Then
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                                    ElseIf Unit = 4 Then
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    Else
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    End If
                                                End If
                                                'Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                            End If

                                        Else
                                            Dim count1 As New Double
                                            Dim count2 As New Double
                                            Dim diff As New Double
                                            dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                            dtRptCols1 = dvRptCols1.ToTable()
                                            dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                            dtRptCols2 = dvRptCols2.ToTable()

                                            dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND COUNTRYID=" + dsCoun.Tables(0).Rows(b).Item("COUNTRYID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                            dtRptAct = dvRptAct.ToTable()
                                            If dtRptAct.Rows.Count > 0 Then
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If Unit = 1 Then
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    ElseIf Unit = 2 Then
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    ElseIf Unit = 4 Then
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    Else
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    End If
                                                Else
                                                    If Unit = 1 Then
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                                    ElseIf Unit = 2 Then
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                                    ElseIf Unit = 3 Then
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                                    ElseIf Unit = 4 Then
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    Else
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    End If
                                                End If
                                                'count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                            End If

                                            dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND COUNTRYID=" + dsCoun.Tables(0).Rows(b).Item("COUNTRYID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                            dtRptAct = dvRptAct.ToTable()
                                            If dtRptAct.Rows.Count > 0 Then
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If Unit = 1 Then
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    ElseIf Unit = 2 Then
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    ElseIf Unit = 4 Then
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    Else
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    End If
                                                Else
                                                    If Unit = 1 Then
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                                    ElseIf Unit = 2 Then
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                                    ElseIf Unit = 3 Then
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                                    ElseIf Unit = 4 Then
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    Else
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    End If
                                                End If
                                                'count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                            End If

                                            diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                            Td.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        End If

                                        InnerTdSetting(Td, "", "Right")
                                        Td.CssClass = "AlterNateColor2"
                                    End If
                                    Td.Font.Size = 8.5
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = False
                                    Tr.Controls.Add(Td)
                                Next
                                Tr.CssClass = "com1"
                                tblCAGR.Controls.Add(Tr)
                            End If

                        Next
                    End If
                Next

            End If
        Next

        tblCAGR.Visible = True
    End Sub

    Private Sub SetUniformReportByRegion(ByVal reportDes As String, ByVal rptType As String)
        Dim objGetData As New Selectdata()
        Dim dsRptRws As New DataSet()

        Dim dsRptFilter As New DataSet()

        Dim dsRptFilterValue As New DataSet()
        Dim dsUnitPref As New DataSet
        Dim ColCnt As New Integer
        Dim RowCnt As New Integer
        Dim FiltCnt As New Integer
        Dim groupId As String = String.Empty
        Dim Dr() As DataRow
        Dim i As New Integer
        Dim j As New Integer
        Dim l As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim lbl As New Label
        Dim Fact As New Decimal
        Dim Link As New HyperLink
        Dim hyd As New HiddenField
        Dim CountryFilter As Boolean
        Dim k1 As Integer = 0
        Dim ProdId As String = ""
        Dim ProdTbl(11) As String
        Dim PackId As String = ""
        Dim Unit As String = ""
        Dim YearId As String = ""
        Dim dValue As Integer = 1
        Dim dsTables As New DataSet
        Dim dvTables As New DataView
        Dim dtTables As New DataTable
        Dim dsProd As New DataSet
        Dim dvProd As New DataView
        Dim dtProd As New DataTable
        Dim dsRptAct As New DataSet()
        Dim dvRptAct As New DataView()
        Dim dtRptAct As New DataTable()
        Dim dsRow As New DataSet
        Dim dvRow As New DataView
        Dim dtRow As New DataTable
        Dim dsPack As New DataSet
        Dim dvPack As New DataView
        Dim dtPack As New DataTable
        Dim dsRptCols As New DataSet()
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsCoun As New DataSet
        Dim dsReg As New DataSet
        Dim RegionSet As New Integer

        If rdbActual.Checked = True Then
            dValue = 1
        ElseIf rdbMil.Checked = True Then
            dValue = 1000000
        ElseIf rdbBil.Checked = True Then
            dValue = 1000000000
        ElseIf rdbThou.Checked = True Then
            dValue = 1000
        End If

        If hidReport.Value <> "0" Then
            dsUnitPref = Session("dsPref" + REPId.ToString())
            dsRptRws = Session("dsRows" + REPId.ToString())
            dsRptCols = Session("dsColumns" + REPId.ToString())
            dsRptFilter = Session("dsFilters" + REPId.ToString())
        Else
            dsUnitPref = objGetData.GetPref(REPId.ToString())
            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            dsRptCols = objGetData.GetUsersDynamicReportCols(REPId.ToString())
            dsRptFilter = objGetData.GetUsersReportFilters(REPId.ToString())

            Session("dsPref" + REPId.ToString()) = dsUnitPref
            Session("dsRows" + REPId.ToString()) = dsRptRws
            Session("dsColumns" + REPId.ToString()) = dsRptCols
            Session("dsFilters" + REPId.ToString()) = dsRptFilter

            hidReport.Value = "1"
        End If
        Unit = objGetData.GetPivotUnit(REPId.ToString())
        RegionSet = objGetData.GetPivotRegionset(REPId.ToString())
        dsReg = objGetData.GetPivotRegions(RegionSet.ToString())

        For a = 0 To dsRptCols.Tables(0).Rows.Count - 1
            If dsRptCols.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                YearId = YearId + "" + dsRptCols.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
            End If
        Next
        YearId = YearId.Remove(YearId.Length - 1)

        For a = 0 To dsRptFilter.Tables(0).Rows.Count - 1
            If dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    For b = 0 To dsTables.Tables(0).Rows.Count - 1
                        ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                        ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                        RowCnt += 1
                    Next
                    dtTables = dsTables.Tables(0)
                    ProdId = ProdId.Remove(ProdId.Length - 1)
                Else
                    ProdId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                    dtTables = dvTables.ToTable()
                    ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                    RowCnt += 1
                End If
            ElseIf dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    If ProdId <> "" Then
                        dsPack = objGetData.GetPivotPackage(ProdId)
                    Else
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                            ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            RowCnt += 1
                        Next
                        dtTables = dsTables.Tables(0)
                        ProdId = ProdId.Remove(ProdId.Length - 1)
                        dsPack = objGetData.GetPivotPackage(ProdId)
                    End If
                    For b = 0 To dsPack.Tables(0).Rows.Count - 1
                        PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("ID").ToString() + ","
                        'RowCnt += 1
                    Next
                    PackId = PackId.Remove(PackId.Length - 1)
                Else
                    PackId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsPack = objGetData.GetProductTypeByPack(PackId)
                End If

            End If
        Next

        groupId = Session("M1SubGroupId").ToString()
        dsRptAct = objGetData.GetPivotReportRegData(ProdTbl, YearId, PackId, Unit.ToString(), dsTables.Tables(0).Rows.Count, RegionSet.ToString())
        dsProd = objGetData.GetProductDescription(ProdId)
        dsRow = objGetData.GetPivotMaterialss(ProdId, PackId)
        dsCoun = objGetData.GetPivotCountry()

        If dsRptCols.Tables.Count > 0 Then
            ColCnt = dsRptCols.Tables(0).Rows.Count
        End If
        If dsRptFilter.Tables.Count > 0 Then
            FiltCnt = dsRptFilter.Tables(0).Rows.Count
        End If

        Dim count As Integer = FiltCnt + ColCnt

        tblCAGR.Rows.Clear()
        'filter row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                For l = 0 To FiltCnt - 1
                    Link = New HyperLink
                    hyd = New HiddenField
                    lbl = New Label
                    Link.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    lbl.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    hyd.Value = dsRptFilter.Tables(0).Rows(l).Item("USERREPORTFILTERID").ToString()
                    Link.ID = "Filter_" + (l + 1).ToString()
                    hyd.ID = "Filter_ID_" + (l + 1).ToString()
                    Link.CssClass = "LinkM"

                    GetFilterLink(dsRptFilter.Tables(0).Rows(l).Item("FILTERSEQUENCE").ToString(), Link, dsRptFilter.Tables(0).Rows(l).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                    If rptType = "Base" Then
                        HeaderTd.Controls.Add(lbl)
                    Else
                        HeaderTd.Controls.Add(Link)
                    End If
                    'HeaderTd.Controls.Add(lbl)
                    HeaderTd.Controls.Add(hyd)
                Next
                HeaderTdSetting(HeaderTd, "200px", "", "1")
            Else
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)

        'Hedaer Row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                lbl = New Label
                If reportDes = "REGION" Then
                    lbl.Text = "GEOGRAPHIC REGIONS"
                ElseIf reportDes = "PACKGRP" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "PROD" Then
                    lbl.Text = "PRODUCTS"
                ElseIf reportDes = "MAT" Then
                    lbl.Text = "MATERIALS"
                ElseIf reportDes = "PACK" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "GROUP" Then
                    lbl.Text = "GROUP"
                ElseIf reportDes = "CNTRY" Then
                    lbl.Text = "COUNTRIES"
                End If
                HeaderTd.Controls.Add(lbl)
                HeaderTdSetting(HeaderTd, "200px", "", "1")
            Else
                hyd = New HiddenField
                Link = New HyperLink
                lbl = New Label
                Dim k As New Integer
                k = j - 1

                If dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString() + "(" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE1").ToString() + "/" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE2").ToString() + ")"
                Else
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString()
                End If
                lbl.Text = Link.Text
                Link.ID = "Column_" + k.ToString()
                hyd.ID = "Column_ID_" + k.ToString()
                hyd.Value = dsRptCols.Tables(0).Rows(k).Item("USERREPORTCOLUMNID").ToString()
                Link.CssClass = "LinkM"
                GetColLink(dsRptCols.Tables(0).Rows(k).Item("COLUMNSEQUENCE").ToString(), Link, dsRptCols.Tables(0).Rows(k).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                If rptType = "Base" Then
                    HeaderTd.Controls.Add(lbl)
                Else
                    HeaderTd.Controls.Add(Link)
                End If

                HeaderTd.Controls.Add(hyd)
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)


        'SET THE UNIT & SUMMERY PART
        For i = 0 To 0
            Tr = New TableRow()
            For j = 0 To ColCnt
                Td = New TableCell()
                lbl = New Label
                If j = 0 Then
                    HeaderTdSetting(Td, "200px", "", "1")
                    If i = 0 Then
                        lbl.Text = "UNIT"
                    End If
                Else
                    HeaderTdSetting(Td, "100px", "", "1")
                    If i = 0 Then

                        lbl.ID = "lbl_" + j.ToString()
                        If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                            lbl.Text = "(%)"
                        Else
                            'If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                            '    lbl.Text = "(lb)" '"(" + dsRptRws.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                            'Else
                            '    lbl.Text = "(lb)" '"(" + dsRptRws.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                            'End If
                            'If Unit.ToString() = "1" Then
                            '    lbl.Text = "(lb)"
                            'ElseIf Unit.ToString() = "4" Then
                            '    lbl.Text = "(pack)"
                            'ElseIf Unit.ToString() = "5" Then
                            '    lbl.Text = "($)"
                            'End If
                            lbl.Text = "(" + dsUnitPref.Tables(0).Rows(0).Item("TITLE3").ToString() + ")"
                            hidUnitShort.Value = lbl.Text
                        End If
                        Td.Style.Add("text-align", "Center")

                    End If
                End If

                Td.Font.Size = 8
                Td.Font.Name = "Verdana"
                Td.Font.Bold = False
                Td.Controls.Add(lbl)
                Tr.Controls.Add(Td)
            Next
            tblCAGR.Controls.Add(Tr)
        Next

        dvProd = dsProd.Tables(0).DefaultView
        dvRptAct = dsRptAct.Tables(0).DefaultView
        dvRow = dsRow.Tables(0).DefaultView
        dvPack = dsPack.Tables(0).DefaultView
        dvRptCols1 = dsRptCols.Tables(0).DefaultView
        dvRptCols2 = dsRptCols.Tables(0).DefaultView

        Dim btn As New Button
        'Inner Row
        For i = 0 To RowCnt - 1
            dvProd.RowFilter = "FACTID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString()
            dtProd = dvProd.ToTable()
            dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString()
            dtRptAct = dvRptAct.ToTable()

            If dtRptAct.Rows.Count > 0 Then
                For c = 0 To 0
                    Tr = New TableRow()
                    For j = 0 To ColCnt
                        Td = New TableCell()
                        If j = 0 Then
                            HeaderTdSetting(Td, "200px", "", "1")
                            btn = New Button
                            btn.ID = "btn" + dtProd.Rows(0).Item("CATEGORYNAME").ToString() + "_" + (i + 1).ToString()
                            btn.Text = "+"
                            btn.OnClientClick = "javascript:return showLines('" + btn.ID + "');"
                            lbl = New Label
                            lbl.Text = "<span class='icon'>+</span><b> " + dtProd.Rows(0).Item("CATEGORYNAME").ToString() ' dtRow.Rows(a).Item("DES").ToString() '+ "(" + dsRptRws.Tables(0).Rows(i).Item("UNITSHRT").ToString() + ")"

                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            'Td.Controls.Add(btn)
                            Td.Controls.Add(lbl)
                            Tr.Controls.Add(Td)
                            'tblCAGR.Controls.Add(Tr)
                        Else
                            HeaderTdSetting(Td, "150px", "", "1")
                            lbl = New Label
                            If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                Dim ProdCount As New Double
                                dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                            If Unit = 1 Then
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            ElseIf Unit = 2 Then
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            ElseIf Unit = 4 Then
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            Else
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            End If
                                        Else
                                            If Unit = 1 Then
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                            ElseIf Unit = 2 Then
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                            ElseIf Unit = 3 Then
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                            ElseIf Unit = 4 Then
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            Else
                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            End If
                                        End If
                                        'ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    Next
                                End If
                                lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                            Else
                                Dim count1 As New Double
                                Dim count2 As New Double
                                Dim diff As New Double
                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                dtRptCols1 = dvRptCols1.ToTable()
                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                dtRptCols2 = dvRptCols2.ToTable()

                                dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                            If Unit = 1 Then
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            ElseIf Unit = 2 Then
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            ElseIf Unit = 4 Then
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            Else
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            End If
                                        Else
                                            If Unit = 1 Then
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                            ElseIf Unit = 2 Then
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                            ElseIf Unit = 3 Then
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                            ElseIf Unit = 4 Then
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            Else
                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            End If
                                        End If
                                        'count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    Next
                                End If

                                dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                            If Unit = 1 Then
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            ElseIf Unit = 2 Then
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            ElseIf Unit = 4 Then
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            Else
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            End If
                                        Else
                                            If Unit = 1 Then
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                            ElseIf Unit = 2 Then
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                            ElseIf Unit = 3 Then
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                            ElseIf Unit = 4 Then
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            Else
                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            End If
                                        End If
                                        'count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    Next
                                End If

                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                            End If

                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Right")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-Right", "5px")
                            'Td.Controls.Add(lbl)
                            'Td.CssClass = "AlterNateColor2"
                            Tr.Controls.Add(Td)

                        End If
                    Next
                    Tr.CssClass = "header"
                    tblCAGR.Controls.Add(Tr)
                Next
                dvPack.RowFilter = "FACTID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString()
                dtPack = dvPack.ToTable()
                For a = 0 To dtPack.Rows.Count - 1
                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                    dtRptAct = dvRptAct.ToTable()
                    If dtRptAct.Rows.Count > 0 Then
                        Tr = New TableRow()
                        Tr.ID = dtProd.Rows(0).Item("CATEGORYNAME").ToString() + "_" + (a + 1).ToString()
                        For j = 0 To ColCnt
                            Td = New TableCell()
                            If j = 0 Then
                                HeaderTdSetting(Td, "200px", "", "1")
                                lbl = New Label
                                lbl.Text = dtPack.Rows(a).Item("VALUE").ToString()

                                Td.Style.Add("text-align", "Left")
                                Td.Font.Size = 10
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = True
                                Td.Style.Add("padding-left", "40px")
                                Td.Controls.Add(lbl)

                            Else
                                'HeaderTdSetting(Td, "150px", "", "1")
                                lbl = New Label
                                If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                    Dim PackCount As New Double
                                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        For l = 0 To dtRptAct.Rows.Count - 1
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If Unit = 1 Then
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf Unit = 2 Then
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf Unit = 4 Then
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If Unit = 1 Then
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                                ElseIf Unit = 2 Then
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                                ElseIf Unit = 3 Then
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                                ElseIf Unit = 4 Then
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                            'PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        Next
                                    End If
                                    lbl.Text = FormatNumber(PackCount.ToString(), 0)

                                Else
                                    Dim count1 As New Double
                                    Dim count2 As New Double
                                    Dim diff As New Double
                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                    dtRptCols1 = dvRptCols1.ToTable()
                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                    dtRptCols2 = dvRptCols2.ToTable()

                                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        For l = 0 To dtRptAct.Rows.Count - 1
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If Unit = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf Unit = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf Unit = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If Unit = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                                ElseIf Unit = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                                ElseIf Unit = 3 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                                ElseIf Unit = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                            'count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        Next
                                    End If

                                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        For l = 0 To dtRptAct.Rows.Count - 1
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If Unit = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf Unit = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf Unit = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If Unit = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                                ElseIf Unit = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                                ElseIf Unit = 3 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                                ElseIf Unit = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                            'count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        Next
                                    End If

                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                End If

                                Td.Style.Add("text-align", "Right")
                                Td.Font.Size = 9
                                Td.Font.Name = "Verdana"
                                Td.Style.Add("color", "#660022")
                                Td.CssClass = "AlterNateColor2"
                                Td.Font.Bold = True
                                Td.Style.Add("padding-right", "5px")
                                Td.Controls.Add(lbl)

                            End If
                            Tr.Controls.Add(Td)

                        Next
                        Tr.CssClass = "com"
                        tblCAGR.Controls.Add(Tr)

                        dvRow.RowFilter = "PRODID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString() + " AND PACKTYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                        dtRow = dvRow.ToTable()

                        For b = 0 To dsReg.Tables(0).Rows.Count - 1
                            dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND REGIONID=" + dsReg.Tables(0).Rows(b).Item("REGIONID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                            dtRptAct = dvRptAct.ToTable()
                            If dtRptAct.Rows.Count > 0 Then
                                Tr = New TableRow()
                                For j = 0 To ColCnt
                                    Td = New TableCell()
                                    If j = 0 Then
                                        HeaderTdSetting(Td, "200px", "", "1")
                                        lbl = New Label
                                        lbl.Text = dsReg.Tables(0).Rows(b).Item("REGIONNAME").ToString() '+ "(" + dsRptRws.Tables(0).Rows(i).Item("UNITSHRT").ToString() + ")"

                                        Td.Style.Add("text-align", "Left")
                                        Td.Font.Size = 10
                                        Td.Font.Name = "Verdana"
                                        Td.Font.Bold = True
                                        Td.Style.Add("padding-left", "70px")
                                        Td.Controls.Add(lbl)
                                    Else
                                        If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                            dvRptAct.RowFilter = "YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + "AND CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND REGIONID=" + dsReg.Tables(0).Rows(b).Item("REGIONID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                                            dtRptAct = dvRptAct.ToTable()
                                            If dtRptAct.Rows.Count > 0 Then
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If Unit = 1 Then
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    ElseIf Unit = 2 Then
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    ElseIf Unit = 4 Then
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    Else
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    End If
                                                Else
                                                    If Unit = 1 Then
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                                    ElseIf Unit = 2 Then
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                                    ElseIf Unit = 3 Then
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                                    ElseIf Unit = 4 Then
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    Else
                                                        Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    End If
                                                End If
                                                'Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                            End If

                                        Else
                                            Dim count1 As New Double
                                            Dim count2 As New Double
                                            Dim diff As New Double
                                            dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                            dtRptCols1 = dvRptCols1.ToTable()
                                            dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                            dtRptCols2 = dvRptCols2.ToTable()

                                            dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND REGIONID=" + dsReg.Tables(0).Rows(b).Item("REGIONID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                            dtRptAct = dvRptAct.ToTable()
                                            If dtRptAct.Rows.Count > 0 Then
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If Unit = 1 Then
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    ElseIf Unit = 2 Then
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    ElseIf Unit = 4 Then
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    Else
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    End If
                                                Else
                                                    If Unit = 1 Then
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                                    ElseIf Unit = 2 Then
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                                    ElseIf Unit = 3 Then
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                                    ElseIf Unit = 4 Then
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    Else
                                                        count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    End If
                                                End If
                                                'count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                            End If

                                            dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND REGIONID=" + dsReg.Tables(0).Rows(b).Item("REGIONID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                            dtRptAct = dvRptAct.ToTable()
                                            If dtRptAct.Rows.Count > 0 Then
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If Unit = 1 Then
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    ElseIf Unit = 2 Then
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    ElseIf Unit = 4 Then
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    Else
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    End If
                                                Else
                                                    If Unit = 1 Then
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                                    ElseIf Unit = 2 Then
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                                    ElseIf Unit = 3 Then
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                                    ElseIf Unit = 4 Then
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    Else
                                                        count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                    End If
                                                End If
                                                'count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                            End If

                                            diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                            Td.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        End If

                                        InnerTdSetting(Td, "", "Right")
                                        Td.CssClass = "AlterNateColor2"
                                    End If
                                    Td.Font.Size = 8.5
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = False
                                    Tr.Controls.Add(Td)
                                Next
                                Tr.CssClass = "com1"
                                tblCAGR.Controls.Add(Tr)
                            End If

                        Next
                    End If
                Next

            End If
        Next

        tblCAGR.Visible = True
    End Sub

    'SetUniformReportProdPackMatEMEA
    Private Sub SetUniformReportProdPackMatEMEA(ByVal reportDes As String, ByVal rptType As String)
        Dim objGetData As New Selectdata()
        Dim dsRptRws As New DataSet()

        Dim dsRptFilter As New DataSet()

        Dim dsRptFilterValue As New DataSet()
        Dim dsUnitPref As New DataSet
        Dim ColCnt As New Integer
        Dim RowCnt As New Integer
        Dim FiltCnt As New Integer
        Dim groupId As String = String.Empty
        Dim Dr() As DataRow
        Dim i As New Integer
        Dim j As New Integer
        Dim l As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim lbl As New Label
        Dim Fact As New Decimal
        Dim Link As New HyperLink
        Dim hyd As New HiddenField
        Dim CountryFilter As Boolean
        Dim k1 As Integer = 0
        Dim ProdId As String = ""
        Dim ProdTbl(11) As String
        Dim PackId As String = ""
        Dim Unit As String = ""
        Dim YearId As String = ""
        Dim dValue As Integer = 1
        Dim dsTables As New DataSet
        Dim dvTables As New DataView
        Dim dtTables As New DataTable
        Dim dsProd As New DataSet
        Dim dvProd As New DataView
        Dim dtProd As New DataTable
        Dim dsRptAct As New DataSet()
        Dim dvRptAct As New DataView()
        Dim dtRptAct As New DataTable()
        Dim dsRow As New DataSet
        Dim dvRow As New DataView
        Dim dtRow As New DataTable
        Dim dsPack As New DataSet
        Dim dvPack As New DataView
        Dim dtPack As New DataTable
        Dim dsRptCols As New DataSet()
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim RegID As String = ""

        If rdbActual.Checked = True Then
            dValue = 1
        ElseIf rdbMil.Checked = True Then
            dValue = 1000000
        ElseIf rdbBil.Checked = True Then
            dValue = 1000000000
        ElseIf rdbThou.Checked = True Then
            dValue = 1000
        End If


        'If hidReport.Value <> "0" Then
        'dsUnitPref = Session("dsPref" + REPId.ToString())
        'dsRptRws = Session("dsRows" + REPId.ToString())
        'dsRptCols = Session("dsColumns" + REPId.ToString())
        ' dsRptFilter = Session("dsFilters" + REPId.ToString())
        'Else
        dsUnitPref = objGetData.GetPref(REPId.ToString())
        dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
        dvTables = dsTables.Tables(0).DefaultView
        dsRptCols = objGetData.GetUsersDynamicReportCols(REPId.ToString())
        dsRptFilter = objGetData.GetUsersReportFilters(REPId.ToString())

        Session("dsPref" + REPId.ToString()) = dsUnitPref
        Session("dsRows" + REPId.ToString()) = dsRptRws
        Session("dsColumns" + REPId.ToString()) = dsRptCols
        Session("dsFilters" + REPId.ToString()) = dsRptFilter

        hidReport.Value = "1"
        ' End If
        Unit = "1"
        For a = 0 To dsRptCols.Tables(0).Rows.Count - 1
            If dsRptCols.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                YearId = YearId + "" + dsRptCols.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
            End If
        Next
        YearId = YearId.Remove(YearId.Length - 1)

        For a = 0 To dsRptFilter.Tables(0).Rows.Count - 1
            If dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    For b = 0 To dsTables.Tables(0).Rows.Count - 1
                        ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                        ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                        RowCnt += 1
                    Next
                    dtTables = dsTables.Tables(0)
                    ProdId = ProdId.Remove(ProdId.Length - 1)
                Else
                    ProdId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                    dtTables = dvTables.ToTable()
                    ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                    RowCnt += 1
                End If
            ElseIf dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    If ProdId <> "" Then
                        dsPack = objGetData.GetPivotPackage(ProdId)
                    Else

                    End If
                    For b = 0 To dsPack.Tables(0).Rows.Count - 1
                        PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("ID").ToString() + ","
                        'RowCnt += 1
                    Next
                    PackId = PackId.Remove(PackId.Length - 1)
                Else
                    PackId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsPack = objGetData.GetProductTypeByPack(PackId)
                End If
            ElseIf dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "REGION" Then
                RegID = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
            End If
        Next

        groupId = Session("M1SubGroupId").ToString()
        dsRptAct = objGetData.GetPivotReportDataEMEA(ProdTbl, "MAT", YearId, PackId, Unit, RowCnt, RegID)
        dsProd = objGetData.GetProductDescription(ProdId)
        dsRow = objGetData.GetPivotMaterialss(ProdId, PackId)
        Unit = objGetData.GetPivotUnit(REPId.ToString())
        Try



        Catch ex As Exception

        End Try


        'If dsRptRws.Tables.Count > 0 Then
        '    RowCnt = dsRptRws.Tables(0).Rows.Count - 1
        'End If
        If dsRptCols.Tables.Count > 0 Then
            ColCnt = dsRptCols.Tables(0).Rows.Count
        End If
        If dsRptFilter.Tables.Count > 0 Then
            FiltCnt = dsRptFilter.Tables(0).Rows.Count
        End If

        Dim count As Integer = FiltCnt + ColCnt

        tblCAGR.Rows.Clear()
        'filter row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                For l = 0 To FiltCnt - 1
                    Link = New HyperLink
                    hyd = New HiddenField
                    lbl = New Label
                    Link.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    lbl.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    hyd.Value = dsRptFilter.Tables(0).Rows(l).Item("USERREPORTFILTERID").ToString()
                    Link.ID = "Filter_" + (l + 1).ToString()
                    hyd.ID = "Filter_ID_" + (l + 1).ToString()
                    Link.CssClass = "LinkM"

                    GetFilterLink(dsRptFilter.Tables(0).Rows(l).Item("FILTERSEQUENCE").ToString(), Link, dsRptFilter.Tables(0).Rows(l).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                    'If rptType = "Base" Then
                    '    HeaderTd.Controls.Add(lbl)
                    'Else
                    HeaderTd.Controls.Add(Link)
                    'End If
                    'HeaderTd.Controls.Add(lbl)
                    HeaderTd.Controls.Add(hyd)
                Next
                HeaderTdSetting(HeaderTd, "200px", "", "1")
            Else
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)

        'Hedaer Row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                lbl = New Label
                If reportDes = "REGION" Then
                    lbl.Text = "GEOGRAPHIC REGIONS"
                ElseIf reportDes = "PACKGRP" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "PROD" Then
                    lbl.Text = "PRODUCTS"
                ElseIf reportDes = "MAT" Then
                    lbl.Text = "MATERIALS"
                ElseIf reportDes = "PACK" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "GROUP" Then
                    lbl.Text = "GROUP"
                ElseIf reportDes = "CNTRY" Then
                    lbl.Text = "COUNTRIES"
                End If
                HeaderTd.Controls.Add(lbl)
                HeaderTdSetting(HeaderTd, "200px", "", "1")
            Else
                hyd = New HiddenField
                Link = New HyperLink
                lbl = New Label
                Dim k As New Integer
                k = j - 1

                If dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString() + "(" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE1").ToString() + "/" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE2").ToString() + ")"
                Else
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString()
                End If
                lbl.Text = Link.Text
                Link.ID = "Column_" + k.ToString()
                hyd.ID = "Column_ID_" + k.ToString()
                hyd.Value = dsRptCols.Tables(0).Rows(k).Item("USERREPORTCOLUMNID").ToString()
                Link.CssClass = "LinkM"
                GetColLink(dsRptCols.Tables(0).Rows(k).Item("COLUMNSEQUENCE").ToString(), Link, dsRptCols.Tables(0).Rows(k).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                If rptType = "Base" Then
                    HeaderTd.Controls.Add(lbl)
                Else
                    HeaderTd.Controls.Add(Link)
                End If

                HeaderTd.Controls.Add(hyd)
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)


        'SET THE UNIT & SUMMERY PART
        For i = 0 To 0
            Tr = New TableRow()
            For j = 0 To ColCnt
                Td = New TableCell()
                lbl = New Label
                If j = 0 Then
                    HeaderTdSetting(Td, "200px", "", "1")
                    If i = 0 Then
                        lbl.Text = "UNIT"
                    End If
                Else
                    HeaderTdSetting(Td, "100px", "", "1")
                    If i = 0 Then

                        lbl.ID = "lbl_" + j.ToString()
                        If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                            lbl.Text = "(%)"
                        Else
                            lbl.Text = "(" + dsUnitPref.Tables(0).Rows(0).Item("TITLE1").ToString() + ")"
                            hidUnitShort.Value = lbl.Text
                        End If
                        Td.Style.Add("text-align", "Center")

                    End If
                End If

                Td.Font.Size = 8
                Td.Font.Name = "Verdana"
                Td.Font.Bold = False
                Td.Controls.Add(lbl)
                Tr.Controls.Add(Td)
            Next
            tblCAGR.Controls.Add(Tr)
        Next

        dvProd = dsProd.Tables(0).DefaultView
        dvRptAct = dsRptAct.Tables(0).DefaultView
        dvRow = dsRow.Tables(0).DefaultView
        dvPack = dsPack.Tables(0).DefaultView
        dvRptCols1 = dsRptCols.Tables(0).DefaultView
        dvRptCols2 = dsRptCols.Tables(0).DefaultView

        Dim btn As New Button
        'Inner Row
        For i = 0 To RowCnt - 1
            dvProd.RowFilter = "FACTID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString()
            dtProd = dvProd.ToTable()
            dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString()
            dtRptAct = dvRptAct.ToTable()

            If dtRptAct.Rows.Count > 0 Then
                For c = 0 To 0
                    Tr = New TableRow()
                    For j = 0 To ColCnt
                        Td = New TableCell()
                        If j = 0 Then
                            HeaderTdSetting(Td, "200px", "", "1")
                            btn = New Button
                            btn.ID = "btn" + dtProd.Rows(0).Item("CATEGORYNAME").ToString() + "_" + (i + 1).ToString()
                            btn.Text = "+"
                            btn.OnClientClick = "javascript:return showLines('" + btn.ID + "');"
                            lbl = New Label
                            lbl.Text = "<span class='icon'>+</span><b> " + dtProd.Rows(0).Item("CATEGORYNAME").ToString() ' dtRow.Rows(a).Item("DES").ToString() '+ "(" + dsRptRws.Tables(0).Rows(i).Item("UNITSHRT").ToString() + ")"

                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            'Td.Width = 200
                            'Td.Controls.Add(btn)
                            Td.Controls.Add(lbl)
                            Tr.Controls.Add(Td)
                            'tblCAGR.Controls.Add(Tr)
                        Else
                            HeaderTdSetting(Td, "150px", "", "1")
                            lbl = New Label
                            If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                Dim ProdCount As New Double
                                dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        End If

                                    Next
                                End If
                                'lbl.Text = ProdCount.ToString()

                                'sssssssssssssssssssssss
                                lbl.Text = FormatNumber(ProdCount.ToString() * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                'sssssssssssssssssssssss
                            Else
                                Dim count1 As New Double
                                Dim count2 As New Double
                                Dim diff As New Double
                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                dtRptCols1 = dvRptCols1.ToTable()
                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                dtRptCols2 = dvRptCols2.ToTable()

                                dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    Next
                                End If

                                dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    Next
                                End If

                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                lbl.Text = FormatNumber(lbl.Text * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                            End If

                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Right")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Width = 120
                            Td.Style.Add("padding-right", "5px")
                            'Td.CssClass = "AlterNateColor2"
                            Tr.Controls.Add(Td)

                        End If
                    Next
                    Tr.CssClass = "header"
                    tblCAGR.Controls.Add(Tr)
                Next
                dvPack.RowFilter = "FACTID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString()
                dtPack = dvPack.ToTable()
                For a = 0 To dtPack.Rows.Count - 1
                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                    dtRptAct = dvRptAct.ToTable()
                    If dtRptAct.Rows.Count > 0 Then
                        Tr = New TableRow()
                        Tr.ID = dtProd.Rows(0).Item("CATEGORYNAME").ToString() + "_" + (a + 1).ToString()
                        For j = 0 To ColCnt
                            Td = New TableCell()
                            If j = 0 Then
                                HeaderTdSetting(Td, "200px", "", "1")
                                lbl = New Label
                                lbl.Text = dtPack.Rows(a).Item("VALUE").ToString()

                                Td.Style.Add("text-align", "Left")
                                Td.Font.Size = 10
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = True
                                Td.Style.Add("padding-left", "25px")
                                Td.Controls.Add(lbl)

                            Else
                                'HeaderTdSetting(Td, "150px", "", "1")
                                lbl = New Label
                                If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                    Dim PackCount As New Double
                                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        For l = 0 To dtRptAct.Rows.Count - 1
                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            End If

                                        Next
                                    End If
                                    'lbl.Text = PackCount.ToString()
                                    lbl.Text = FormatNumber(PackCount.ToString() * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                Else
                                    Dim count1 As New Double
                                    Dim count2 As New Double
                                    Dim diff As New Double
                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                    dtRptCols1 = dvRptCols1.ToTable()
                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                    dtRptCols2 = dvRptCols2.ToTable()

                                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        For l = 0 To dtRptAct.Rows.Count - 1
                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        Next
                                    End If

                                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        For l = 0 To dtRptAct.Rows.Count - 1
                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        Next
                                    End If

                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                    lbl.Text = FormatNumber(lbl.Text * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                End If

                                Td.Style.Add("text-align", "Right")
                                Td.Font.Size = 8
                                Td.Font.Name = "Verdana"
                                Td.Style.Add("color", "#660022")
                                Td.CssClass = "AlterNateColor2"
                                Td.Font.Bold = True
                                Td.Style.Add("padding-right", "5px")
                                Td.Controls.Add(lbl)

                            End If
                            Tr.Controls.Add(Td)

                        Next
                        Tr.CssClass = "com"
                        tblCAGR.Controls.Add(Tr)

                        dvRow.RowFilter = "PRODID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString() + " AND PACKTYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                        dtRow = dvRow.ToTable()

                        For b = 0 To dtRow.Rows.Count - 1
                            Tr = New TableRow()
                            For j = 0 To ColCnt
                                Td = New TableCell()
                                If j = 0 Then
                                    HeaderTdSetting(Td, "200px", "", "1")
                                    lbl = New Label
                                    lbl.Text = dtRow.Rows(b).Item("DES").ToString() '+ "(" + dsRptRws.Tables(0).Rows(i).Item("UNITSHRT").ToString() + ")"

                                    Td.Style.Add("text-align", "Left")
                                    Td.Font.Size = 10
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-left", "50px")
                                    Td.Controls.Add(lbl)
                                Else
                                    If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        dvRptAct.RowFilter = "YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + "AND CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND MATERIALID=" + dtRow.Rows(b).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            If dtRptAct.Rows(0).Item("FCT").ToString() <> "" Then
                                                Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                If Td.Text <> "" Then
                                                    Td.Text = FormatNumber(Td.Text * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                                End If
                                            End If


                                        End If

                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()

                                        dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND MATERIALID=" + dtRow.Rows(b).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                        End If

                                        dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND MATERIALID=" + dtRow.Rows(b).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                        End If

                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                        Td.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        Td.Text = FormatNumber(Td.Text * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                    End If

                                    InnerTdSetting(Td, "", "Right")
                                    Td.CssClass = "AlterNateColor2"
                                End If
                                Td.Font.Size = 8.5
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = False
                                Tr.Controls.Add(Td)
                            Next
                            Tr.CssClass = "com1"
                            tblCAGR.Controls.Add(Tr)
                        Next
                    End If
                Next

            End If
        Next


        tblCAGR.Visible = True
    End Sub

    'SetUniformReportProdRegionBUYER
    Private Sub SetUniformReportProdRegBuyers(ByVal reportDes As String, ByVal rptType As String)
        Dim objGetData As New Selectdata()
        Dim dsRptRws As New DataSet()

        Dim dsRptFilter As New DataSet()

        Dim dsRptFilterValue As New DataSet()
        Dim dsUnitPref As New DataSet
        Dim ColCnt As New Integer
        Dim RowCnt As New Integer
        Dim FiltCnt As New Integer
        Dim groupId As String = String.Empty
        Dim Dr() As DataRow
        Dim i As New Integer
        Dim j As New Integer
        Dim l As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim lbl As New Label
        Dim Fact As New Decimal
        Dim Link As New HyperLink
        Dim hyd As New HiddenField
        Dim CountryFilter As Boolean
        Dim k1 As Integer = 0
        Dim ProdId As String = ""
        Dim ProdTbl(11) As String
        Dim PackId As String = ""
        Dim RegID As String = ""
        Dim Unit As String = ""
        Dim YearId As String = ""
        Dim dValue As Integer = 1
        Dim dsTables As New DataSet
        Dim dvTables As New DataView
        Dim dtTables As New DataTable
        Dim dsProd As New DataSet
        Dim dvProd As New DataView
        Dim dtProd As New DataTable
        Dim dsRptAct As New DataSet()
        Dim dvRptAct As New DataView()
        Dim dtRptAct As New DataTable()
        Dim dsRow As New DataSet
        Dim dvRow As New DataView
        Dim dtRow As New DataTable
        Dim dsPack As New DataSet
        Dim dvPack As New DataView
        Dim dtPack As New DataTable
        Dim dsRptCols As New DataSet()
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsBuyers As New DataSet
        Dim dsReg As New DataSet

        Dim dtBuyers As New DataTable
        Dim dtReg As New DataTable

        Dim dvBuyers As New DataView
        Dim dvReg As New DataView

        If rdbActual.Checked = True Then
            dValue = 1
        ElseIf rdbMil.Checked = True Then
            dValue = 1000000
        ElseIf rdbBil.Checked = True Then
            dValue = 1000000000
        ElseIf rdbThou.Checked = True Then
            dValue = 1000
        End If


        'If hidReport.Value <> "0" Then
        '    dsUnitPref = Session("dsPref" + REPId.ToString())
        '    dsRptRws = Session("dsRows" + REPId.ToString())
        '    dsRptCols = Session("dsColumns" + REPId.ToString())
        '    dsRptFilter = Session("dsFilters" + REPId.ToString())
        'Else
        dsUnitPref = objGetData.GetPref(REPId.ToString())
        dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
        dvTables = dsTables.Tables(0).DefaultView
        dsRptCols = objGetData.GetUsersDynamicReportCols(REPId.ToString())
        dsRptFilter = objGetData.GetUsersReportFilters(REPId.ToString())

        Session("dsPref" + REPId.ToString()) = dsUnitPref
        Session("dsRows" + REPId.ToString()) = dsRptRws
        Session("dsColumns" + REPId.ToString()) = dsRptCols
        Session("dsFilters" + REPId.ToString()) = dsRptFilter

        hidReport.Value = "1"
        'End If
        Unit = "1"
        For a = 0 To dsRptCols.Tables(0).Rows.Count - 1
            If dsRptCols.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                YearId = YearId + "" + dsRptCols.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
            End If
        Next
        YearId = YearId.Remove(YearId.Length - 1)

        For a = 0 To dsRptFilter.Tables(0).Rows.Count - 1
            If dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    For b = 0 To dsTables.Tables(0).Rows.Count - 1
                        ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                        ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                        RowCnt += 1
                    Next
                    dtTables = dsTables.Tables(0)
                    ProdId = ProdId.Remove(ProdId.Length - 1)
                Else
                    ProdId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                    dtTables = dvTables.ToTable()
                    ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                    RowCnt += 1
                End If
            ElseIf dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    If ProdId <> "" Then
                        dsPack = objGetData.GetPivotPackage(ProdId)
                    Else

                    End If
                    For b = 0 To dsPack.Tables(0).Rows.Count - 1
                        PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("ID").ToString() + ","
                        'RowCnt += 1
                    Next
                    PackId = PackId.Remove(PackId.Length - 1)
                Else
                    PackId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsPack = objGetData.GetProductTypeByPack(PackId)
                End If
            ElseIf dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "REGION" Then
                RegID = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
            End If
        Next

        groupId = Session("M1SubGroupId").ToString()
        dsRptAct = objGetData.GetPivotBuyersReportData(ProdTbl, "BUYER", YearId, RegID, 5, RowCnt)
        dsProd = objGetData.GetProductDescription(ProdId)
        dsRow = objGetData.GetPivotMaterialss(ProdId, PackId)
        dsBuyers = objGetData.GetPivotBuyers(ProdId)
        dsReg = objGetData.GetPivotRegionn(RegID)
        Unit = objGetData.GetPivotUnit(REPId.ToString())
        Try



        Catch ex As Exception

        End Try


        'If dsRptRws.Tables.Count > 0 Then
        '    RowCnt = dsRptRws.Tables(0).Rows.Count - 1
        'End If
        If dsRptCols.Tables.Count > 0 Then
            ColCnt = dsRptCols.Tables(0).Rows.Count
        End If
        If dsRptFilter.Tables.Count > 0 Then
            FiltCnt = dsRptFilter.Tables(0).Rows.Count
        End If

        Dim count As Integer = FiltCnt + ColCnt

        tblCAGR.Rows.Clear()

        'filter row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                For l = 0 To FiltCnt - 1
                    Link = New HyperLink
                    hyd = New HiddenField
                    lbl = New Label
                    Link.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    lbl.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    hyd.Value = dsRptFilter.Tables(0).Rows(l).Item("USERREPORTFILTERID").ToString()
                    Link.ID = "Filter_" + (l + 1).ToString()
                    hyd.ID = "Filter_ID_" + (l + 1).ToString()
                    Link.CssClass = "LinkM"

                    GetFilterLink(dsRptFilter.Tables(0).Rows(l).Item("FILTERSEQUENCE").ToString(), Link, dsRptFilter.Tables(0).Rows(l).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                    If rptType = "Base" Then
                        HeaderTd.Controls.Add(lbl)
                    Else
                        HeaderTd.Controls.Add(Link)
                    End If
                    'HeaderTd.Controls.Add(lbl)
                    HeaderTd.Controls.Add(hyd)
                Next
                HeaderTdSetting(HeaderTd, "200px", "", "1")
            Else
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)

        'Hedaer Row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                lbl = New Label
                If reportDes = "REGION" Then
                    lbl.Text = "GEOGRAPHIC REGIONS"
                ElseIf reportDes = "PACKGRP" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "PROD" Then
                    lbl.Text = "PRODUCTS"
                ElseIf reportDes = "MAT" Then
                    lbl.Text = "MATERIALS"
                ElseIf reportDes = "PACK" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "GROUP" Then
                    lbl.Text = "GROUP"
                ElseIf reportDes = "CNTRY" Then
                    lbl.Text = "COUNTRIES"
                End If
                HeaderTd.Controls.Add(lbl)
                HeaderTdSetting(HeaderTd, "200px", "", "1")
            Else
                hyd = New HiddenField
                Link = New HyperLink
                lbl = New Label
                Dim k As New Integer
                k = j - 1

                If dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString() + "(" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE1").ToString() + "/" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE2").ToString() + ")"
                Else
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString()
                End If
                lbl.Text = Link.Text
                Link.ID = "Column_" + k.ToString()
                hyd.ID = "Column_ID_" + k.ToString()
                hyd.Value = dsRptCols.Tables(0).Rows(k).Item("USERREPORTCOLUMNID").ToString()
                Link.CssClass = "LinkM"
                GetColLink(dsRptCols.Tables(0).Rows(k).Item("COLUMNSEQUENCE").ToString(), Link, dsRptCols.Tables(0).Rows(k).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                If rptType = "Base" Then
                    HeaderTd.Controls.Add(lbl)
                Else
                    HeaderTd.Controls.Add(Link)
                End If

                HeaderTd.Controls.Add(hyd)
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)


        'SET THE UNIT & SUMMERY PART
        For i = 0 To 0
            Tr = New TableRow()
            For j = 0 To ColCnt
                Td = New TableCell()
                lbl = New Label
                If j = 0 Then
                    HeaderTdSetting(Td, "200px", "", "1")
                    If i = 0 Then
                        lbl.Text = "UNIT"
                    End If
                Else
                    HeaderTdSetting(Td, "100px", "", "1")
                    If i = 0 Then

                        lbl.ID = "lbl_" + j.ToString()
                        If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                            lbl.Text = "(%)"
                        Else
                            lbl.Text = "(US$)"
                            hidUnitShort.Value = lbl.Text
                        End If
                        Td.Style.Add("text-align", "Center")

                    End If
                End If

                Td.Font.Size = 8
                Td.Font.Name = "Verdana"
                Td.Font.Bold = False
                Td.Controls.Add(lbl)
                Tr.Controls.Add(Td)
            Next
            tblCAGR.Controls.Add(Tr)
        Next

        dvProd = dsProd.Tables(0).DefaultView
        dvRptAct = dsRptAct.Tables(0).DefaultView
        'dvRow = dsRow.Tables(0).DefaultView
        'dvPack = dsPack.Tables(0).DefaultView
        dvRptCols1 = dsRptCols.Tables(0).DefaultView
        dvRptCols2 = dsRptCols.Tables(0).DefaultView

        Dim btn As New Button
        'Inner Row
        For i = 0 To RowCnt - 1
            dvProd.RowFilter = "FACTID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString()
            dtProd = dvProd.ToTable()
            dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString()
            dtRptAct = dvRptAct.ToTable()

            If dtRptAct.Rows.Count > 0 Then
                For c = 0 To 0
                    Tr = New TableRow()
                    For j = 0 To ColCnt
                        Td = New TableCell()
                        If j = 0 Then
                            HeaderTdSetting(Td, "200px", "", "1")
                            btn = New Button
                            btn.ID = "btn" + dtProd.Rows(0).Item("CATEGORYNAME").ToString() + "_" + (i + 1).ToString()
                            btn.Text = "+"
                            btn.OnClientClick = "javascript:return showLines('" + btn.ID + "');"
                            lbl = New Label
                            lbl.Text = "<span class='icon'>+</span><b> " + dtProd.Rows(0).Item("CATEGORYNAME").ToString() ' dtRow.Rows(a).Item("DES").ToString() '+ "(" + dsRptRws.Tables(0).Rows(i).Item("UNITSHRT").ToString() + ")"

                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            'Td.Width = 200
                            'Td.Controls.Add(btn)
                            Td.Controls.Add(lbl)
                            Tr.Controls.Add(Td)
                            'tblCAGR.Controls.Add(Tr)
                        Else
                            HeaderTdSetting(Td, "150px", "", "1")
                            lbl = New Label
                            If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                Dim ProdCount As New Double
                                dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    Next
                                End If
                                'lbl.Text = ProdCount.ToString()

                                'sssssssssssssssssssssss
                                lbl.Text = FormatNumber(ProdCount.ToString() * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                'sssssssssssssssssssssss
                            Else
                                'Dim count1 As New Double
                                'Dim count2 As New Double
                                'Dim diff As New Double
                                'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                'dtRptCols1 = dvRptCols1.ToTable()
                                'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                'dtRptCols2 = dvRptCols2.ToTable()

                                'dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                'dtRptAct = dvRptAct.ToTable()
                                'If dtRptAct.Rows.Count > 0 Then
                                '    For l = 0 To dtRptAct.Rows.Count - 1
                                '        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                '    Next
                                'End If

                                'dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                'dtRptAct = dvRptAct.ToTable()
                                'If dtRptAct.Rows.Count > 0 Then
                                '    For l = 0 To dtRptAct.Rows.Count - 1
                                '        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                '    Next
                                'End If

                                'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                'lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                'lbl.Text = FormatNumber(lbl.Text * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                            End If

                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Right")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Width = 120
                            Td.Style.Add("padding-left", "5px")
                            'Td.CssClass = "AlterNateColor2"
                            Tr.Controls.Add(Td)

                        End If
                    Next
                    Tr.CssClass = "header"
                    tblCAGR.Controls.Add(Tr)
                Next
                'dvPack.RowFilter = "FACTID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString()
                'dtPack = dvPack.ToTable()
                dvReg = dsReg.Tables(0).DefaultView
                dtReg = dvReg.ToTable()
                For a = 0 To dtReg.Rows.Count - 1
                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND REGIONID=" + dtReg.Rows(a).Item("REGIONID").ToString()
                    dtRptAct = dvRptAct.ToTable()
                    If dtRptAct.Rows.Count > 0 Then
                        Tr = New TableRow()
                        Tr.ID = dtProd.Rows(0).Item("CATEGORYNAME").ToString() + "_" + (a + 1).ToString()
                        For j = 0 To ColCnt
                            Td = New TableCell()
                            If j = 0 Then
                                HeaderTdSetting(Td, "200px", "", "1")
                                lbl = New Label
                                lbl.Text = dtReg.Rows(a).Item("REGIONNAME").ToString()

                                Td.Style.Add("text-align", "Left")
                                Td.Font.Size = 9
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = True
                                Td.Style.Add("padding-left", "25px")
                                Td.Controls.Add(lbl)

                            Else
                                'HeaderTdSetting(Td, "150px", "", "1")
                                lbl = New Label
                                If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                    Dim RegCount As New Double
                                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND REGIONID=" + dtReg.Rows(a).Item("REGIONID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        For l = 0 To dtRptAct.Rows.Count - 1
                                            RegCount = RegCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        Next
                                    End If
                                    'lbl.Text = PackCount.ToString()
                                    lbl.Text = FormatNumber(RegCount.ToString(), 0)
                                Else
                                    'Dim count1 As New Double
                                    'Dim count2 As New Double
                                    'Dim diff As New Double
                                    'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                    'dtRptCols1 = dvRptCols1.ToTable()
                                    'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                    'dtRptCols2 = dvRptCols2.ToTable()

                                    'dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                    'dtRptAct = dvRptAct.ToTable()
                                    'If dtRptAct.Rows.Count > 0 Then
                                    '    For l = 0 To dtRptAct.Rows.Count - 1
                                    '        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    '    Next
                                    'End If

                                    'dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                    'dtRptAct = dvRptAct.ToTable()
                                    'If dtRptAct.Rows.Count > 0 Then
                                    '    For l = 0 To dtRptAct.Rows.Count - 1
                                    '        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    '    Next
                                    'End If

                                    'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                    'lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                    'lbl.Text = FormatNumber(lbl.Text * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                End If

                                Td.Style.Add("text-align", "Right")
                                Td.Font.Size = 8
                                Td.Font.Name = "Verdana"
                                Td.Style.Add("color", "#660022")
                                Td.CssClass = "AlterNateColor2"
                                Td.Font.Bold = True
                                Td.Style.Add("padding-left", "5px")
                                Td.Controls.Add(lbl)

                            End If
                            Tr.Controls.Add(Td)
                            '
                        Next
                        Tr.CssClass = "com"
                        tblCAGR.Controls.Add(Tr)

                        'dvRow.RowFilter = "PRODID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString() + " AND PACKTYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                        'dtRow = dvRow.ToTable()
                        dvBuyers = dsBuyers.Tables(0).DefaultView
                        dtBuyers = dvBuyers.ToTable()
                        For b = 0 To dtBuyers.Rows.Count - 1
                            Dim flag As Boolean = False
                            dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND SUBGROUPID=" + dtBuyers.Rows(b).Item("SUBGROUPID").ToString()
                            dtRptAct = dvRptAct.ToTable()
                            If dtRptAct.Rows.Count > 0 Then


                                Tr = New TableRow()
                                For j = 0 To ColCnt
                                    Td = New TableCell()
                                    If j = 0 Then
                                        HeaderTdSetting(Td, "200px", "", "1")
                                        lbl = New Label
                                        lbl.Text = dtBuyers.Rows(b).Item("GROUPNAME").ToString() '+ "(" + dsRptRws.Tables(0).Rows(i).Item("UNITSHRT").ToString() + ")"

                                        Td.Style.Add("text-align", "Left")
                                        Td.Font.Size = 10
                                        Td.Font.Name = "Verdana"
                                        Td.Font.Bold = True
                                        Td.Style.Add("padding-left", "50px")
                                        Td.Controls.Add(lbl)
                                    Else
                                        If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                            dvRptAct.RowFilter = "YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + "AND CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND SUBGROUPID=" + dtBuyers.Rows(b).Item("SUBGROUPID").ToString()
                                            dtRptAct = dvRptAct.ToTable()
                                            If dtRptAct.Rows.Count > 0 Then
                                                Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                                Td.Text = FormatNumber(Td.Text, 0)
                                                If Td.Text <> 0 Then
                                                    flag = True
                                                End If
                                            End If

                                        Else
                                            'Dim count1 As New Double
                                            'Dim count2 As New Double
                                            'Dim diff As New Double
                                            'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                            'dtRptCols1 = dvRptCols1.ToTable()
                                            'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                            'dtRptCols2 = dvRptCols2.ToTable()

                                            'dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND MATERIALID=" + dtRow.Rows(b).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                            'dtRptAct = dvRptAct.ToTable()
                                            'If dtRptAct.Rows.Count > 0 Then
                                            '    count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                            'End If

                                            'dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND MATERIALID=" + dtRow.Rows(b).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                            'dtRptAct = dvRptAct.ToTable()
                                            'If dtRptAct.Rows.Count > 0 Then
                                            '    count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                            'End If

                                            'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                            'Td.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                            'Td.Text = FormatNumber(Td.Text * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                        End If

                                        InnerTdSetting(Td, "", "Right")
                                        Td.CssClass = "AlterNateColor2"
                                    End If
                                    Td.Font.Size = 8.5
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = False
                                    Tr.Controls.Add(Td)
                                Next
                            End If
                            Tr.CssClass = "com1"
                            If flag = True Then
                                tblCAGR.Controls.Add(Tr)
                            End If

                        Next
                    End If
                Next

            End If
        Next


        tblCAGR.Visible = True
    End Sub

    'SetUniformReportProdPackMat
    Private Sub SetUniformReportProdPackMat(ByVal reportDes As String, ByVal rptType As String)
        Dim objGetData As New Selectdata()
        Dim dsRptRws As New DataSet()

        Dim dsRptFilter As New DataSet()

        Dim dsRptFilterValue As New DataSet()
        Dim dsUnitPref As New DataSet
        Dim ColCnt As New Integer
        Dim RowCnt As New Integer
        Dim FiltCnt As New Integer
        Dim groupId As String = String.Empty
        Dim Dr() As DataRow
        Dim i As New Integer
        Dim j As New Integer
        Dim l As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim lbl As New Label
        Dim Fact As New Decimal
        Dim Link As New HyperLink
        Dim hyd As New HiddenField
        Dim CountryFilter As Boolean
        Dim k1 As Integer = 0
        Dim ProdId As String = ""
        Dim ProdTbl(11) As String
        Dim PackId As String = ""
        Dim Unit As String = ""
        Dim YearId As String = ""
        Dim dValue As Integer = 1
        Dim dsTables As New DataSet
        Dim dvTables As New DataView
        Dim dtTables As New DataTable
        Dim dsProd As New DataSet
        Dim dvProd As New DataView
        Dim dtProd As New DataTable
        Dim dsRptAct As New DataSet()
        Dim dvRptAct As New DataView()
        Dim dtRptAct As New DataTable()
        Dim dsRow As New DataSet
        Dim dvRow As New DataView
        Dim dtRow As New DataTable
        Dim dsPack As New DataSet
        Dim dvPack As New DataView
        Dim dtPack As New DataTable
        Dim dsRptCols As New DataSet()
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable

        If rdbActual.Checked = True Then
            dValue = 1
        ElseIf rdbMil.Checked = True Then
            dValue = 1000000
        ElseIf rdbBil.Checked = True Then
            dValue = 1000000000
        ElseIf rdbThou.Checked = True Then
            dValue = 1000
        End If


        If hidReport.Value <> "0" Then
            dsUnitPref = Session("dsPref" + REPId.ToString())
            dsRptRws = Session("dsRows" + REPId.ToString())
            dsRptCols = Session("dsColumns" + REPId.ToString())
            dsRptFilter = Session("dsFilters" + REPId.ToString())
        Else
            dsUnitPref = objGetData.GetPref(REPId.ToString())
            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            dsRptCols = objGetData.GetUsersDynamicReportCols(REPId.ToString())
            dsRptFilter = objGetData.GetUsersReportFilters(REPId.ToString())

            Session("dsPref" + REPId.ToString()) = dsUnitPref
            Session("dsRows" + REPId.ToString()) = dsRptRws
            Session("dsColumns" + REPId.ToString()) = dsRptCols
            Session("dsFilters" + REPId.ToString()) = dsRptFilter

            hidReport.Value = "1"
        End If
        Unit = "1"
        For a = 0 To dsRptCols.Tables(0).Rows.Count - 1
            If dsRptCols.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                YearId = YearId + "" + dsRptCols.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
            End If
        Next
        YearId = YearId.Remove(YearId.Length - 1)

        For a = 0 To dsRptFilter.Tables(0).Rows.Count - 1
            If dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    For b = 0 To dsTables.Tables(0).Rows.Count - 1
                        ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                        ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                        RowCnt += 1
                    Next
                    dtTables = dsTables.Tables(0)
                    ProdId = ProdId.Remove(ProdId.Length - 1)
                Else
                    ProdId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                    dtTables = dvTables.ToTable()
                    ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                    RowCnt += 1
                End If
            ElseIf dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    If ProdId <> "" Then
                        dsPack = objGetData.GetPivotPackage(ProdId)
                    Else

                    End If
                    For b = 0 To dsPack.Tables(0).Rows.Count - 1
                        PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("ID").ToString() + ","
                        'RowCnt += 1
                    Next
                    PackId = PackId.Remove(PackId.Length - 1)
                Else
                    PackId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsPack = objGetData.GetProductTypeByPack(PackId)
                End If

            End If
        Next

        groupId = Session("M1SubGroupId").ToString()
        dsRptAct = objGetData.GetPivotReportData(ProdTbl, "MAT", YearId, PackId, Unit, dsTables.Tables(0).Rows.Count)
        dsProd = objGetData.GetProductDescription(ProdId)
        dsRow = objGetData.GetPivotMaterialss(ProdId, PackId)
        Unit = objGetData.GetPivotUnit(REPId.ToString())
        Try



        Catch ex As Exception

        End Try


        'If dsRptRws.Tables.Count > 0 Then
        '    RowCnt = dsRptRws.Tables(0).Rows.Count - 1
        'End If
        If dsRptCols.Tables.Count > 0 Then
            ColCnt = dsRptCols.Tables(0).Rows.Count
        End If
        If dsRptFilter.Tables.Count > 0 Then
            FiltCnt = dsRptFilter.Tables(0).Rows.Count
        End If

        Dim count As Integer = FiltCnt + ColCnt

        tblCAGR.Rows.Clear()
        'filter row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                For l = 0 To FiltCnt - 1
                    Link = New HyperLink
                    hyd = New HiddenField
                    lbl = New Label
                    Link.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    lbl.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    hyd.Value = dsRptFilter.Tables(0).Rows(l).Item("USERREPORTFILTERID").ToString()
                    Link.ID = "Filter_" + (l + 1).ToString()
                    hyd.ID = "Filter_ID_" + (l + 1).ToString()
                    Link.CssClass = "LinkM"

                    GetFilterLink(dsRptFilter.Tables(0).Rows(l).Item("FILTERSEQUENCE").ToString(), Link, dsRptFilter.Tables(0).Rows(l).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                    If rptType = "Base" Then
                        HeaderTd.Controls.Add(lbl)
                    Else
                        HeaderTd.Controls.Add(Link)
                    End If
                    'HeaderTd.Controls.Add(lbl)
                    HeaderTd.Controls.Add(hyd)
                Next
                HeaderTdSetting(HeaderTd, "200px", "", "1")
            Else
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)

        'Hedaer Row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                lbl = New Label
                If reportDes = "REGION" Then
                    lbl.Text = "GEOGRAPHIC REGIONS"
                ElseIf reportDes = "PACKGRP" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "PROD" Then
                    lbl.Text = "PRODUCTS"
                ElseIf reportDes = "MAT" Then
                    lbl.Text = "MATERIALS"
                ElseIf reportDes = "PACK" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "GROUP" Then
                    lbl.Text = "GROUP"
                ElseIf reportDes = "CNTRY" Then
                    lbl.Text = "COUNTRIES"
                End If
                HeaderTd.Controls.Add(lbl)
                HeaderTdSetting(HeaderTd, "200px", "", "1")
            Else
                hyd = New HiddenField
                Link = New HyperLink
                lbl = New Label
                Dim k As New Integer
                k = j - 1

                If dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString() + "(" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE1").ToString() + "/" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE2").ToString() + ")"
                Else
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString()
                End If
                lbl.Text = Link.Text
                Link.ID = "Column_" + k.ToString()
                hyd.ID = "Column_ID_" + k.ToString()
                hyd.Value = dsRptCols.Tables(0).Rows(k).Item("USERREPORTCOLUMNID").ToString()
                Link.CssClass = "LinkM"
                GetColLink(dsRptCols.Tables(0).Rows(k).Item("COLUMNSEQUENCE").ToString(), Link, dsRptCols.Tables(0).Rows(k).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                If rptType = "Base" Then
                    HeaderTd.Controls.Add(lbl)
                Else
                    HeaderTd.Controls.Add(Link)
                End If

                HeaderTd.Controls.Add(hyd)
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)


        'SET THE UNIT & SUMMERY PART
        For i = 0 To 0
            Tr = New TableRow()
            For j = 0 To ColCnt
                Td = New TableCell()
                lbl = New Label
                If j = 0 Then
                    HeaderTdSetting(Td, "200px", "", "1")
                    If i = 0 Then
                        lbl.Text = "UNIT"
                    End If
                Else
                    HeaderTdSetting(Td, "100px", "", "1")
                    If i = 0 Then

                        lbl.ID = "lbl_" + j.ToString()
                        If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                            lbl.Text = "(%)"
                        Else
                            lbl.Text = "(" + dsUnitPref.Tables(0).Rows(0).Item("TITLE1").ToString() + ")"
                            hidUnitShort.Value = lbl.Text
                        End If
                        Td.Style.Add("text-align", "Center")

                    End If
                End If

                Td.Font.Size = 8
                Td.Font.Name = "Verdana"
                Td.Font.Bold = False
                Td.Controls.Add(lbl)
                Tr.Controls.Add(Td)
            Next
            tblCAGR.Controls.Add(Tr)
        Next

        dvProd = dsProd.Tables(0).DefaultView
        dvRptAct = dsRptAct.Tables(0).DefaultView
        dvRow = dsRow.Tables(0).DefaultView
        dvPack = dsPack.Tables(0).DefaultView
        dvRptCols1 = dsRptCols.Tables(0).DefaultView
        dvRptCols2 = dsRptCols.Tables(0).DefaultView

        Dim btn As New Button
        'Inner Row
        For i = 0 To RowCnt - 1
            dvProd.RowFilter = "FACTID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString()
            dtProd = dvProd.ToTable()
            dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString()
            dtRptAct = dvRptAct.ToTable()

            If dtRptAct.Rows.Count > 0 Then
                For c = 0 To 0
                    Tr = New TableRow()
                    For j = 0 To ColCnt
                        Td = New TableCell()
                        If j = 0 Then
                            HeaderTdSetting(Td, "200px", "", "1")
                            btn = New Button
                            btn.ID = "btn" + dtProd.Rows(0).Item("CATEGORYNAME").ToString() + "_" + (i + 1).ToString()
                            btn.Text = "+"
                            btn.OnClientClick = "javascript:return showLines('" + btn.ID + "');"
                            lbl = New Label
                            lbl.Text = "<span class='icon'>+</span><b> " + dtProd.Rows(0).Item("CATEGORYNAME").ToString() ' dtRow.Rows(a).Item("DES").ToString() '+ "(" + dsRptRws.Tables(0).Rows(i).Item("UNITSHRT").ToString() + ")"

                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            'Td.Width = 200
                            'Td.Controls.Add(btn)
                            Td.Controls.Add(lbl)
                            Tr.Controls.Add(Td)
                            'tblCAGR.Controls.Add(Tr)
                        Else
                            HeaderTdSetting(Td, "150px", "", "1")
                            lbl = New Label
                            If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                Dim ProdCount As New Double
                                dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    Next
                                End If
                                'lbl.Text = ProdCount.ToString()

                                'sssssssssssssssssssssss
                                lbl.Text = FormatNumber(ProdCount.ToString() * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                'sssssssssssssssssssssss
                            Else
                                Dim count1 As New Double
                                Dim count2 As New Double
                                Dim diff As New Double
                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                dtRptCols1 = dvRptCols1.ToTable()
                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                dtRptCols2 = dvRptCols2.ToTable()

                                dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    Next
                                End If

                                dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    Next
                                End If

                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                lbl.Text = FormatNumber(lbl.Text * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                            End If

                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Right")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Width = 120
                            Td.Style.Add("padding-left", "5px")
                            'Td.CssClass = "AlterNateColor2"
                            Tr.Controls.Add(Td)

                        End If
                    Next
                    Tr.CssClass = "header"
                    tblCAGR.Controls.Add(Tr)
                Next
                dvPack.RowFilter = "FACTID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString()
                dtPack = dvPack.ToTable()
                For a = 0 To dtPack.Rows.Count - 1
                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                    dtRptAct = dvRptAct.ToTable()
                    If dtRptAct.Rows.Count > 0 Then
                        Tr = New TableRow()
                        Tr.ID = dtProd.Rows(0).Item("CATEGORYNAME").ToString() + "_" + (a + 1).ToString()
                        For j = 0 To ColCnt
                            Td = New TableCell()
                            If j = 0 Then
                                HeaderTdSetting(Td, "200px", "", "1")
                                lbl = New Label
                                lbl.Text = dtPack.Rows(a).Item("VALUE").ToString()

                                Td.Style.Add("text-align", "Left")
                                Td.Font.Size = 10
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = True
                                Td.Style.Add("padding-left", "25px")
                                Td.Controls.Add(lbl)

                            Else
                                'HeaderTdSetting(Td, "150px", "", "1")
                                lbl = New Label
                                If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                    Dim PackCount As New Double
                                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        For l = 0 To dtRptAct.Rows.Count - 1
                                            PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        Next
                                    End If
                                    'lbl.Text = PackCount.ToString()
                                    lbl.Text = FormatNumber(PackCount.ToString() * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                Else
                                    Dim count1 As New Double
                                    Dim count2 As New Double
                                    Dim diff As New Double
                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                    dtRptCols1 = dvRptCols1.ToTable()
                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                    dtRptCols2 = dvRptCols2.ToTable()

                                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        For l = 0 To dtRptAct.Rows.Count - 1
                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        Next
                                    End If

                                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        For l = 0 To dtRptAct.Rows.Count - 1
                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        Next
                                    End If

                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                    lbl.Text = FormatNumber(lbl.Text * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                End If

                                Td.Style.Add("text-align", "Right")
                                Td.Font.Size = 8
                                Td.Font.Name = "Verdana"
                                Td.Style.Add("color", "#660022")
                                Td.CssClass = "AlterNateColor2"
                                Td.Font.Bold = True
                                Td.Style.Add("padding-left", "5px")
                                Td.Controls.Add(lbl)

                            End If
                            Tr.Controls.Add(Td)

                        Next
                        Tr.CssClass = "com"
                        tblCAGR.Controls.Add(Tr)

                        dvRow.RowFilter = "PRODID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString() + " AND PACKTYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                        dtRow = dvRow.ToTable()

                        For b = 0 To dtRow.Rows.Count - 1
                            Tr = New TableRow()
                            For j = 0 To ColCnt
                                Td = New TableCell()
                                If j = 0 Then
                                    HeaderTdSetting(Td, "200px", "", "1")
                                    lbl = New Label
                                    lbl.Text = dtRow.Rows(b).Item("DES").ToString() '+ "(" + dsRptRws.Tables(0).Rows(i).Item("UNITSHRT").ToString() + ")"

                                    Td.Style.Add("text-align", "Left")
                                    Td.Font.Size = 10
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-left", "50px")
                                    Td.Controls.Add(lbl)
                                Else
                                    If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        dvRptAct.RowFilter = "YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + "AND CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND MATERIALID=" + dtRow.Rows(b).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                            Td.Text = FormatNumber(Td.Text * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                        End If

                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()

                                        dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND MATERIALID=" + dtRow.Rows(b).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                        End If

                                        dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND MATERIALID=" + dtRow.Rows(b).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                        End If

                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                        Td.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        Td.Text = FormatNumber(Td.Text * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                    End If

                                    InnerTdSetting(Td, "", "Right")
                                    Td.CssClass = "AlterNateColor2"
                                End If
                                Td.Font.Size = 8.5
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = False
                                Tr.Controls.Add(Td)
                            Next
                            Tr.CssClass = "com1"
                            tblCAGR.Controls.Add(Tr)
                        Next
                    End If
                Next

            End If
        Next


        tblCAGR.Visible = True
    End Sub


    Private Sub SetUniformReportProdPackMat_OLD(ByVal reportDes As String, ByVal rptType As String)
        Dim objGetData As New Selectdata()
        Dim dsRptRws As New DataSet()

        Dim dsRptFilter As New DataSet()

        Dim dsRptFilterValue As New DataSet()
        Dim dsUnitPref As New DataSet
        Dim ColCnt As New Integer
        Dim RowCnt As New Integer
        Dim FiltCnt As New Integer
        Dim groupId As String = String.Empty
        Dim Dr() As DataRow
        Dim i As New Integer
        Dim j As New Integer
        Dim l As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim lbl As New Label
        Dim Fact As New Decimal
        Dim Link As New HyperLink
        Dim hyd As New HiddenField
        Dim CountryFilter As Boolean
        Dim k1 As Integer = 0
        Dim ProdId As String = ""
        Dim ProdTbl(11) As String
        Dim PackId As String = ""
        Dim Unit As String = ""
        Dim YearId As String = ""
        Dim dValue As Integer = 1
        Dim dsTables As New DataSet
        Dim dvTables As New DataView
        Dim dtTables As New DataTable
        Dim dsProd As New DataSet
        Dim dvProd As New DataView
        Dim dtProd As New DataTable
        Dim dsRptAct As New DataSet()
        Dim dvRptAct As New DataView()
        Dim dtRptAct As New DataTable()
        Dim dsRow As New DataSet
        Dim dvRow As New DataView
        Dim dtRow As New DataTable
        Dim dsPack As New DataSet
        Dim dvPack As New DataView
        Dim dtPack As New DataTable
        Dim dsRptCols As New DataSet()
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable

        If rdbActual.Checked = True Then
            dValue = 1
        ElseIf rdbMil.Checked = True Then
            dValue = 1000000
        ElseIf rdbBil.Checked = True Then
            dValue = 1000000000
        ElseIf rdbThou.Checked = True Then
            dValue = 1000
        End If


        If hidReport.Value <> "0" Then
            dsUnitPref = Session("dsPref" + REPId.ToString())
            dsRptRws = Session("dsRows" + REPId.ToString())
            dsRptCols = Session("dsColumns" + REPId.ToString())
            dsRptFilter = Session("dsFilters" + REPId.ToString())
        Else
            dsUnitPref = objGetData.GetPref(REPId.ToString())
            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            dsRptCols = objGetData.GetUsersDynamicReportCols(REPId.ToString())
            dsRptFilter = objGetData.GetUsersReportFilters(REPId.ToString())

            Session("dsPref" + REPId.ToString()) = dsUnitPref
            Session("dsRows" + REPId.ToString()) = dsRptRws
            Session("dsColumns" + REPId.ToString()) = dsRptCols
            Session("dsFilters" + REPId.ToString()) = dsRptFilter

            hidReport.Value = "1"
        End If
        Unit = "1"
        For a = 0 To dsRptCols.Tables(0).Rows.Count - 1
            If dsRptCols.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                YearId = YearId + "" + dsRptCols.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
            End If
        Next
        YearId = YearId.Remove(YearId.Length - 1)

        For a = 0 To dsRptFilter.Tables(0).Rows.Count - 1
            If dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    For b = 0 To dsTables.Tables(0).Rows.Count - 1
                        ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                        ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                        RowCnt += 1
                    Next
                    dtTables = dsTables.Tables(0)
                    ProdId = ProdId.Remove(ProdId.Length - 1)
                Else
                    ProdId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                    dtTables = dvTables.ToTable()
                    ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                    RowCnt += 1
                End If
            ElseIf dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    If ProdId <> "" Then
                        dsPack = objGetData.GetPivotPackage(ProdId)
                    Else

                    End If
                    For b = 0 To dsPack.Tables(0).Rows.Count - 1
                        PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("ID").ToString() + ","
                        'RowCnt += 1
                    Next
                    PackId = PackId.Remove(PackId.Length - 1)
                Else
                    PackId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsPack = objGetData.GetProductTypeByPack(PackId)
                End If

            End If
        Next

        groupId = Session("M1SubGroupId").ToString()
        dsRptAct = objGetData.GetPivotReportData(ProdTbl, "MAT", YearId, PackId, Unit, dsTables.Tables(0).Rows.Count)
        dsProd = objGetData.GetProductDescription(ProdId)
        dsRow = objGetData.GetPivotMaterialss(ProdId, PackId)
        Try



        Catch ex As Exception

        End Try


        'If dsRptRws.Tables.Count > 0 Then
        '    RowCnt = dsRptRws.Tables(0).Rows.Count - 1
        'End If
        If dsRptCols.Tables.Count > 0 Then
            ColCnt = dsRptCols.Tables(0).Rows.Count
        End If
        If dsRptFilter.Tables.Count > 0 Then
            FiltCnt = dsRptFilter.Tables(0).Rows.Count
        End If

        Dim count As Integer = FiltCnt + ColCnt

        tblCAGR.Rows.Clear()
        'filter row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                For l = 0 To FiltCnt - 1
                    Link = New HyperLink
                    hyd = New HiddenField
                    lbl = New Label
                    Link.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    lbl.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    hyd.Value = dsRptFilter.Tables(0).Rows(l).Item("USERREPORTFILTERID").ToString()
                    Link.ID = "Filter_" + (l + 1).ToString()
                    hyd.ID = "Filter_ID_" + (l + 1).ToString()
                    Link.CssClass = "LinkM"

                    GetFilterLink(dsRptFilter.Tables(0).Rows(l).Item("FILTERSEQUENCE").ToString(), Link, dsRptFilter.Tables(0).Rows(l).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                    If rptType = "Base" Then
                        HeaderTd.Controls.Add(lbl)
                    Else
                        HeaderTd.Controls.Add(Link)
                    End If
                    'HeaderTd.Controls.Add(lbl)
                    HeaderTd.Controls.Add(hyd)
                Next
                HeaderTdSetting(HeaderTd, "150px", "", "1")
            Else
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)

        'Hedaer Row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                lbl = New Label
                If reportDes = "REGION" Then
                    lbl.Text = "GEOGRAPHIC REGIONS"
                ElseIf reportDes = "PACKGRP" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "PROD" Then
                    lbl.Text = "PRODUCTS"
                ElseIf reportDes = "MAT" Then
                    lbl.Text = "MATERIALS"
                ElseIf reportDes = "PACK" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "GROUP" Then
                    lbl.Text = "GROUP"
                ElseIf reportDes = "CNTRY" Then
                    lbl.Text = "COUNTRIES"
                End If
                HeaderTd.Controls.Add(lbl)
                HeaderTdSetting(HeaderTd, "150px", "", "1")
            Else
                hyd = New HiddenField
                Link = New HyperLink
                lbl = New Label
                Dim k As New Integer
                k = j - 1

                If dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString() + "(" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE1").ToString() + "/" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE2").ToString() + ")"
                Else
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString()
                End If
                lbl.Text = Link.Text
                Link.ID = "Column_" + k.ToString()
                hyd.ID = "Column_ID_" + k.ToString()
                hyd.Value = dsRptCols.Tables(0).Rows(k).Item("USERREPORTCOLUMNID").ToString()
                Link.CssClass = "LinkM"
                GetColLink(dsRptCols.Tables(0).Rows(k).Item("COLUMNSEQUENCE").ToString(), Link, dsRptCols.Tables(0).Rows(k).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                If rptType = "Base" Then
                    HeaderTd.Controls.Add(lbl)
                Else
                    HeaderTd.Controls.Add(Link)
                End If

                HeaderTd.Controls.Add(hyd)
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)


        'SET THE UNIT & SUMMERY PART
        For i = 0 To 0
            Tr = New TableRow()
            For j = 0 To ColCnt
                Td = New TableCell()
                lbl = New Label
                If j = 0 Then
                    HeaderTdSetting(Td, "150px", "", "1")
                    If i = 0 Then
                        lbl.Text = "UNIT"
                    End If
                Else
                    HeaderTdSetting(Td, "100px", "", "1")
                    If i = 0 Then

                        lbl.ID = "lbl_" + j.ToString()
                        If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                            lbl.Text = "(%)"
                        Else
                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                lbl.Text = "(lb)" '"(" + dsRptRws.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                            Else
                                lbl.Text = "(lb)" '"(" + dsRptRws.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                            End If
                            lbl.Text = "(lb)"
                            hidUnitShort.Value = lbl.Text
                        End If
                        Td.Style.Add("text-align", "Center")

                    End If
                End If

                Td.Font.Size = 8
                Td.Font.Name = "Verdana"
                Td.Font.Bold = False
                Td.Controls.Add(lbl)
                Tr.Controls.Add(Td)
            Next
            tblCAGR.Controls.Add(Tr)
        Next

        dvProd = dsProd.Tables(0).DefaultView
        dvRptAct = dsRptAct.Tables(0).DefaultView
        dvRow = dsRow.Tables(0).DefaultView
        dvPack = dsPack.Tables(0).DefaultView
        dvRptCols1 = dsRptCols.Tables(0).DefaultView
        dvRptCols2 = dsRptCols.Tables(0).DefaultView

        Dim btn As New Button
        'Inner Row
        For i = 0 To RowCnt - 1
            dvProd.RowFilter = "FACTID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString()
            dtProd = dvProd.ToTable()
            dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString()
            dtRptAct = dvRptAct.ToTable()

            If dtRptAct.Rows.Count > 0 Then
                For c = 0 To 0
                    Tr = New TableRow()
                    For j = 0 To ColCnt
                        Td = New TableCell()
                        If j = 0 Then
                            HeaderTdSetting(Td, "150px", "", "1")
                            btn = New Button
                            btn.ID = "btn" + dtProd.Rows(0).Item("CATEGORYNAME").ToString() + "_" + (i + 1).ToString()
                            btn.Text = "+"
                            btn.OnClientClick = "javascript:return showLines('" + btn.ID + "');"
                            lbl = New Label
                            lbl.Text = "<span class='icon'>+</span><b> " + dtProd.Rows(0).Item("CATEGORYNAME").ToString() ' dtRow.Rows(a).Item("DES").ToString() '+ "(" + dsRptRws.Tables(0).Rows(i).Item("UNITSHRT").ToString() + ")"

                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 10
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            'Td.Width = 200
                            'Td.Controls.Add(btn)
                            Td.Controls.Add(lbl)
                            Tr.Controls.Add(Td)
                            'tblCAGR.Controls.Add(Tr)
                        Else
                            'HeaderTdSetting(Td, "150px", "", "1")
                            lbl = New Label
                            If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                Dim ProdCount As New Double
                                dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    Next
                                End If
                                lbl.Text = ProdCount.ToString()
                            Else
                                Dim count1 As New Double
                                Dim count2 As New Double
                                Dim diff As New Double
                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                dtRptCols1 = dvRptCols1.ToTable()
                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                dtRptCols2 = dvRptCols2.ToTable()

                                dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    Next
                                End If

                                dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                    Next
                                End If

                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)

                            End If

                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Right")
                            Td.Font.Size = 10
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Width = 120
                            Td.Style.Add("padding-left", "5px")
                            Td.CssClass = "AlterNateColor2"
                            Tr.Controls.Add(Td)

                        End If
                    Next
                    Tr.CssClass = "header"
                    tblCAGR.Controls.Add(Tr)
                Next
                dvPack.RowFilter = "FACTID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString()
                dtPack = dvPack.ToTable()
                For a = 0 To dtPack.Rows.Count - 1
                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                    dtRptAct = dvRptAct.ToTable()
                    If dtRptAct.Rows.Count > 0 Then
                        Tr = New TableRow()
                        Tr.ID = dtProd.Rows(0).Item("CATEGORYNAME").ToString() + "_" + (a + 1).ToString()
                        For j = 0 To ColCnt
                            Td = New TableCell()
                            If j = 0 Then
                                HeaderTdSetting(Td, "150px", "", "1")
                                lbl = New Label
                                lbl.Text = dtPack.Rows(a).Item("VALUE").ToString()

                                Td.Style.Add("text-align", "Left")
                                Td.Font.Size = 10
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = True
                                Td.Style.Add("padding-left", "25px")
                                Td.Controls.Add(lbl)

                            Else
                                'HeaderTdSetting(Td, "150px", "", "1")
                                lbl = New Label
                                If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                    Dim PackCount As New Double
                                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        For l = 0 To dtRptAct.Rows.Count - 1
                                            PackCount = PackCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        Next
                                    End If
                                    lbl.Text = PackCount.ToString()

                                Else
                                    Dim count1 As New Double
                                    Dim count2 As New Double
                                    Dim diff As New Double
                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                    dtRptCols1 = dvRptCols1.ToTable()
                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                    dtRptCols2 = dvRptCols2.ToTable()

                                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        For l = 0 To dtRptAct.Rows.Count - 1
                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        Next
                                    End If

                                    dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        For l = 0 To dtRptAct.Rows.Count - 1
                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        Next
                                    End If

                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                End If

                                Td.Style.Add("text-align", "Right")
                                Td.Font.Size = 8
                                Td.Font.Name = "Verdana"
                                Td.Style.Add("color", "#660022")
                                Td.CssClass = "AlterNateColor2"
                                Td.Font.Bold = True
                                Td.Style.Add("padding-left", "5px")
                                Td.Controls.Add(lbl)

                            End If
                            Tr.Controls.Add(Td)

                        Next
                        Tr.CssClass = "com"
                        tblCAGR.Controls.Add(Tr)

                        dvRow.RowFilter = "PRODID=" + dtTables.Rows(i).Item("ACTUALPRODUCTID").ToString() + " AND PACKTYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                        dtRow = dvRow.ToTable()

                        For b = 0 To dtRow.Rows.Count - 1
                            Tr = New TableRow()
                            For j = 0 To ColCnt
                                Td = New TableCell()
                                If j = 0 Then
                                    HeaderTdSetting(Td, "150px", "", "1")
                                    lbl = New Label
                                    lbl.Text = dtRow.Rows(b).Item("DES").ToString() '+ "(" + dsRptRws.Tables(0).Rows(i).Item("UNITSHRT").ToString() + ")"

                                    Td.Style.Add("text-align", "Left")
                                    Td.Font.Size = 10
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-left", "50px")
                                    Td.Controls.Add(lbl)
                                Else
                                    If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        dvRptAct.RowFilter = "YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + "AND CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND MATERIALID=" + dtRow.Rows(b).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                        End If

                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()

                                        dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND MATERIALID=" + dtRow.Rows(b).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            count1 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                        End If

                                        dvRptAct.RowFilter = "CATEGORYID=" + dtProd.Rows(0).Item("ID").ToString() + " AND MATERIALID=" + dtRow.Rows(b).Item("ID").ToString() + " AND PACKAGETYPEID=" + dtPack.Rows(a).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            count2 = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                        End If

                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")

                                        Td.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                    End If

                                    InnerTdSetting(Td, "", "Right")
                                    Td.CssClass = "AlterNateColor2"
                                End If
                                Td.Font.Size = 8.5
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = False
                                Tr.Controls.Add(Td)
                            Next
                            Tr.CssClass = "com1"
                            tblCAGR.Controls.Add(Tr)
                        Next
                    End If
                Next

            End If
        Next

        'For i = 0 To 0
        '    Tr = New TableRow()
        '    For j = 0 To ColCnt
        '        Td = New TableCell()
        '        lbl = New Label
        '        If j = 0 Then
        '            HeaderTdSetting(Td, "150px", "", "1")
        '            If i = 0 Then
        '                lbl.Text = "GRAND TOTAL"
        '            End If
        '        Else
        '            HeaderTdSetting(Td, "100px", "", "1")
        '            If i = 0 Then
        '                lbl.ID = "lblb_" + j.ToString()
        '                If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
        '                    Dim BeginYearId As String = String.Empty
        '                    Dim EndYearId As String = String.Empty
        '                    BeginYearId = dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
        '                    EndYearId = dsRptCols.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
        '                    lbl.Text = FormatNumber(GetCAGRValueTotal(dsRptAct, dsRptCols.Tables(0).Rows(j - 1).Item("COLCOLUMNID").ToString(), BeginYearId, EndYearId, dsRptCols), 4)
        '                Else
        '                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
        '                        If dsRptRws.Tables(0).Rows(0).Item("UNITID").ToString() = "1" Then
        '                            lbl.Text = GetFactValueTotalCountry(dsRptAct, dsRptCols.Tables(0).Rows(j - 1).Item("COLCOLUMNID").ToString(), dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString(), dsRptRws)
        '                        ElseIf dsRptRws.Tables(0).Rows(0).Item("UNITID").ToString() = "2" Then
        '                            lbl.Text = GetFactValueTotalCountry(dsRptAct, dsRptCols.Tables(0).Rows(j - 1).Item("COLCOLUMNID").ToString(), dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString(), dsRptRws)
        '                        ElseIf dsRptRws.Tables(0).Rows(0).Item("UNITID").ToString() = "4" Then
        '                            lbl.Text = GetFactValueTotalCountry(dsRptAct, dsRptCols.Tables(0).Rows(j - 1).Item("COLCOLUMNID").ToString(), dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString(), dsRptRws)
        '                        Else
        '                            lbl.Text = GetFactValueTotalCountry(dsRptAct, dsRptCols.Tables(0).Rows(j - 1).Item("COLCOLUMNID").ToString(), dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString(), dsRptRws)
        '                        End If
        '                    ElseIf dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 1 Then
        '                        If dsRptRws.Tables(0).Rows(0).Item("UNITID").ToString() = "1" Then
        '                            lbl.Text = (GetFactValueTotalCountry(dsRptAct, dsRptCols.Tables(0).Rows(j - 1).Item("COLCOLUMNID").ToString(), dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString(), dsRptRws) * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT")).ToString()
        '                        ElseIf dsRptRws.Tables(0).Rows(0).Item("UNITID").ToString() = "2" Then
        '                            lbl.Text = (GetFactValueTotalCountry(dsRptAct, dsRptCols.Tables(0).Rows(j - 1).Item("COLCOLUMNID").ToString(), dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString(), dsRptRws) * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
        '                        ElseIf dsRptRws.Tables(0).Rows(0).Item("UNITID").ToString() = "3" Then
        '                            lbl.Text = (GetFactValueTotalCountry(dsRptAct, dsRptCols.Tables(0).Rows(j - 1).Item("COLCOLUMNID").ToString(), dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString(), dsRptRws) * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
        '                        ElseIf dsRptRws.Tables(0).Rows(0).Item("UNITID").ToString() = "4" Then
        '                            lbl.Text = GetFactValueTotalCountry(dsRptAct, dsRptCols.Tables(0).Rows(j - 1).Item("COLCOLUMNID").ToString(), dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString(), dsRptRws)
        '                        Else
        '                            lbl.Text = GetFactValueTotalCountry(dsRptAct, dsRptCols.Tables(0).Rows(j - 1).Item("COLCOLUMNID").ToString(), dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString(), dsRptRws)
        '                        End If
        '                    End If
        '                    'lbl.Text = FormatNumber(lbl.Text, 0)
        '                    If rdbMil.Checked = True Or rdbBil.Checked = True Then
        '                        lbl.Text = FormatNumber((lbl.Text / dValue), 3)
        '                    Else
        '                        lbl.Text = FormatNumber((lbl.Text / dValue), 0)
        '                    End If
        '                End If
        '                Td.Style.Add("text-align", "Right")
        '                Td.Style.Add("padding-right", "5px")
        '                Td.CssClass = "AlterNateColor2"
        '            End If

        '        End If

        '        Td.Font.Size = 8
        '        Td.Font.Name = "Verdana"
        '        Td.Font.Bold = False
        '        Td.Controls.Add(lbl)
        '        Tr.Controls.Add(Td)
        '    Next
        '    tblCAGR.Controls.Add(Tr)
        'Next
        tblCAGR.Visible = True
    End Sub

    'SetUniformReport_MAT_PACK_PROD
    Private Sub SetUniformReport_MAT_PACK_PROD(ByVal reportDes As String, ByVal rptType As String)
        Dim objGetData As New Selectdata()
        Dim dsRptRws As New DataSet()
        Dim dsRptCols As New DataSet()
        Dim dsRptFilter As New DataSet()

        Dim dsRptFilterValue As New DataSet()
        Dim dsUnitPref As New DataSet
        Dim ColCnt As New Integer
        Dim RowCnt As New Integer
        Dim FiltCnt As New Integer
        Dim groupId As String = String.Empty
        Dim Dr() As DataRow
        Dim i As New Integer
        Dim j As New Integer
        Dim l As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim lbl As New Label
        Dim Fact As New Decimal
        Dim Link As New HyperLink
        Dim hyd As New HiddenField
        Dim CountryFilter As Boolean
        Dim k1 As Integer = 0
        Dim ProdId As String = ""
        Dim ProdTbl(11) As String
        Dim PackId As String = ""
        Dim Unit As String = ""
        Dim YearId As String = ""
        Dim dValue As Integer = 1
        Dim dsTables As New DataSet
        Dim dvTables As New DataView
        Dim dtTables As New DataTable
        Dim dsProd As New DataSet
        Dim dvProd As New DataView
        Dim dtProd As New DataTable
        Dim dsRptAct As New DataSet()
        Dim dvRptAct As New DataView()
        Dim dtRptAct As New DataTable()
        Dim dsRow As New DataSet
        Dim dvRow As New DataView
        Dim dtRow As New DataTable
        Dim dsPack As New DataSet
        Dim dvPack As New DataView
        Dim dtPack As New DataTable

        If rdbActual.Checked = True Then
            dValue = 1
        ElseIf rdbMil.Checked = True Then
            dValue = 1000000
        ElseIf rdbBil.Checked = True Then
            dValue = 1000000000
        ElseIf rdbThou.Checked = True Then
            dValue = 1000
        End If


        If hidReport.Value <> "0" Then
            dsUnitPref = Session("dsPref" + REPId.ToString())
            dsRptRws = Session("dsRows" + REPId.ToString())
            dsRptCols = Session("dsColumns" + REPId.ToString())
            dsRptFilter = Session("dsFilters" + REPId.ToString())
        Else
            dsUnitPref = objGetData.GetPref(REPId.ToString())
            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            dsRptCols = objGetData.GetUsersDynamicReportCols(REPId.ToString())
            dsRptFilter = objGetData.GetUsersReportFilters(REPId.ToString())

            Session("dsPref" + REPId.ToString()) = dsUnitPref
            Session("dsRows" + REPId.ToString()) = dsRptRws
            Session("dsColumns" + REPId.ToString()) = dsRptCols
            Session("dsFilters" + REPId.ToString()) = dsRptFilter

            hidReport.Value = "1"
        End If
        Unit = "1"
        For a = 0 To dsRptCols.Tables(0).Rows.Count - 1
            YearId = YearId + "" + dsRptCols.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
        Next
        YearId = YearId.Remove(YearId.Length - 1)
        Dim packCNT As Integer = 0
        For a = 0 To dsRptFilter.Tables(0).Rows.Count - 1
            If dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    For b = 0 To dsTables.Tables(0).Rows.Count - 1
                        ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                        ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                        RowCnt += 1
                    Next
                    ProdId = ProdId.Remove(ProdId.Length - 1)
                Else
                    ProdId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                    dtTables = dvTables.ToTable()
                    ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                    RowCnt += 1
                End If
            ElseIf dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    If ProdId <> "" Then
                        dsPack = objGetData.GetPackageTypeByFact(ProdId)
                    Else

                    End If
                    For b = 0 To dsPack.Tables(0).Rows.Count - 1
                        PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("ID").ToString() + ","
                        packCNT += 1
                    Next
                    PackId = PackId.Remove(PackId.Length - 1)
                Else
                    PackId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsPack = objGetData.GetProductTypeByPack(PackId)
                    packCNT = 1
                End If

            End If
        Next

        groupId = Session("M1SubGroupId").ToString()
        dsRptAct = objGetData.GetPivotReportData(ProdTbl, "MAT", YearId, PackId, Unit, dsTables.Tables(0).Rows.Count)
        dsProd = objGetData.GetProductDescription(ProdId)
        dsRow = objGetData.GetPivotMaterialss(ProdId, PackId)
        Dim dsMatPiv As New DataSet
        dsMatPiv = objGetData.GetMedicalDeviceMaterials(ProdId)
        Unit = objGetData.GetPivotUnit(REPId.ToString())
        Try



        Catch ex As Exception

        End Try


        'If dsRptRws.Tables.Count > 0 Then
        '    RowCnt = dsRptRws.Tables(0).Rows.Count - 1
        'End If
        If dsRptCols.Tables.Count > 0 Then
            ColCnt = dsRptCols.Tables(0).Rows.Count
        End If
        If dsRptFilter.Tables.Count > 0 Then
            FiltCnt = dsRptFilter.Tables(0).Rows.Count
        End If

        Dim count As Integer = FiltCnt + ColCnt

        tblCAGR.Rows.Clear()
        'filter row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                For l = 0 To FiltCnt - 1
                    Link = New HyperLink
                    hyd = New HiddenField
                    lbl = New Label
                    Link.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    lbl.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    hyd.Value = dsRptFilter.Tables(0).Rows(l).Item("USERREPORTFILTERID").ToString()
                    Link.ID = "Filter_" + (l + 1).ToString()
                    hyd.ID = "Filter_ID_" + (l + 1).ToString()
                    Link.CssClass = "LinkM"

                    GetFilterLink(dsRptFilter.Tables(0).Rows(l).Item("FILTERSEQUENCE").ToString(), Link, dsRptFilter.Tables(0).Rows(l).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                    If rptType = "Base" Then
                        HeaderTd.Controls.Add(lbl)
                    Else
                        HeaderTd.Controls.Add(Link)
                    End If
                    'HeaderTd.Controls.Add(lbl)
                    HeaderTd.Controls.Add(hyd)
                Next
                HeaderTdSetting(HeaderTd, "200px", "", "1")
            Else
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)

        'Hedaer Row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                lbl = New Label
                If reportDes = "REGION" Then
                    lbl.Text = "GEOGRAPHIC REGIONS"
                ElseIf reportDes = "PACKGRP" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "PROD" Then
                    lbl.Text = "PRODUCTS"
                ElseIf reportDes = "MAT" Then
                    lbl.Text = "MATERIALS"
                ElseIf reportDes = "PACK" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "GROUP" Then
                    lbl.Text = "GROUP"
                ElseIf reportDes = "CNTRY" Then
                    lbl.Text = "COUNTRIES"
                End If
                HeaderTd.Controls.Add(lbl)
                HeaderTdSetting(HeaderTd, "200px", "", "1")
            Else
                hyd = New HiddenField
                Link = New HyperLink
                lbl = New Label
                Dim k As New Integer
                k = j - 1

                If dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString() + "(" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE1").ToString() + "/" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE2").ToString() + ")"
                Else
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString()
                End If
                lbl.Text = Link.Text
                Link.ID = "Column_" + k.ToString()
                hyd.ID = "Column_ID_" + k.ToString()
                hyd.Value = dsRptCols.Tables(0).Rows(k).Item("USERREPORTCOLUMNID").ToString()
                Link.CssClass = "LinkM"
                GetColLink(dsRptCols.Tables(0).Rows(k).Item("COLUMNSEQUENCE").ToString(), Link, dsRptCols.Tables(0).Rows(k).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                If rptType = "Base" Then
                    HeaderTd.Controls.Add(lbl)
                Else
                    HeaderTd.Controls.Add(Link)
                End If

                HeaderTd.Controls.Add(hyd)
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)


        'SET THE UNIT & SUMMERY PART
        For i = 0 To 0
            Tr = New TableRow()
            For j = 0 To ColCnt
                Td = New TableCell()
                lbl = New Label
                If j = 0 Then
                    HeaderTdSetting(Td, "200px", "", "1")
                    If i = 0 Then
                        lbl.Text = "UNIT"
                    End If
                Else
                    HeaderTdSetting(Td, "100px", "", "1")
                    If i = 0 Then
                        ' If j > count - ColCnt Then
                        lbl.ID = "lbl_" + j.ToString()
                        If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                            lbl.Text = "(%)"
                        Else
                            lbl.Text = "(" + dsUnitPref.Tables(0).Rows(0).Item("TITLE1").ToString() + ")"

                            hidUnitShort.Value = lbl.Text
                        End If
                        Td.Style.Add("text-align", "Center")
                        'End If
                    End If
                End If

                Td.Font.Size = 8
                Td.Font.Name = "Verdana"
                Td.Font.Bold = False
                Td.Controls.Add(lbl)
                Tr.Controls.Add(Td)
            Next
            tblCAGR.Controls.Add(Tr)
        Next

        dvProd = dsProd.Tables(0).DefaultView
        dvRptAct = dsRptAct.Tables(0).DefaultView
        dvRow = dsRow.Tables(0).DefaultView

        Dim dvMatD As New DataView
        Dim dtMatD As New DataTable
        dvMatD = dsMatPiv.Tables(0).DefaultView

        'Inner Row
        For i = 0 To dsMatPiv.Tables(0).Rows.Count - 1
            dvMatD.RowFilter = "ID=" + dsMatPiv.Tables(0).Rows(i).Item("ID").ToString()
            dtMatD = dvMatD.ToTable()
            dvRptAct.RowFilter = "MATERIALID=" + dtMatD.Rows(0).Item("ID").ToString()
            dtRptAct = dvRptAct.ToTable()

            If dtRptAct.Rows.Count > 0 Then
                For a = 0 To 0
                    Tr = New TableRow()
                    For j = 0 To ColCnt
                        Td = New TableCell()
                        If j = 0 Then
                            HeaderTdSetting(Td, "200px", "", "1")
                            lbl = New Label
                            lbl.Text = "<span class='icon'>+</span><b> " + dtMatD.Rows(0).Item("DES").ToString()

                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            Td.Controls.Add(lbl)
                            Tr.Controls.Add(Td)
                            'tblCAGR.Controls.Add(Tr)
                        Else
                            HeaderTdSetting(Td, "130px", "", "1")
                            Dim j2 As Integer = 0
                            Dim sumFCT As Double = 0.0
                            dvRptAct.RowFilter = " MATERIALID=" + dtMatD.Rows(0).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                            dtRptAct = dvRptAct.ToTable()
                            For j2 = 0 To dtRptAct.Rows.Count - 1

                                sumFCT = sumFCT + dtRptAct.Rows(j2).Item("FCT").ToString()
                            Next
                            sumFCT = FormatNumber(sumFCT, 0)

                            Td.Font.Bold = True
                            Td.Style.Add("text-align", "Right")

                            lbl = New Label
                            lbl.Text = sumFCT
                            lbl.Text = FormatNumber(sumFCT.ToString() * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                            Td.Controls.Add(lbl)

                            Td.Font.Size = 9
                            'Td.Width = 120
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-right", "5px")
                            'Td.Controls.Add(lbl)
                            'Td.CssClass = "AlterNateColor2"
                            Tr.Controls.Add(Td)

                        End If
                    Next
                    Tr.CssClass = "header"
                    tblCAGR.Controls.Add(Tr)
                Next
                For a = 0 To packCNT - 1 'dsPack.Tables(0).Rows.Count - 1
                    dvRptAct.RowFilter = "MATERIALID=" + dtMatD.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dsPack.Tables(0).Rows(a).Item("ID").ToString()
                    dtRptAct = dvRptAct.ToTable()
                    If dtRptAct.Rows.Count > 0 Then
                        Tr = New TableRow()
                        For j = 0 To ColCnt
                            Td = New TableCell()
                            If j = 0 Then
                                HeaderTdSetting(Td, "200px", "", "1")
                                lbl = New Label
                                lbl.Text = dsPack.Tables(0).Rows(a).Item("VALUE").ToString()


                                Td.Style.Add("text-align", "Left")
                                Td.Font.Size = 9
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = True
                                Td.Style.Add("padding-left", "40px")
                                Td.Controls.Add(lbl)
                                Tr.Controls.Add(Td)
                                Tr.CssClass = "com"
                                tblCAGR.Controls.Add(Tr)
                            Else
                                Dim j2 As Integer = 0
                                Dim sumFCT As Double = 0.0
                                dvRptAct.RowFilter = "PACKAGETYPEID=" + dsPack.Tables(0).Rows(a).Item("ID").ToString() + " AND MATERIALID=" + dtMatD.Rows(0).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                For j2 = 0 To dtRptAct.Rows.Count - 1

                                    sumFCT = sumFCT + dtRptAct.Rows(j2).Item("FCT").ToString()
                                Next
                                sumFCT = FormatNumber(sumFCT, 0)
                                Td.Font.Bold = True
                                Td.Style.Add("text-align", "Right")

                                Td.Font.Size = 8
                                Td.Font.Name = "Verdana"
                                Td.Style.Add("color", "#660022")
                                Td.Style.Add("padding-right", "10px")
                                lbl = New Label
                                lbl.Text = sumFCT
                                lbl.Text = FormatNumber(sumFCT.ToString() * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                Td.Controls.Add(lbl)
                                Td.CssClass = "AlterNateColor2"
                                Tr.Controls.Add(Td)
                                Tr.CssClass = "com"
                                tblCAGR.Controls.Add(Tr)
                            End If
                        Next

                        'dvRow.RowFilter = "PRODID=" + dsTables.Tables(0).Rows(i).Item("ACTUALPRODUCTID").ToString() + " AND PACKTYPEID=" + dsPack.Tables(0).Rows(a).Item("ID").ToString()
                        ' dtRow = dvRow.ToTable()

                        For b = 0 To RowCnt - 1 'dsProd.Tables(0).Rows.Count - 1
                            dvRptAct.RowFilter = "CATEGORYID=" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + " AND PACKAGETYPEID=" + dsPack.Tables(0).Rows(a).Item("ID").ToString() + " AND MATERIALID=" + dtMatD.Rows(0).Item("ID").ToString()
                            dtRptAct = dvRptAct.ToTable()
                            If dtRptAct.Rows.Count > 0 Then
                                Tr = New TableRow()
                                For j = 0 To ColCnt
                                    Td = New TableCell()
                                    If j = 0 Then
                                        HeaderTdSetting(Td, "200px", "", "1")
                                        lbl = New Label
                                        lbl.Text = dsProd.Tables(0).Rows(b).Item("CATEGORYNAME").ToString() '+ "(" + dsRptRws.Tables(0).Rows(i).Item("UNITSHRT").ToString() + ")"

                                        Td.Style.Add("text-align", "Left")
                                        Td.Font.Size = 10
                                        Td.Font.Name = "Verdana"
                                        Td.Font.Bold = True
                                        Td.Style.Add("padding-left", "70px")
                                        Td.Controls.Add(lbl)
                                    Else
                                        dvRptAct.RowFilter = "CATEGORYID=" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + " AND PACKAGETYPEID=" + dsPack.Tables(0).Rows(a).Item("ID").ToString() + " AND MATERIALID=" + dtMatD.Rows(0).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                            Td.Text = FormatNumber(Td.Text * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                        End If
                                        InnerTdSetting(Td, "", "Right")
                                        Td.CssClass = "AlterNateColor2"
                                    End If
                                    Td.Font.Size = 8.5
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = False
                                    Tr.Controls.Add(Td)
                                Next
                                Tr.CssClass = "com1"
                                tblCAGR.Controls.Add(Tr)
                            End If

                        Next
                    End If
                Next

            End If
        Next


        tblCAGR.Visible = True
    End Sub


    Private Sub SetUniformReport_MAT_PACK_PROD_OLD(ByVal reportDes As String, ByVal rptType As String)
        Dim objGetData As New Selectdata()
        Dim dsRptRws As New DataSet()
        Dim dsRptCols As New DataSet()
        Dim dsRptFilter As New DataSet()

        Dim dsRptFilterValue As New DataSet()
        Dim dsUnitPref As New DataSet
        Dim ColCnt As New Integer
        Dim RowCnt As New Integer
        Dim FiltCnt As New Integer
        Dim groupId As String = String.Empty
        Dim Dr() As DataRow
        Dim i As New Integer
        Dim j As New Integer
        Dim l As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim lbl As New Label
        Dim Fact As New Decimal
        Dim Link As New HyperLink
        Dim hyd As New HiddenField
        Dim CountryFilter As Boolean
        Dim k1 As Integer = 0
        Dim ProdId As String = ""
        Dim ProdTbl(11) As String
        Dim PackId As String = ""
        Dim Unit As String = ""
        Dim YearId As String = ""
        Dim dValue As Integer = 1
        Dim dsTables As New DataSet
        Dim dvTables As New DataView
        Dim dtTables As New DataTable
        Dim dsProd As New DataSet
        Dim dvProd As New DataView
        Dim dtProd As New DataTable
        Dim dsRptAct As New DataSet()
        Dim dvRptAct As New DataView()
        Dim dtRptAct As New DataTable()
        Dim dsRow As New DataSet
        Dim dvRow As New DataView
        Dim dtRow As New DataTable
        Dim dsPack As New DataSet
        Dim dvPack As New DataView
        Dim dtPack As New DataTable

        If rdbActual.Checked = True Then
            dValue = 1
        ElseIf rdbMil.Checked = True Then
            dValue = 1000000
        ElseIf rdbBil.Checked = True Then
            dValue = 1000000000
        ElseIf rdbThou.Checked = True Then
            dValue = 1000
        End If


        If hidReport.Value <> "0" Then
            dsUnitPref = Session("dsPref" + REPId.ToString())
            dsRptRws = Session("dsRows" + REPId.ToString())
            dsRptCols = Session("dsColumns" + REPId.ToString())
            dsRptFilter = Session("dsFilters" + REPId.ToString())
        Else
            dsUnitPref = objGetData.GetPref(REPId.ToString())
            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            dsRptCols = objGetData.GetUsersDynamicReportCols(REPId.ToString())
            dsRptFilter = objGetData.GetUsersReportFilters(REPId.ToString())

            Session("dsPref" + REPId.ToString()) = dsUnitPref
            Session("dsRows" + REPId.ToString()) = dsRptRws
            Session("dsColumns" + REPId.ToString()) = dsRptCols
            Session("dsFilters" + REPId.ToString()) = dsRptFilter

            hidReport.Value = "1"
        End If
        Unit = "1"
        For a = 0 To dsRptCols.Tables(0).Rows.Count - 1
            YearId = YearId + "" + dsRptCols.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
        Next
        YearId = YearId.Remove(YearId.Length - 1)

        For a = 0 To dsRptFilter.Tables(0).Rows.Count - 1
            If dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    For b = 0 To dsTables.Tables(0).Rows.Count - 1
                        ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                        ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                        RowCnt += 1
                    Next
                    ProdId = ProdId.Remove(ProdId.Length - 1)
                Else
                    ProdId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                    dtTables = dvTables.ToTable()
                    ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                    RowCnt += 1
                End If
            ElseIf dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    If ProdId <> "" Then
                        dsPack = objGetData.GetPackageTypeByFact(ProdId)
                    Else

                    End If
                    For b = 0 To dsPack.Tables(0).Rows.Count - 1
                        PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("ID").ToString() + ","
                        'RowCnt += 1
                    Next
                    PackId = PackId.Remove(PackId.Length - 1)
                Else
                    PackId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                End If

            End If
        Next

        groupId = Session("M1SubGroupId").ToString()
        dsRptAct = objGetData.GetPivotReportData(ProdTbl, "MAT", YearId, PackId, Unit, dsTables.Tables(0).Rows.Count)
        dsProd = objGetData.GetProductDescription(ProdId)
        dsRow = objGetData.GetPivotMaterialss(ProdId, PackId)
        Dim dsMatPiv As New DataSet
        dsMatPiv = objGetData.GetMedicalDeviceMaterials(ProdId)
        Try



        Catch ex As Exception

        End Try


        'If dsRptRws.Tables.Count > 0 Then
        '    RowCnt = dsRptRws.Tables(0).Rows.Count - 1
        'End If
        If dsRptCols.Tables.Count > 0 Then
            ColCnt = dsRptCols.Tables(0).Rows.Count
        End If
        If dsRptFilter.Tables.Count > 0 Then
            FiltCnt = dsRptFilter.Tables(0).Rows.Count
        End If

        Dim count As Integer = FiltCnt + ColCnt

        tblCAGR.Rows.Clear()
        'filter row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                For l = 0 To FiltCnt - 1
                    Link = New HyperLink
                    hyd = New HiddenField
                    lbl = New Label
                    Link.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    lbl.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    hyd.Value = dsRptFilter.Tables(0).Rows(l).Item("USERREPORTFILTERID").ToString()
                    Link.ID = "Filter_" + (l + 1).ToString()
                    hyd.ID = "Filter_ID_" + (l + 1).ToString()
                    Link.CssClass = "LinkM"

                    GetFilterLink(dsRptFilter.Tables(0).Rows(l).Item("FILTERSEQUENCE").ToString(), Link, dsRptFilter.Tables(0).Rows(l).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                    If rptType = "Base" Then
                        HeaderTd.Controls.Add(lbl)
                    Else
                        HeaderTd.Controls.Add(Link)
                    End If
                    'HeaderTd.Controls.Add(lbl)
                    HeaderTd.Controls.Add(hyd)
                Next
                HeaderTdSetting(HeaderTd, "150px", "", "1")
            Else
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)

        'Hedaer Row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                lbl = New Label
                If reportDes = "REGION" Then
                    lbl.Text = "GEOGRAPHIC REGIONS"
                ElseIf reportDes = "PACKGRP" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "PROD" Then
                    lbl.Text = "PRODUCTS"
                ElseIf reportDes = "MAT" Then
                    lbl.Text = "MATERIALS"
                ElseIf reportDes = "PACK" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "GROUP" Then
                    lbl.Text = "GROUP"
                ElseIf reportDes = "CNTRY" Then
                    lbl.Text = "COUNTRIES"
                End If
                HeaderTd.Controls.Add(lbl)
                HeaderTdSetting(HeaderTd, "150px", "", "1")
            Else
                hyd = New HiddenField
                Link = New HyperLink
                lbl = New Label
                Dim k As New Integer
                k = j - 1

                If dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString() + "(" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE1").ToString() + "/" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE2").ToString() + ")"
                Else
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString()
                End If
                lbl.Text = Link.Text
                Link.ID = "Column_" + k.ToString()
                hyd.ID = "Column_ID_" + k.ToString()
                hyd.Value = dsRptCols.Tables(0).Rows(k).Item("USERREPORTCOLUMNID").ToString()
                Link.CssClass = "LinkM"
                GetColLink(dsRptCols.Tables(0).Rows(k).Item("COLUMNSEQUENCE").ToString(), Link, dsRptCols.Tables(0).Rows(k).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                If rptType = "Base" Then
                    HeaderTd.Controls.Add(lbl)
                Else
                    HeaderTd.Controls.Add(Link)
                End If

                HeaderTd.Controls.Add(hyd)
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)


        'SET THE UNIT & SUMMERY PART
        For i = 0 To 0
            Tr = New TableRow()
            For j = 0 To ColCnt
                Td = New TableCell()
                lbl = New Label
                If j = 0 Then
                    HeaderTdSetting(Td, "150px", "", "1")
                    If i = 0 Then
                        lbl.Text = "UNIT"
                    End If
                Else
                    HeaderTdSetting(Td, "100px", "", "1")
                    If i = 0 Then
                        ' If j > count - ColCnt Then
                        lbl.ID = "lbl_" + j.ToString()
                        If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                            lbl.Text = "(%)"
                        Else
                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                lbl.Text = "(lb)" '"(" + dsRptRws.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                            Else
                                lbl.Text = "(lb)" '"(" + dsRptRws.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                            End If

                            hidUnitShort.Value = lbl.Text
                        End If
                        Td.Style.Add("text-align", "Center")
                        'End If
                    End If
                End If

                Td.Font.Size = 8
                Td.Font.Name = "Verdana"
                Td.Font.Bold = False
                Td.Controls.Add(lbl)
                Tr.Controls.Add(Td)
            Next
            tblCAGR.Controls.Add(Tr)
        Next

        dvProd = dsProd.Tables(0).DefaultView
        dvRptAct = dsRptAct.Tables(0).DefaultView
        dvRow = dsRow.Tables(0).DefaultView

        Dim dvMatD As New DataView
        Dim dtMatD As New DataTable
        dvMatD = dsMatPiv.Tables(0).DefaultView

        'Inner Row
        For i = 0 To dsMatPiv.Tables(0).Rows.Count - 1
            dvMatD.RowFilter = "ID=" + dsMatPiv.Tables(0).Rows(i).Item("ID").ToString()
            dtMatD = dvMatD.ToTable()
            dvRptAct.RowFilter = "MATERIALID=" + dtMatD.Rows(0).Item("ID").ToString()
            dtRptAct = dvRptAct.ToTable()

            If dtRptAct.Rows.Count > 0 Then
                For a = 0 To 0
                    Tr = New TableRow()
                    For j = 0 To ColCnt
                        Td = New TableCell()
                        If j = 0 Then
                            HeaderTdSetting(Td, "150px", "", "1")
                            lbl = New Label
                            lbl.Text = "<span class='icon'>+</span><b> " + dtMatD.Rows(0).Item("DES").ToString()

                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            Td.Controls.Add(lbl)
                            Tr.Controls.Add(Td)
                            'tblCAGR.Controls.Add(Tr)
                        Else
                            'lbl = New Label

                            'Td.Controls.Add(lbl)
                            Dim j2 As Integer = 0
                            Dim sumFCT As Double = 0.0
                            dvRptAct.RowFilter = " MATERIALID=" + dtMatD.Rows(0).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                            dtRptAct = dvRptAct.ToTable()
                            For j2 = 0 To dtRptAct.Rows.Count - 1

                                sumFCT = sumFCT + dtRptAct.Rows(j2).Item("FCT").ToString()
                            Next
                            sumFCT = FormatNumber(sumFCT, 0)
                            Td.Font.Bold = True
                            Td.Style.Add("text-align", "Right")

                            lbl = New Label
                            lbl.Text = sumFCT
                            Td.Controls.Add(lbl)

                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-right", "5px")
                            'Td.Controls.Add(lbl)
                            Td.CssClass = "AlterNateColor2"
                            Tr.Controls.Add(Td)

                        End If
                    Next
                    Tr.CssClass = "header"
                    tblCAGR.Controls.Add(Tr)
                Next
                For a = 0 To dsPack.Tables(0).Rows.Count - 1
                    dvRptAct.RowFilter = "MATERIALID=" + dtMatD.Rows(0).Item("ID").ToString() + " AND PACKAGETYPEID=" + dsPack.Tables(0).Rows(a).Item("ID").ToString()
                    dtRptAct = dvRptAct.ToTable()
                    If dtRptAct.Rows.Count > 0 Then
                        Tr = New TableRow()
                        For j = 0 To ColCnt
                            Td = New TableCell()
                            If j = 0 Then
                                HeaderTdSetting(Td, "150px", "", "1")
                                lbl = New Label
                                lbl.Text = dsPack.Tables(0).Rows(a).Item("VALUE").ToString()


                                Td.Style.Add("text-align", "Left")
                                Td.Font.Size = 9
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = True
                                Td.Style.Add("padding-left", "40px")
                                Td.Controls.Add(lbl)
                                Tr.Controls.Add(Td)
                                tblCAGR.Controls.Add(Tr)
                            Else
                                Dim j2 As Integer = 0
                                Dim sumFCT As Double = 0.0
                                dvRptAct.RowFilter = "PACKAGETYPEID=" + dsPack.Tables(0).Rows(a).Item("ID").ToString() + " AND MATERIALID=" + dtMatD.Rows(0).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                For j2 = 0 To dtRptAct.Rows.Count - 1

                                    sumFCT = sumFCT + dtRptAct.Rows(j2).Item("FCT").ToString()
                                Next
                                sumFCT = FormatNumber(sumFCT, 0)
                                Td.Font.Bold = True
                                Td.Style.Add("text-align", "Right")

                                Td.Font.Size = 8
                                Td.Font.Name = "Verdana"
                                Td.Style.Add("color", "#660022")
                                Td.Style.Add("padding-right", "10px")
                                lbl = New Label
                                lbl.Text = sumFCT
                                Td.Controls.Add(lbl)
                                Td.CssClass = "AlterNateColor2"
                                Tr.Controls.Add(Td)
                                Tr.CssClass = "com"
                                tblCAGR.Controls.Add(Tr)
                            End If
                        Next

                        'dvRow.RowFilter = "PRODID=" + dsTables.Tables(0).Rows(i).Item("ACTUALPRODUCTID").ToString() + " AND PACKTYPEID=" + dsPack.Tables(0).Rows(a).Item("ID").ToString()
                        ' dtRow = dvRow.ToTable()

                        For b = 0 To dsProd.Tables(0).Rows.Count - 1
                            dvRptAct.RowFilter = "CATEGORYID=" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + " AND PACKAGETYPEID=" + dsPack.Tables(0).Rows(a).Item("ID").ToString() + " AND MATERIALID=" + dtMatD.Rows(0).Item("ID").ToString()
                            dtRptAct = dvRptAct.ToTable()
                            If dtRptAct.Rows.Count > 0 Then
                                Tr = New TableRow()
                                For j = 0 To ColCnt
                                    Td = New TableCell()
                                    If j = 0 Then
                                        HeaderTdSetting(Td, "150px", "", "1")
                                        lbl = New Label
                                        lbl.Text = dsProd.Tables(0).Rows(b).Item("CATEGORYNAME").ToString() '+ "(" + dsRptRws.Tables(0).Rows(i).Item("UNITSHRT").ToString() + ")"

                                        Td.Style.Add("text-align", "Left")
                                        Td.Font.Size = 10
                                        Td.Font.Name = "Verdana"
                                        Td.Font.Bold = True
                                        Td.Style.Add("padding-left", "70px")
                                        Td.Controls.Add(lbl)
                                    Else
                                        dvRptAct.RowFilter = "CATEGORYID=" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + " AND PACKAGETYPEID=" + dsPack.Tables(0).Rows(a).Item("ID").ToString() + " AND MATERIALID=" + dtMatD.Rows(0).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            Td.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 0)
                                        End If
                                        InnerTdSetting(Td, "", "Right")
                                        Td.CssClass = "AlterNateColor2"
                                    End If
                                    Td.Font.Size = 8.5
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = False
                                    Tr.Controls.Add(Td)
                                Next
                                Tr.CssClass = "com1"
                                tblCAGR.Controls.Add(Tr)
                            End If

                        Next
                    End If
                Next

            End If
        Next


        tblCAGR.Visible = True
    End Sub

    'SetUniformReportPACKPRODMAT_CNTRY
    Private Sub SetUniformReportPACKPRODMAT_CNTRY(ByVal reportDes As String, ByVal rptType As String)
        Dim objGetData As New Selectdata()
        Dim dsRptRws As New DataSet()
        Dim dsRptCols As New DataSet()
        Dim dsRptFilter As New DataSet()

        Dim dsRptFilterValue As New DataSet()
        Dim dsUnitPref As New DataSet
        Dim ColCnt As New Integer
        Dim RowCnt As New Integer
        Dim FiltCnt As New Integer
        Dim groupId As String = String.Empty
        Dim Dr() As DataRow
        Dim i As New Integer
        Dim j As New Integer
        Dim l As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim lbl As New Label
        Dim Fact As New Decimal
        Dim Link As New HyperLink
        Dim hyd As New HiddenField
        Dim CountryFilter As Boolean
        Dim k1 As Integer = 0
        Dim ProdId As String = ""
        Dim ProdTbl(11) As String
        Dim PackId As String = ""
        Dim Unit As String = ""
        Dim YearId As String = ""
        Dim dValue As Integer = 1
        Dim dsTables As New DataSet
        Dim dvTables As New DataView
        Dim dtTables As New DataTable
        Dim dsProd As New DataSet
        Dim dvProd As New DataView
        Dim dtProd As New DataTable
        Dim dsRptAct As New DataSet()
        Dim dvRptAct As New DataView()
        Dim dtRptAct As New DataTable()
        Dim dsRow As New DataSet
        Dim dvRow As New DataView
        Dim dtRow As New DataTable
        Dim dsPack As New DataSet
        Dim dvPack As New DataView
        Dim dtPack As New DataTable
        Dim cntryID As String = ""

        If rdbActual.Checked = True Then
            dValue = 1
        ElseIf rdbMil.Checked = True Then
            dValue = 1000000
        ElseIf rdbBil.Checked = True Then
            dValue = 1000000000
        ElseIf rdbThou.Checked = True Then
            dValue = 1000
        End If


        If hidReport.Value <> "0" Then
            dsUnitPref = Session("dsPref" + REPId.ToString())
            dsRptRws = Session("dsRows" + REPId.ToString())
            dsRptCols = Session("dsColumns" + REPId.ToString())
            dsRptFilter = Session("dsFilters" + REPId.ToString())
        Else
            dsUnitPref = objGetData.GetPref(REPId.ToString())
            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            dsRptCols = objGetData.GetUsersDynamicReportCols(REPId.ToString())
            dsRptFilter = objGetData.GetUsersReportFilters(REPId.ToString())

            Session("dsPref" + REPId.ToString()) = dsUnitPref
            Session("dsRows" + REPId.ToString()) = dsRptRws
            Session("dsColumns" + REPId.ToString()) = dsRptCols
            Session("dsFilters" + REPId.ToString()) = dsRptFilter

            hidReport.Value = "1"
        End If
        Unit = "1"
        For a = 0 To dsRptCols.Tables(0).Rows.Count - 1
            YearId = YearId + "" + dsRptCols.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
        Next
        YearId = YearId.Remove(YearId.Length - 1)

        For a = 0 To dsRptFilter.Tables(0).Rows.Count - 1
            If dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    For b = 0 To dsTables.Tables(0).Rows.Count - 1
                        ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                        ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                        RowCnt += 1
                    Next
                    ProdId = ProdId.Remove(ProdId.Length - 1)
                Else
                    ProdId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                    dtTables = dvTables.ToTable()
                    ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                    RowCnt += 1
                End If
            ElseIf dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    If ProdId <> "" Then
                        dsPack = objGetData.GetPackageTypeByFact(ProdId)
                    Else

                    End If
                    For b = 0 To dsPack.Tables(0).Rows.Count - 1
                        PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("ID").ToString() + ","
                        'RowCnt += 1
                    Next
                    PackId = PackId.Remove(PackId.Length - 1)
                Else
                    PackId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                End If
            ElseIf dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COUNTRY" Then
                cntryID = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
            End If
        Next

        groupId = Session("M1SubGroupId").ToString()
        dsRptAct = objGetData.GetPivotReportDataCNTRY(ProdTbl, "MAT", YearId, PackId, Unit, dsTables.Tables(0).Rows.Count, cntryID)
        dsProd = objGetData.GetProductDescription(ProdId)
        dsRow = objGetData.GetPivotMaterialss(ProdId, PackId)
        Dim dsMatPiv As New DataSet
        dsMatPiv = objGetData.GetMedicalDeviceMaterials(ProdId)

        Dim dsPackTPiv As New DataSet
        Dim dvPackTPiv As New DataView
        Dim dtPackTPiv As New DataTable
        dsPackTPiv = objGetData.GetPivotPackageTYP(ProdId)
        Unit = objGetData.GetPivotUnit(REPId.ToString())
        Try



        Catch ex As Exception

        End Try


        'If dsRptRws.Tables.Count > 0 Then
        '    RowCnt = dsRptRws.Tables(0).Rows.Count - 1
        'End If
        If dsRptCols.Tables.Count > 0 Then
            ColCnt = dsRptCols.Tables(0).Rows.Count
        End If
        If dsRptFilter.Tables.Count > 0 Then
            FiltCnt = dsRptFilter.Tables(0).Rows.Count
        End If

        Dim count As Integer = FiltCnt + ColCnt

        tblCAGR.Rows.Clear()
        'filter row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                For l = 0 To FiltCnt - 1
                    Link = New HyperLink
                    hyd = New HiddenField
                    lbl = New Label
                    Link.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    lbl.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    hyd.Value = dsRptFilter.Tables(0).Rows(l).Item("USERREPORTFILTERID").ToString()
                    Link.ID = "Filter_" + (l + 1).ToString()
                    hyd.ID = "Filter_ID_" + (l + 1).ToString()
                    Link.CssClass = "LinkM"

                    GetFilterLink(dsRptFilter.Tables(0).Rows(l).Item("FILTERSEQUENCE").ToString(), Link, dsRptFilter.Tables(0).Rows(l).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                    If rptType = "Base" Then
                        HeaderTd.Controls.Add(lbl)
                    Else
                        HeaderTd.Controls.Add(Link)
                    End If
                    'HeaderTd.Controls.Add(lbl)
                    HeaderTd.Controls.Add(hyd)
                Next
                HeaderTdSetting(HeaderTd, "150px", "", "1")
            Else
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)

        'Hedaer Row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                lbl = New Label
                If reportDes = "REGION" Then
                    lbl.Text = "GEOGRAPHIC REGIONS"
                ElseIf reportDes = "PACKGRP" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "PROD" Then
                    lbl.Text = "PRODUCTS"
                ElseIf reportDes = "MAT" Then
                    lbl.Text = "MATERIALS"
                ElseIf reportDes = "PACK" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "GROUP" Then
                    lbl.Text = "GROUP"
                ElseIf reportDes = "CNTRY" Then
                    lbl.Text = "COUNTRIES"
                End If
                HeaderTd.Controls.Add(lbl)
                HeaderTdSetting(HeaderTd, "150px", "", "1")
            Else
                hyd = New HiddenField
                Link = New HyperLink
                lbl = New Label
                Dim k As New Integer
                k = j - 1

                If dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString() + "(" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE1").ToString() + "/" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE2").ToString() + ")"
                Else
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString()
                End If
                lbl.Text = Link.Text
                Link.ID = "Column_" + k.ToString()
                hyd.ID = "Column_ID_" + k.ToString()
                hyd.Value = dsRptCols.Tables(0).Rows(k).Item("USERREPORTCOLUMNID").ToString()
                Link.CssClass = "LinkM"
                GetColLink(dsRptCols.Tables(0).Rows(k).Item("COLUMNSEQUENCE").ToString(), Link, dsRptCols.Tables(0).Rows(k).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                If rptType = "Base" Then
                    HeaderTd.Controls.Add(lbl)
                Else
                    HeaderTd.Controls.Add(Link)
                End If

                HeaderTd.Controls.Add(hyd)
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)


        'SET THE UNIT & SUMMERY PART
        For i = 0 To 0
            Tr = New TableRow()
            For j = 0 To ColCnt
                Td = New TableCell()
                lbl = New Label
                If j = 0 Then
                    HeaderTdSetting(Td, "150px", "", "1")
                    If i = 0 Then
                        lbl.Text = "UNIT"
                    End If
                Else
                    HeaderTdSetting(Td, "100px", "", "1")
                    If i = 0 Then
                        ' If j > count - ColCnt Then
                        lbl.ID = "lbl_" + j.ToString()
                        If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                            lbl.Text = "(%)"
                        Else
                            lbl.Text = "(" + dsUnitPref.Tables(0).Rows(0).Item("TITLE1").ToString() + ")"

                            hidUnitShort.Value = lbl.Text
                        End If
                        Td.Style.Add("text-align", "Center")
                        'End If
                    End If
                End If

                Td.Font.Size = 8
                Td.Font.Name = "Verdana"
                Td.Font.Bold = False
                Td.Controls.Add(lbl)
                Tr.Controls.Add(Td)
            Next
            tblCAGR.Controls.Add(Tr)
        Next

        dvProd = dsProd.Tables(0).DefaultView
        dvRptAct = dsRptAct.Tables(0).DefaultView
        dvRow = dsRow.Tables(0).DefaultView


        dvPackTPiv = dsPackTPiv.Tables(0).DefaultView

        'Inner Row
        For i = 0 To dsPackTPiv.Tables(0).Rows.Count - 1
            dvRptAct.RowFilter = "PACKAGETYPEID=" + dsPackTPiv.Tables(0).Rows(i).Item("ID").ToString()
            dtRptAct = dvRptAct.ToTable()

            If dtRptAct.Rows.Count > 0 Then
                For a = 0 To 0
                    Tr = New TableRow()
                    For j = 0 To ColCnt
                        Td = New TableCell()
                        If j = 0 Then
                            HeaderTdSetting(Td, "150px", "", "1")
                            lbl = New Label
                            lbl.Text = "<span class='icon'>+</span><b> " + dsPackTPiv.Tables(0).Rows(i).Item("VALUE").ToString()

                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            Td.Controls.Add(lbl)
                            Tr.Controls.Add(Td)
                            'tblCAGR.Controls.Add(Tr)
                        Else

                            Dim j2 As Integer = 0
                            Dim sumFCT As Double = 0.0
                            HeaderTdSetting(Td, "130px", "", "1")
                            dvRptAct.RowFilter = "PACKAGETYPEID=" + dsPackTPiv.Tables(0).Rows(i).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                            'dvRptAct.RowFilter = " MATERIALID=" + dtMatD.Rows(0).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                            dtRptAct = dvRptAct.ToTable()
                            For j2 = 0 To dtRptAct.Rows.Count - 1
                                If dtRptAct.Rows(j2).Item("FCT").ToString() <> "" Then
                                    sumFCT = sumFCT + dtRptAct.Rows(j2).Item("FCT").ToString()
                                End If

                            Next
                            sumFCT = FormatNumber(sumFCT, 0)
                            Td.Font.Bold = True
                            Td.Style.Add("text-align", "Right")

                            lbl = New Label
                            'lbl.Text = sumFCT
                            lbl.Text = FormatNumber(sumFCT.ToString() * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                            Td.Controls.Add(lbl)

                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-right", "5px")

                            'Td.CssClass = "AlterNateColor2"
                            Tr.Controls.Add(Td)

                        End If
                    Next
                    Tr.CssClass = "header"
                    tblCAGR.Controls.Add(Tr)
                Next
                For a = 0 To dsProd.Tables(0).Rows.Count - 1
                    dvRptAct.RowFilter = "CATEGORYID=" + dsProd.Tables(0).Rows(a).Item("ID").ToString() + " AND PACKAGETYPEID=" + dsPackTPiv.Tables(0).Rows(i).Item("ID").ToString()
                    dtRptAct = dvRptAct.ToTable()
                    If dtRptAct.Rows.Count > 0 Then
                        Tr = New TableRow()
                        For j = 0 To ColCnt
                            Td = New TableCell()
                            If j = 0 Then
                                HeaderTdSetting(Td, "150px", "", "1")
                                lbl = New Label
                                lbl.Text = dsProd.Tables(0).Rows(a).Item("CATEGORYNAME").ToString()


                                Td.Style.Add("text-align", "Left")
                                Td.Font.Size = 9
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = True
                                Td.Style.Add("padding-left", "40px")
                                Td.Controls.Add(lbl)
                                Tr.Controls.Add(Td)
                                tblCAGR.Controls.Add(Tr)
                            Else
                                Dim j2 As Integer = 0
                                Dim sumFCT As Double = 0.0
                                dvRptAct.RowFilter = "categoryid=" + dsProd.Tables(0).Rows(a).Item("id").ToString() + " and packagetypeid=" + dsPackTPiv.Tables(0).Rows(i).Item("id").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()

                                'dvRptAct.RowFilter = "PACKAGETYPEID=" + dsPack.Tables(0).Rows(a).Item("ID").ToString() + " AND MATERIALID=" + dtMatD.Rows(0).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                For j2 = 0 To dtRptAct.Rows.Count - 1
                                    If dtRptAct.Rows(j2).Item("FCT").ToString() <> "" Then
                                        sumFCT = sumFCT + dtRptAct.Rows(j2).Item("FCT").ToString()
                                    End If
                                Next
                                sumFCT = FormatNumber(sumFCT, 0)

                                Td.Font.Bold = True
                                Td.Style.Add("text-align", "Right")

                                Td.Font.Size = 8
                                Td.Font.Name = "Verdana"
                                Td.Style.Add("color", "#660022")
                                Td.Style.Add("padding-right", "10px")
                                lbl = New Label
                                lbl.Text = FormatNumber(sumFCT.ToString() * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                Td.Controls.Add(lbl)
                                Td.CssClass = "AlterNateColor2"
                                Tr.Controls.Add(Td)
                                Tr.CssClass = "com"
                                tblCAGR.Controls.Add(Tr)
                            End If
                        Next



                        For b = 0 To dsMatPiv.Tables(0).Rows.Count - 1
                            dvRptAct.RowFilter = "categoryid=" + dsProd.Tables(0).Rows(a).Item("id").ToString() + " and packagetypeid=" + dsPackTPiv.Tables(0).Rows(i).Item("id").ToString() + " and materialid=" + dsMatPiv.Tables(0).Rows(b).Item("id").ToString()
                            dtRptAct = dvRptAct.ToTable()
                            If dtRptAct.Rows.Count > 0 Then
                                Tr = New TableRow()
                                For j = 0 To ColCnt
                                    Td = New TableCell()
                                    If j = 0 Then
                                        HeaderTdSetting(Td, "150px", "", "1")
                                        lbl = New Label
                                        lbl.Text = dsMatPiv.Tables(0).Rows(b).Item("DES").ToString() '+ "(" + dsrptrws.tables(0).rows(i).item("unitshrt").tostring() + ")"

                                        Td.Style.Add("text-align", "left")
                                        Td.Font.Size = 10
                                        Td.Font.Name = "verdana"
                                        Td.Font.Bold = True
                                        Td.Style.Add("padding-left", "70px")
                                        Td.Controls.Add(lbl)
                                    Else
                                        dvRptAct.RowFilter = "categoryid=" + dsProd.Tables(0).Rows(a).Item("id").ToString() + " and packagetypeid=" + dsPackTPiv.Tables(0).Rows(i).Item("id").ToString() + " and materialid=" + dsMatPiv.Tables(0).Rows(b).Item("id").ToString() + " and yearid=" + dsRptCols.Tables(0).Rows(j - 1).Item("columnvalueid").ToString()

                                        'dvRptAct.RowFilter = "categoryid=" + dsProd.Tables(0).Rows(a).Item("id").ToString() + " and packagetypeid=" + dsPack.Tables(0).Rows(i).Item("id").ToString() + " and materialid=" + dsMatPiv.Tables(0).Rows(b).Item("id").ToString() + " and yearid=" + dsRptCols.Tables(0).Rows(j - 1).Item("columnvalueid").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            Try
                                                Td.Text = FormatNumber(dtRptAct.Rows(0).Item("fct").ToString(), 0)
                                            Catch ex As Exception
                                                Td.Text = FormatNumber(0, 0)
                                            End Try
                                            Td.Text = FormatNumber(Td.Text.ToString() * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)

                                        End If
                                        InnerTdSetting(Td, "", "right")
                                        Td.CssClass = "AlterNateColor2"
                                    End If
                                    Td.Font.Size = 8.5
                                    Td.Font.Name = "verdana"
                                    Td.Font.Bold = False
                                    Tr.Controls.Add(Td)
                                Next
                                Tr.CssClass = "com1"
                                tblCAGR.Controls.Add(Tr)
                            End If

                        Next
                    End If
                Next

            End If
        Next


        tblCAGR.Visible = True
    End Sub

    'SetUniformReportPACKPRODMAT_REGION
    Private Sub SetUniformReportPACKPRODMAT_REGION(ByVal reportDes As String, ByVal rptType As String)
        Dim objGetData As New Selectdata()
        Dim dsRptRws As New DataSet()
        Dim dsRptCols As New DataSet()
        Dim dsRptFilter As New DataSet()

        Dim dsRptFilterValue As New DataSet()
        Dim dsUnitPref As New DataSet
        Dim ColCnt As New Integer
        Dim RowCnt As New Integer
        Dim FiltCnt As New Integer
        Dim groupId As String = String.Empty
        Dim Dr() As DataRow
        Dim i As New Integer
        Dim j As New Integer
        Dim l As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim lbl As New Label
        Dim Fact As New Decimal
        Dim Link As New HyperLink
        Dim hyd As New HiddenField
        Dim CountryFilter As Boolean
        Dim k1 As Integer = 0
        Dim ProdId As String = ""
        Dim ProdTbl(11) As String
        Dim PackId As String = ""
        Dim Unit As String = ""
        Dim YearId As String = ""
        Dim dValue As Integer = 1
        Dim dsTables As New DataSet
        Dim dvTables As New DataView
        Dim dtTables As New DataTable
        Dim dsProd As New DataSet
        Dim dvProd As New DataView
        Dim dtProd As New DataTable
        Dim dsRptAct As New DataSet()
        Dim dvRptAct As New DataView()
        Dim dtRptAct As New DataTable()
        Dim dsRow As New DataSet
        Dim dvRow As New DataView
        Dim dtRow As New DataTable
        Dim dsPack As New DataSet
        Dim dvPack As New DataView
        Dim dtPack As New DataTable
        Dim RegID As String = ""


        If rdbActual.Checked = True Then
            dValue = 1
        ElseIf rdbMil.Checked = True Then
            dValue = 1000000
        ElseIf rdbBil.Checked = True Then
            dValue = 1000000000
        ElseIf rdbThou.Checked = True Then
            dValue = 1000
        End If


        If hidReport.Value <> "0" Then
            dsUnitPref = Session("dsPref" + REPId.ToString())
            dsRptRws = Session("dsRows" + REPId.ToString())
            dsRptCols = Session("dsColumns" + REPId.ToString())
            dsRptFilter = Session("dsFilters" + REPId.ToString())
        Else
            dsUnitPref = objGetData.GetPref(REPId.ToString())
            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            dsRptCols = objGetData.GetUsersDynamicReportCols(REPId.ToString())
            dsRptFilter = objGetData.GetUsersReportFilters(REPId.ToString())

            Session("dsPref" + REPId.ToString()) = dsUnitPref
            Session("dsRows" + REPId.ToString()) = dsRptRws
            Session("dsColumns" + REPId.ToString()) = dsRptCols
            Session("dsFilters" + REPId.ToString()) = dsRptFilter

            hidReport.Value = "1"
        End If
        Unit = "1"
        For a = 0 To dsRptCols.Tables(0).Rows.Count - 1
            YearId = YearId + "" + dsRptCols.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
        Next
        YearId = YearId.Remove(YearId.Length - 1)

        For a = 0 To dsRptFilter.Tables(0).Rows.Count - 1
            If dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    For b = 0 To dsTables.Tables(0).Rows.Count - 1
                        ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                        ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                        RowCnt += 1
                    Next
                    ProdId = ProdId.Remove(ProdId.Length - 1)
                Else
                    ProdId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                    dtTables = dvTables.ToTable()
                    ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                    RowCnt += 1
                End If
            ElseIf dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                If dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                    If ProdId <> "" Then
                        dsPack = objGetData.GetPackageTypeByFact(ProdId)
                    Else

                    End If
                    For b = 0 To dsPack.Tables(0).Rows.Count - 1
                        PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("ID").ToString() + ","
                        'RowCnt += 1
                    Next
                    PackId = PackId.Remove(PackId.Length - 1)
                Else
                    PackId = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                End If
            ElseIf dsRptFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "REGION" Then
                RegID = dsRptFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
            End If
        Next

        groupId = Session("M1SubGroupId").ToString()
        dsRptAct = objGetData.GetPivotReportDataREGION(ProdTbl, "MAT", YearId, PackId, Unit, dsTables.Tables(0).Rows.Count, RegID)
        dsProd = objGetData.GetProductDescription(ProdId)
        dsRow = objGetData.GetPivotMaterialss(ProdId, PackId)
        Dim dsMatPiv As New DataSet
        dsMatPiv = objGetData.GetMedicalDeviceMaterials(ProdId)
        Unit = objGetData.GetPivotUnit(REPId.ToString())

        Dim dsPackTPiv As New DataSet
        Dim dvPackTPiv As New DataView
        Dim dtPackTPiv As New DataTable
        dsPackTPiv = objGetData.GetPivotPackageTYP(ProdId)
        Try



        Catch ex As Exception

        End Try


        'If dsRptRws.Tables.Count > 0 Then
        '    RowCnt = dsRptRws.Tables(0).Rows.Count - 1
        'End If
        If dsRptCols.Tables.Count > 0 Then
            ColCnt = dsRptCols.Tables(0).Rows.Count
        End If
        If dsRptFilter.Tables.Count > 0 Then
            FiltCnt = dsRptFilter.Tables(0).Rows.Count
        End If

        Dim count As Integer = FiltCnt + ColCnt

        tblCAGR.Rows.Clear()
        'filter row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                For l = 0 To FiltCnt - 1
                    Link = New HyperLink
                    hyd = New HiddenField
                    lbl = New Label
                    Link.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    lbl.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    hyd.Value = dsRptFilter.Tables(0).Rows(l).Item("USERREPORTFILTERID").ToString()
                    Link.ID = "Filter_" + (l + 1).ToString()
                    hyd.ID = "Filter_ID_" + (l + 1).ToString()
                    Link.CssClass = "LinkM"

                    GetFilterLink(dsRptFilter.Tables(0).Rows(l).Item("FILTERSEQUENCE").ToString(), Link, dsRptFilter.Tables(0).Rows(l).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                    If rptType = "Base" Then
                        HeaderTd.Controls.Add(lbl)
                    Else
                        HeaderTd.Controls.Add(Link)
                    End If
                    'HeaderTd.Controls.Add(lbl)
                    HeaderTd.Controls.Add(hyd)
                Next
                HeaderTdSetting(HeaderTd, "150px", "", "1")
            Else
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)

        'Hedaer Row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                lbl = New Label
                If reportDes = "REGION" Then
                    lbl.Text = "GEOGRAPHIC REGIONS"
                ElseIf reportDes = "PACKGRP" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "PROD" Then
                    lbl.Text = "PRODUCTS"
                ElseIf reportDes = "MAT" Then
                    lbl.Text = "MATERIALS"
                ElseIf reportDes = "PACK" Then
                    lbl.Text = "PACKAGES"
                ElseIf reportDes = "GROUP" Then
                    lbl.Text = "GROUP"
                ElseIf reportDes = "CNTRY" Then
                    lbl.Text = "COUNTRIES"
                End If
                HeaderTd.Controls.Add(lbl)
                HeaderTdSetting(HeaderTd, "150px", "", "1")
            Else
                hyd = New HiddenField
                Link = New HyperLink
                lbl = New Label
                Dim k As New Integer
                k = j - 1

                If dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString() + "(" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE1").ToString() + "/" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE2").ToString() + ")"
                Else
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString()
                End If
                lbl.Text = Link.Text
                Link.ID = "Column_" + k.ToString()
                hyd.ID = "Column_ID_" + k.ToString()
                hyd.Value = dsRptCols.Tables(0).Rows(k).Item("USERREPORTCOLUMNID").ToString()
                Link.CssClass = "LinkM"
                GetColLink(dsRptCols.Tables(0).Rows(k).Item("COLUMNSEQUENCE").ToString(), Link, dsRptCols.Tables(0).Rows(k).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                If rptType = "Base" Then
                    HeaderTd.Controls.Add(lbl)
                Else
                    HeaderTd.Controls.Add(Link)
                End If

                HeaderTd.Controls.Add(hyd)
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)


        'SET THE UNIT & SUMMERY PART
        For i = 0 To 0
            Tr = New TableRow()
            For j = 0 To ColCnt
                Td = New TableCell()
                lbl = New Label
                If j = 0 Then
                    HeaderTdSetting(Td, "150px", "", "1")
                    If i = 0 Then
                        lbl.Text = "UNIT"
                    End If
                Else
                    HeaderTdSetting(Td, "100px", "", "1")
                    If i = 0 Then
                        ' If j > count - ColCnt Then
                        lbl.ID = "lbl_" + j.ToString()
                        If dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                            lbl.Text = "(%)"
                        Else
                            lbl.Text = "(" + dsUnitPref.Tables(0).Rows(0).Item("TITLE1").ToString() + ")"

                            hidUnitShort.Value = lbl.Text
                        End If
                        Td.Style.Add("text-align", "Center")
                        'End If
                    End If
                End If

                Td.Font.Size = 8
                Td.Font.Name = "Verdana"
                Td.Font.Bold = False
                Td.Controls.Add(lbl)
                Tr.Controls.Add(Td)
            Next
            tblCAGR.Controls.Add(Tr)
        Next

        dvProd = dsProd.Tables(0).DefaultView
        dvRptAct = dsRptAct.Tables(0).DefaultView
        dvRow = dsRow.Tables(0).DefaultView


        dvPackTPiv = dsPackTPiv.Tables(0).DefaultView

        'Inner Row
        For i = 0 To dsPackTPiv.Tables(0).Rows.Count - 1
            dvRptAct.RowFilter = "PACKAGETYPEID=" + dsPackTPiv.Tables(0).Rows(i).Item("ID").ToString()
            dtRptAct = dvRptAct.ToTable()

            If dtRptAct.Rows.Count > 0 Then
                For a = 0 To 0
                    Tr = New TableRow()
                    For j = 0 To ColCnt
                        Td = New TableCell()
                        If j = 0 Then
                            HeaderTdSetting(Td, "150px", "", "1")
                            lbl = New Label
                            lbl.Text = "<span class='icon'>+</span><b> " + dsPackTPiv.Tables(0).Rows(i).Item("VALUE").ToString()

                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            Td.Controls.Add(lbl)
                            Tr.Controls.Add(Td)
                            'tblCAGR.Controls.Add(Tr)
                        Else
                            HeaderTdSetting(Td, "130px", "", "1")
                            Dim j2 As Integer = 0
                            Dim sumFCT As Double = 0.0
                            dvRptAct.RowFilter = "PACKAGETYPEID=" + dsPackTPiv.Tables(0).Rows(i).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                            'dvRptAct.RowFilter = " MATERIALID=" + dtMatD.Rows(0).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                            dtRptAct = dvRptAct.ToTable()
                            For j2 = 0 To dtRptAct.Rows.Count - 1
                                If dtRptAct.Rows(j2).Item("FCT").ToString() <> "" Then
                                    sumFCT = sumFCT + dtRptAct.Rows(j2).Item("FCT").ToString()
                                End If

                            Next
                            sumFCT = FormatNumber(sumFCT, 0)

                            Td.Font.Bold = True
                            Td.Style.Add("text-align", "Right")

                            lbl = New Label
                            'lbl.Text = sumFCT
                            lbl.Text = FormatNumber(sumFCT.ToString() * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                            Td.Controls.Add(lbl)

                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-right", "5px")

                            'Td.CssClass = "AlterNateColor2"
                            Tr.Controls.Add(Td)

                        End If
                    Next
                    Tr.CssClass = "header"
                    tblCAGR.Controls.Add(Tr)
                Next
                For a = 0 To dsProd.Tables(0).Rows.Count - 1
                    dvRptAct.RowFilter = "CATEGORYID=" + dsProd.Tables(0).Rows(a).Item("ID").ToString() + " AND PACKAGETYPEID=" + dsPackTPiv.Tables(0).Rows(i).Item("ID").ToString()
                    dtRptAct = dvRptAct.ToTable()
                    If dtRptAct.Rows.Count > 0 Then
                        Tr = New TableRow()
                        For j = 0 To ColCnt
                            Td = New TableCell()
                            If j = 0 Then
                                HeaderTdSetting(Td, "150px", "", "1")
                                lbl = New Label
                                lbl.Text = dsProd.Tables(0).Rows(a).Item("CATEGORYNAME").ToString()


                                Td.Style.Add("text-align", "Left")
                                Td.Font.Size = 9
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = True
                                Td.Style.Add("padding-left", "40px")
                                Td.Controls.Add(lbl)
                                Tr.Controls.Add(Td)
                                tblCAGR.Controls.Add(Tr)
                            Else
                                Dim j2 As Integer = 0
                                Dim sumFCT As Double = 0.0
                                dvRptAct.RowFilter = "categoryid=" + dsProd.Tables(0).Rows(a).Item("id").ToString() + " and packagetypeid=" + dsPackTPiv.Tables(0).Rows(i).Item("id").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()

                                'dvRptAct.RowFilter = "PACKAGETYPEID=" + dsPack.Tables(0).Rows(a).Item("ID").ToString() + " AND MATERIALID=" + dtMatD.Rows(0).Item("ID").ToString() + " AND YEARID=" + dsRptCols.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                dtRptAct = dvRptAct.ToTable()
                                For j2 = 0 To dtRptAct.Rows.Count - 1
                                    If dtRptAct.Rows(j2).Item("FCT").ToString() <> "" Then
                                        sumFCT = sumFCT + dtRptAct.Rows(j2).Item("FCT").ToString()
                                    End If
                                Next
                                sumFCT = FormatNumber(sumFCT, 0)

                                Td.Font.Bold = True
                                Td.Style.Add("text-align", "Right")

                                Td.Font.Size = 8
                                Td.Font.Name = "Verdana"
                                Td.Style.Add("color", "#660022")
                                Td.Style.Add("padding-right", "10px")
                                lbl = New Label
                                'lbl.Text = sumFCT
                                lbl.Text = FormatNumber(sumFCT.ToString() * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString(), 0)
                                Td.Controls.Add(lbl)
                                Td.CssClass = "AlterNateColor2"
                                Tr.Controls.Add(Td)
                                Tr.CssClass = "com"
                                tblCAGR.Controls.Add(Tr)
                            End If
                        Next



                        For b = 0 To dsMatPiv.Tables(0).Rows.Count - 1
                            dvRptAct.RowFilter = "categoryid=" + dsProd.Tables(0).Rows(a).Item("id").ToString() + " and packagetypeid=" + dsPackTPiv.Tables(0).Rows(i).Item("id").ToString() + " and materialid=" + dsMatPiv.Tables(0).Rows(b).Item("id").ToString()
                            dtRptAct = dvRptAct.ToTable()
                            If dtRptAct.Rows.Count > 0 Then
                                Tr = New TableRow()
                                For j = 0 To ColCnt
                                    Td = New TableCell()
                                    If j = 0 Then
                                        HeaderTdSetting(Td, "150px", "", "1")
                                        lbl = New Label
                                        lbl.Text = dsMatPiv.Tables(0).Rows(b).Item("DES").ToString() '+ "(" + dsrptrws.tables(0).rows(i).item("unitshrt").tostring() + ")"

                                        Td.Style.Add("text-align", "left")
                                        Td.Font.Size = 10
                                        Td.Font.Name = "verdana"
                                        Td.Font.Bold = True
                                        Td.Style.Add("padding-left", "70px")
                                        Td.Controls.Add(lbl)
                                    Else
                                        dvRptAct.RowFilter = "categoryid=" + dsProd.Tables(0).Rows(a).Item("id").ToString() + " and packagetypeid=" + dsPackTPiv.Tables(0).Rows(i).Item("id").ToString() + " and materialid=" + dsMatPiv.Tables(0).Rows(b).Item("id").ToString() + " and yearid=" + dsRptCols.Tables(0).Rows(j - 1).Item("columnvalueid").ToString()

                                        'dvRptAct.RowFilter = "categoryid=" + dsProd.Tables(0).Rows(a).Item("id").ToString() + " and packagetypeid=" + dsPack.Tables(0).Rows(i).Item("id").ToString() + " and materialid=" + dsMatPiv.Tables(0).Rows(b).Item("id").ToString() + " and yearid=" + dsRptCols.Tables(0).Rows(j - 1).Item("columnvalueid").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            Try
                                                Td.Text = FormatNumber(dtRptAct.Rows(0).Item("fct").ToString(), 0)
                                            Catch ex As Exception
                                                Td.Text = FormatNumber(0, 0)
                                            End Try

                                        End If
                                        InnerTdSetting(Td, "", "right")
                                        Td.CssClass = "AlterNateColor2"
                                    End If
                                    Td.Font.Size = 8.5
                                    Td.Font.Name = "verdana"
                                    Td.Font.Bold = False
                                    Tr.Controls.Add(Td)
                                Next
                                Tr.CssClass = "com1"
                                tblCAGR.Controls.Add(Tr)
                            End If

                        Next
                    End If
                Next

            End If
        Next


        tblCAGR.Visible = True
    End Sub

    Private Sub SetMixedReport(ByVal reportDes As String, ByVal rptType As String)
        Dim objGetData As New Selectdata()
        Dim dsRptRws As New DataSet()
        Dim dsRptCols As New DataSet()
        Dim dsRptFilter As New DataSet()
        Dim dsRptAct As New DataSet()
        Dim dsUnitPref As New DataSet
        Dim ColCnt As New Integer
        Dim RowCnt As New Integer
        Dim FiltCnt As New Integer
        Dim Dr() As DataRow
        Dim i As New Integer
        Dim j As New Integer
        Dim l As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim lbl As New Label
        Dim Link As New HyperLink
        Dim hyd As New HiddenField
        Dim groupId As String = String.Empty
        Dim dValue As Integer = 1

        If rdbActual.Checked = True Then
            dValue = 1
        ElseIf rdbMil.Checked = True Then
            dValue = 1000000
        ElseIf rdbBil.Checked = True Then
            dValue = 1000000000
        ElseIf rdbThou.Checked = True Then
            dValue = 1000
        End If

        If hidReport.Value <> "0" Then
            dsUnitPref = Session("dsPref" + REPId.ToString())
            dsRptRws = Session("dsRows" + REPId.ToString())
            dsRptCols = Session("dsColumns" + REPId.ToString())
            dsRptFilter = Session("dsFilters" + REPId.ToString())
        Else
            dsUnitPref = objGetData.GetPref(REPId.ToString())
            dsRptRws = objGetData.GetUsersDynamicReportRows(REPId.ToString())
            dsRptCols = objGetData.GetUsersDynamicReportCols(REPId.ToString())
            dsRptFilter = objGetData.GetUsersReportFilters(REPId.ToString())

            Session("dsPref" + REPId.ToString()) = dsUnitPref
            Session("dsRows" + REPId.ToString()) = dsRptRws
            Session("dsColumns" + REPId.ToString()) = dsRptCols
            Session("dsFilters" + REPId.ToString()) = dsRptFilter

            hidReport.Value = "1"
        End If


        'changes Start by Bhavesh
        groupId = Session("M1SubGroupId").ToString()
        Try
            If hidReportData.Value <> "0" Then
                dsRptAct = Session("dsData")
            Else
                dsRptAct = objGetData.GetUsersDynamicReportData(Session("M1RptId"), reportDes, groupId)

                Session("dsData") = dsRptAct
                hidReportData.Value = "1"
            End If


        Catch ex As Exception

        End Try
        'End changes by Bhavesh



        If dsRptRws.Tables.Count > 0 Then
            RowCnt = dsRptRws.Tables(0).Rows.Count - 1
        End If

        If dsRptCols.Tables.Count > 0 Then
            ColCnt = dsRptCols.Tables(0).Rows.Count
        End If

        If dsRptFilter.Tables.Count > 0 Then
            FiltCnt = dsRptFilter.Tables(0).Rows.Count
        End If

        tblCAGR.Rows.Clear()
        'filter row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                For l = 0 To FiltCnt - 1
                    Link = New HyperLink
                    hyd = New HiddenField
                    lbl = New Label
                    Link.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    lbl.Text = "Filter " + (l + 1).ToString() + ":" + dsRptFilter.Tables(0).Rows(l).Item("FILTERVALUE") + "<br/> "
                    hyd.Value = dsRptFilter.Tables(0).Rows(l).Item("USERREPORTFILTERID").ToString()
                    Link.ID = "Column_Fil_" + l.ToString()
                    hyd.ID = "Column_ID_Fil_" + l.ToString()
                    Link.CssClass = "LinkM"

                    GetFilterLink(dsRptFilter.Tables(0).Rows(l).Item("FILTERSEQUENCE").ToString(), Link, dsRptFilter.Tables(0).Rows(l).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                    If rptType = "Base" Then
                        HeaderTd.Controls.Add(lbl)
                    Else
                        HeaderTd.Controls.Add(Link)
                    End If
                    HeaderTd.Controls.Add(hyd)
                Next
                HeaderTdSetting(HeaderTd, "150px", "", "1")
            Else
                HeaderTdSetting(HeaderTd, "100px", "", "1")
            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)

        'Hedaer Row
        HeaderTr = New TableRow
        For j = 0 To ColCnt
            HeaderTd = New TableCell()
            If j = 0 Then
                'lbl = New Label

                ' HeaderTd.Controls.Add(lbl)
                HeaderTdSetting(HeaderTd, "150px", "", "1")
            Else
                hyd = New HiddenField
                Link = New HyperLink
                lbl = New Label
                Dim k As New Integer
                k = j - 1
                If dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString() + "(" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE1").ToString() + "/" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUE2").ToString() + ")"
                Else
                    Link.Text = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUE").ToString()
                End If
                lbl.Text = Link.Text
                Link.ID = "Column_" + k.ToString()
                hyd.ID = "Column_ID_" + k.ToString()
                hyd.Value = dsRptCols.Tables(0).Rows(k).Item("USERREPORTCOLUMNID").ToString()
                Link.CssClass = "LinkM"
                GetColLink(dsRptCols.Tables(0).Rows(k).Item("COLUMNSEQUENCE").ToString(), Link, dsRptCols.Tables(0).Rows(k).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                If rptType = "Base" Then
                    HeaderTd.Controls.Add(lbl)
                Else
                    HeaderTd.Controls.Add(Link)
                End If
                HeaderTd.Controls.Add(hyd)
                HeaderTdSetting(HeaderTd, "100px", "", "1")

            End If
            HeaderTd.Font.Size = 8.5
            HeaderTd.Font.Name = "Verdana"
            HeaderTd.Font.Bold = False
            HeaderTr.Controls.Add(HeaderTd)
        Next
        tblCAGR.Controls.Add(HeaderTr)


        'Inner Row
        For i = 0 To RowCnt
            Tr = New TableRow()
            For j = 0 To ColCnt
                Td = New TableCell()
                If j = 0 Then
                    HeaderTdSetting(Td, "150px", "", "1")
                    hyd = New HiddenField
                    Link = New HyperLink
                    lbl = New Label
                    Link.ID = "Row_" + i.ToString()
                    hyd.ID = "Row_ID_" + i.ToString()
                    hyd.Value = dsRptRws.Tables(0).Rows(i).Item("USERREPORTROWID").ToString()
                    Link.CssClass = "LinkM"
                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                        Link.Text = dsRptRws.Tables(0).Rows(i).Item("ROWVALUE").ToString() + " (" + dsRptRws.Tables(0).Rows(i).Item("UNITSHRT").ToString() + ")"
                    Else
                        Link.Text = dsRptRws.Tables(0).Rows(i).Item("ROWVALUE").ToString() + " (" + dsRptRws.Tables(0).Rows(i).Item("METRICUNIT").ToString() + ")"
                    End If
                    lbl.Text = Link.Text
                    GetRowLink(dsRptRws.Tables(0).Rows(i).Item("ROWSEQUENCE").ToString(), Link, dsRptRws.Tables(0).Rows(i).Item("USERREPORTID").ToString(), hyd.ClientID, hyd.Value)
                    Td.Style.Add("text-align", "Left")
                    Td.Style.Add("padding-left", "5px")
                    If rptType = "Base" Then
                        Td.Controls.Add(lbl)
                    Else
                        Td.Controls.Add(Link)
                    End If
                    Td.Controls.Add(hyd)

                Else
                    Dim k As New Integer
                    k = j - 1
                    Dim ColType As String = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUETYPE").ToString()
                    Dim RowType As String = dsRptRws.Tables(0).Rows(i).Item("ROWVALUETYPE").ToString()
                    Dim RowId As String = String.Empty
                    Dim ColId As String = String.Empty
                    Dim RowValue As String = String.Empty
                    Dim ColValue As String = String.Empty
                    Dim UnitId As String = String.Empty
                    Dim UnitValue As String = String.Empty
                    RowId = dsRptRws.Tables(0).Rows(i).Item("ROWCOLUMNID").ToString()
                    RowValue = dsRptRws.Tables(0).Rows(i).Item("ROWVALUEID").ToString()
                    ColId = dsRptCols.Tables(0).Rows(k).Item("COLCOLUMNID").ToString()
                    ColValue = dsRptCols.Tables(0).Rows(k).Item("COLUMNVALUEID").ToString()
                    UnitId = "UnitId"
                    UnitValue = dsRptRws.Tables(0).Rows(i).Item("UNITID").ToString()

                    If ColType = "Year" Then
                        'If RowType = "Category" Then
                        '    RowValue = "9999" + RowValue
                        'End If
                        If GetFactValueM(dsRptAct, RowId, ColId, RowValue, ColValue, UnitId, UnitValue, dsUnitPref).ToString() <> String.Empty Then
                            Td.Text = FormatNumber(GetFactValueM(dsRptAct, RowId, ColId, RowValue, ColValue, UnitId, UnitValue, dsUnitPref).ToString(), 0)
                            If rdbMil.Checked = True Or rdbBil.Checked = True Then
                                Td.Text = FormatNumber((Td.Text / dValue), 3)
                            Else
                                Td.Text = FormatNumber((Td.Text / dValue), 0)
                            End If
                        Else
                            Td.Text = ""
                        End If

                    Else
                        Td.Text = "0.00"
                        Dim BeginYearId As String = String.Empty
                        Dim EndYearId As String = String.Empty

                        Dr = dsRptCols.Tables(0).Select("USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUETYPE1").ToString() + "")

                        BeginYearId = Dr(0).Item("COLUMNVALUEID").ToString() 'dsRptCols.Tables(0).Rows(k).Item("INPUTVALUETYPE1").ToString()
                        Dr = dsRptCols.Tables(0).Select("USERREPORTCOLUMNID=" + dsRptCols.Tables(0).Rows(k).Item("INPUTVALUETYPE2").ToString() + "")
                        EndYearId = Dr(0).Item("COLUMNVALUEID").ToString() 'dsRptCols.Tables(0).Rows(k).Item("INPUTVALUETYPE2").ToString()
                        'If RowType = "Category" Then
                        '    RowValue = "9999" + RowValue
                        'End If
                        Td.Text = FormatNumber(GetCAGR(dsRptAct, RowId, ColId, RowValue, UnitId, UnitValue, BeginYearId, EndYearId), 4)
                        Td.Text = FormatNumber(Td.Text, 4)
                    End If
                    InnerTdSetting(Td, "", "Right")
                    Td.CssClass = "AlterNateColor2"
                End If
                Td.Font.Size = 8.5
                Td.Font.Name = "Verdana"
                Td.Font.Bold = False
                Tr.Controls.Add(Td)
            Next
            tblCAGR.Controls.Add(Tr)
        Next
        tblCAGR.Visible = True
    End Sub

    Protected Function GetFactValueM(ByVal ds As DataSet, ByVal RowId As String, ByVal ColId As String, ByVal RowValue As String, ByVal ColValue As String, ByVal UnitId As String, ByVal UnitValue As String, ByVal dsUnitPref As DataSet) As Double
        'Dim Fact As New Decimal
        Dim fact As Double
        Dim factTotal As Double = 0.0
        Dim factVal As Double = 0.0
        Dim dsMaterials As DataSet
        Dim objGetData As New Selectdata()
        Dim dr() As DataRow
        Try
            If ds.Tables(0).Columns.Item(0).ColumnName = "SUBGROUPID" Then
                RowId = "SUBGROUPID"
            End If
            If RowId <> "MatGroupId" And RowId <> "MaterialId" Then
                Try
                    dr = ds.Tables(0).Select("" + RowId + "=" + RowValue + " And " + ColId + "=" + ColValue + "And " + UnitId + "=" + UnitValue + " AND MATERIALID=-1")
                Catch ex As Exception
                    dr = ds.Tables(0).Select("" + RowId + "=" + RowValue + " And " + ColId + "=" + ColValue + "And " + UnitId + "=" + UnitValue + "")
                End Try
                If dr.Length > 0 Then
                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                        If UnitValue = 1 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        ElseIf UnitValue = 2 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        ElseIf UnitValue = 4 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        Else
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        End If
                    Else
                        If UnitValue = 1 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                        ElseIf UnitValue = 2 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                        ElseIf UnitValue = 3 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                        ElseIf UnitValue = 4 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        Else
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        End If
                    End If

                Else
                    fact = ""
                End If
                factVal = fact
            ElseIf RowId = "MaterialId" Then
                dr = ds.Tables(0).Select("" + RowId + "=" + RowValue + " And " + ColId + "=" + ColValue + "And " + UnitId + "=" + UnitValue + "")
                If dr.Length > 0 Then
                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                        If UnitValue = 1 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        ElseIf UnitValue = 2 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        ElseIf UnitValue = 4 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        Else
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        End If
                    Else
                        If UnitValue = 1 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                        ElseIf UnitValue = 2 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                        ElseIf UnitValue = 3 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                        ElseIf UnitValue = 4 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        Else
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        End If
                    End If

                Else
                    fact = ""
                End If
                factVal = fact
            Else
                dsMaterials = objGetData.GetMaterials(RowValue)
                For i = 0 To dsMaterials.Tables(0).Rows.Count - 1
                    dr = ds.Tables(0).Select("MATERIALID = " + dsMaterials.Tables(0).Rows(i).Item("MATERIALID").ToString() + " And " + ColId + " = " + ColValue + " And " + UnitId + " = " + UnitValue + "")
                    If dr.Length > 0 Then
                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                            If UnitValue = 1 Then
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                            ElseIf UnitValue = 2 Then
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                            ElseIf UnitValue = 4 Then
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                            Else
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                            End If
                        Else
                            If UnitValue = 1 Then
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                            ElseIf UnitValue = 2 Then
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                            ElseIf UnitValue = 3 Then
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                            ElseIf UnitValue = 4 Then
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                            Else
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                            End If
                        End If
                    Else
                        fact = "0"
                    End If
                    factTotal = fact + factTotal
                Next
                factVal = factTotal
            End If

            '* Convert.ToDecimal(dr(0).Item("CURR"))
        Catch ex As Exception

        End Try
        Return factVal

    End Function

    Protected Function GetFactValueTotal(ByVal ds As DataSet, ByVal colId As String, ByVal colValue As String) As Decimal
        ' Dim Fact As New Decimal
        Dim dr() As DataRow
        Dim i As Integer
        Dim total As Decimal
        Dim dsCol As DataSet
        Dim objGetData As New M1SubGetData.Selectdata
        Try
            dsCol = objGetData.GetCAGRReportColumn(colValue)
            colValue = dsCol.Tables(0).Rows(0).Item("COLUMNVALUEID")
            dr = ds.Tables(0).Select("" + colId + "=" + colValue + " ")
            total = 0
            For i = 0 To dr.Length - 1 'ds.Tables(0).Rows.Count - 1
                'If dr(i).Item("COUNTRYID").ToString() <> "" Then
                total = Convert.ToDecimal(dr(i).Item("FACTRES")) + total
                'End If

            Next
        Catch ex As Exception
            'ErrorLable.Text = "Error:GetFactValue:" + ex.Message.ToString() + ""
        End Try
        Return total
    End Function

    Protected Function GetFactValueTotalCountry_ORG(ByVal ds As DataSet, ByVal colId As String, ByVal colValue As String, ByVal dsRow As DataSet) As Decimal
        ' Dim Fact As New Decimal
        Dim dr() As DataRow
        Dim i As Integer
        Dim total As Decimal
        Dim RowId As String = String.Empty
        Dim RowValue As String = String.Empty
        Try
            total = 0
            For j = 0 To dsRow.Tables(0).Rows.Count - 1
                RowId = dsRow.Tables(0).Rows(j).Item("ROWCOLUMNID").ToString()
                RowValue = dsRow.Tables(0).Rows(j).Item("ROWVALUEID").ToString()
                dr = ds.Tables(0).Select("" + colId + "=" + colValue + " And " + RowId + "=" + RowValue + "")
                For i = 0 To dr.Length - 1 'ds.Tables(0).Rows.Count - 1
                    total = Convert.ToDecimal(dr(i).Item("FACTRES")) + total
                Next
            Next
        Catch ex As Exception
            'ErrorLable.Text = "Error:GetFactValue:" + ex.Message.ToString() + ""
        End Try
        Return total
    End Function

    Protected Function GetFactValueTotalCountry(ByVal ds As DataSet, ByVal colId As String, ByVal colValue As String, ByVal dsRow As DataSet) As Decimal
        ' Dim Fact As New Decimal
        Dim dr() As DataRow
        Dim i As Integer
        Dim total As Decimal
        Dim RowId As String = String.Empty
        Dim RowValue As String = String.Empty
        Dim dsMaterials As DataSet
        Dim objGetData As New Selectdata()
        Try
            total = 0
            For j = 0 To dsRow.Tables(0).Rows.Count - 1
                RowId = dsRow.Tables(0).Rows(j).Item("ROWCOLUMNID").ToString()
                RowValue = dsRow.Tables(0).Rows(j).Item("ROWVALUEID").ToString()
                If RowId <> "MatGroupId" Then
                    dr = ds.Tables(0).Select("" + colId + "=" + colValue + " And " + RowId + "=" + RowValue + "")
                    For i = 0 To dr.Length - 1 'ds.Tables(0).Rows.Count - 1
                        total = Convert.ToDecimal(dr(i).Item("FACTRES")) + total
                    Next
                Else
                    dsMaterials = objGetData.GetMaterials(RowValue)
                    For i = 0 To dsMaterials.Tables(0).Rows.Count - 1
                        dr = ds.Tables(0).Select("MATERIALID = " + dsMaterials.Tables(0).Rows(i).Item("MATERIALID").ToString() + " And " + colId + " = " + colValue + "")
                        If dr.Length > 0 Then
                            total = Convert.ToDecimal(dr(0).Item("FACTRES")) + total
                        End If
                    Next

                End If

            Next
        Catch ex As Exception
            'ErrorLable.Text = "Error:GetFactValue:" + ex.Message.ToString() + ""
        End Try
        Return total
    End Function

    Protected Function GetCAGRValueTotal(ByVal ds As DataSet, ByVal colId As String, ByVal BeginYear As String, ByVal EndYear As String, ByVal dsCols As DataSet) As Decimal
        Dim CAGR As New Decimal
        Dim BeginYearFct As New Decimal
        Dim EndYearFct As New Decimal
        Dim YearDiff As New Decimal
        Dim dr1() As DataRow
        Dim dr2() As DataRow
        Try
            BeginYearFct = GetFactValueTotal(ds, colId, BeginYear)
            EndYearFct = GetFactValueTotal(ds, colId, EndYear)
            dr1 = dsCols.Tables(0).Select("USERREPORTCOLUMNID=" + BeginYear + " ")
            BeginYear = Convert.ToDecimal(dr1(0).Item("COLUMNVALUEID"))
            dr2 = dsCols.Tables(0).Select("USERREPORTCOLUMNID=" + EndYear + " ")
            EndYear = Convert.ToDecimal(dr2(0).Item("COLUMNVALUEID"))
            YearDiff = EndYear - BeginYear
            CAGR = (((EndYearFct / BeginYearFct) ^ (1 / YearDiff)) - 1) * 100
            Return CAGR
        Catch ex As Exception

        End Try
    End Function

    Protected Function GetFactValue(ByVal ds As DataSet, ByVal RowId As String, ByVal ColId As String, ByVal RowValue As String, ByVal ColValue As String, ByVal UnitId As String, ByVal UnitValue As String, ByVal dsUnitPref As DataSet) As Double
        'Dim Fact As New Decimal
        Dim fact As Double
        Dim factTotal As Double = 0.0
        Dim factVal As Double = 0.0
        Dim dsMaterials As DataSet
        Dim objGetData As New Selectdata()
        Dim dr() As DataRow
        Try
            If ds.Tables(0).Columns.Item(0).ColumnName = "SUBGROUPID" Then
                RowId = "SUBGROUPID"
            End If
            If RowId <> "MatGroupId" Then
                dr = ds.Tables(0).Select("" + RowId + "=" + RowValue + " And " + ColId + "=" + ColValue + "And " + UnitId + "=" + UnitValue + "")
                If dr.Length > 0 Then
                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                        If UnitValue = 1 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        ElseIf UnitValue = 2 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        ElseIf UnitValue = 4 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        Else
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        End If
                    Else
                        If UnitValue = 1 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                        ElseIf UnitValue = 2 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                        ElseIf UnitValue = 3 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                        ElseIf UnitValue = 4 Then
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        Else
                            fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                        End If
                    End If

                Else
                    fact = ""
                End If
                factVal = fact
            Else
                dsMaterials = objGetData.GetMaterials(RowValue)
                For i = 0 To dsMaterials.Tables(0).Rows.Count - 1
                    dr = ds.Tables(0).Select("MATERIALID = " + dsMaterials.Tables(0).Rows(i).Item("MATERIALID").ToString() + " And " + ColId + " = " + ColValue + " And " + UnitId + " = " + UnitValue + "")
                    If dr.Length > 0 Then
                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                            If UnitValue = 1 Then
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                            ElseIf UnitValue = 2 Then
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                            ElseIf UnitValue = 4 Then
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                            Else
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                            End If
                        Else
                            If UnitValue = 1 Then
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                            ElseIf UnitValue = 2 Then
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                            ElseIf UnitValue = 3 Then
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                            ElseIf UnitValue = 4 Then
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                            Else
                                fact = Convert.ToDecimal(dr(0).Item("FACTRES"))
                            End If
                        End If
                    Else
                        fact = "0"
                    End If
                    factTotal = fact + factTotal
                Next
                factVal = factTotal
            End If

            '* Convert.ToDecimal(dr(0).Item("CURR"))
        Catch ex As Exception

        End Try
        Return factVal

    End Function

    Protected Function GetCAGR_ORG(ByVal ds As DataSet, ByVal RowId As String, ByVal ColId As String, ByVal RowValue As String, ByVal UnitId As String, ByVal UnitValue As String, ByVal BeginYear As String, ByVal EndYear As String) As Decimal
        Dim CAGR As New Decimal
        Dim dsUnitPref As New DataSet
        Dim objGetData As New Selectdata()
        Dim BeginYearFct As New Decimal
        Dim EndYearFct As New Decimal
        Dim YearDiff As New Decimal
        Try
            dsUnitPref = objGetData.GetPref(REPId.ToString())
            If (GetFactValue(ds, RowId, ColId, RowValue, BeginYear, UnitId, UnitValue, dsUnitPref)) <> String.Empty Then
                BeginYearFct = GetFactValue(ds, RowId, ColId, RowValue, BeginYear, UnitId, UnitValue, dsUnitPref)
            End If
            If (GetFactValue(ds, RowId, ColId, RowValue, EndYear, UnitId, UnitValue, dsUnitPref)) <> String.Empty Then
                EndYearFct = GetFactValue(ds, RowId, ColId, RowValue, EndYear, UnitId, UnitValue, dsUnitPref)
            End If
            YearDiff = EndYear - BeginYear
            CAGR = (((EndYearFct / BeginYearFct) ^ (1 / YearDiff)) - 1) * 100
            Return CAGR
        Catch ex As Exception

        End Try
    End Function

    Protected Function GetCAGR(ByVal ds As DataSet, ByVal RowId As String, ByVal ColId As String, ByVal RowValue As String, ByVal UnitId As String, ByVal UnitValue As String, ByVal BeginYear As String, ByVal EndYear As String) As Decimal
        Dim CAGR As New Decimal
        Dim dsUnitPref As New DataSet
        Dim objGetData As New Selectdata()
        Dim BeginYearFct As New Decimal
        Dim EndYearFct As New Decimal
        Dim YearDiff As New Decimal
        Try
            dsUnitPref = objGetData.GetPref(REPId.ToString())
            If (GetFactValue(ds, RowId, ColId, RowValue, BeginYear, UnitId, UnitValue, dsUnitPref)).ToString() <> String.Empty Then
                BeginYearFct = (GetFactValue(ds, RowId, ColId, RowValue, BeginYear, UnitId, UnitValue, dsUnitPref)).ToString()
            End If
            If (GetFactValue(ds, RowId, ColId, RowValue, EndYear, UnitId, UnitValue, dsUnitPref)).ToString() <> String.Empty Then
                EndYearFct = (GetFactValue(ds, RowId, ColId, RowValue, EndYear, UnitId, UnitValue, dsUnitPref)).ToString()
            End If
            YearDiff = EndYear - BeginYear
            CAGR = (((EndYearFct / BeginYearFct) ^ (1 / YearDiff)) - 1) * 100
            Return CAGR
        Catch ex As Exception

        End Try
    End Function

    Protected Sub GetColLinkOLD(ByVal Seq As String, ByVal Link As HyperLink, ByVal RptId As String, ByVal hidId As String, ByVal hidValue As String)
        Dim Path As String
        Try
            Path = "../PopUp/ColSelector.aspx?RptId=" + RptId + "&Seq=" + Seq.ToString() + "&Id=ctl00_Market1ContentPlaceHolder_" + Link.ClientID + "&hidId=ctl00_Market1ContentPlaceHolder_" + hidId + "&isTemp=N"
            Link.NavigateUrl = "javascript:ShowPopWindow('" + Path + "','ctl00_Market1ContentPlaceHolder_" + hidId + "')"
        Catch ex As Exception

        End Try
    End Sub

    Protected Sub GetColLink(ByVal Seq As String, ByVal Link As HyperLink, ByVal RptId As String, ByVal hidId As String, ByVal hidValue As String)
        Dim Path As String
        Try
            Path = "../PopUp/PivotColSelector.aspx?RptId=" + RptId + "&Seq=" + Seq.ToString() + "&Id=ctl00_Market1ContentPlaceHolder_" + Link.ClientID + "&hidId=ctl00_Market1ContentPlaceHolder_" + hidId + "&isTemp=N"
            Link.NavigateUrl = "javascript:ShowPopWindow('" + Path + "','ctl00_Market1ContentPlaceHolder_" + hidId + "')"
        Catch ex As Exception

        End Try
    End Sub

    Protected Sub GetRowLink(ByVal Seq As String, ByVal Link As HyperLink, ByVal RptId As String, ByVal hidId As String, ByVal hidValue As String)
        Dim Path As String

        Dim RowVal2D As String = String.Empty
        Dim RegionSetId As String = String.Empty
        Dim Curr As String = String.Empty
        Try

            Path = "../PopUp/RowSelector.aspx?RptId=" + RptId + "&Seq=" + Seq.ToString() + "&Id=ctl00_Market1ContentPlaceHolder_" + Link.ClientID + "&hidId=ctl00_Market1ContentPlaceHolder_" + hidId + "&isTemp=N"
            Link.NavigateUrl = "javascript:ShowPopWindow('" + Path + "','ctl00_Market1ContentPlaceHolder_" + hidId + "')"
        Catch ex As Exception

        End Try
    End Sub

    Protected Sub GetFilterLinkOLD(ByVal Seq As String, ByVal Link As HyperLink, ByVal RptId As String, ByVal hidId As String, ByVal hidValue As String)
        Dim Path As String
        Try
            Path = "../PopUp/FilterSelectorRep.aspx?RptId=" + RptId + "&Seq=" + Seq.ToString() + "&Id=ctl00_Market1ContentPlaceHolder_" + Link.ClientID + "&hidId=ctl00_Market1ContentPlaceHolder_" + hidId + "&isTemp=N"
            Link.NavigateUrl = "javascript:ShowPopWindow('" + Path + "','ctl00_Market1ContentPlaceHolder_" + hidId + "')"
        Catch ex As Exception

        End Try
    End Sub

    Protected Sub GetFilterLink(ByVal Seq As String, ByVal Link As HyperLink, ByVal RptId As String, ByVal hidId As String, ByVal hidValue As String)
        Dim Path As String
        Try
            Path = "../PopUp/PivotFilter.aspx?RptId=" + RptId + "&Seq=" + Seq.ToString() + "&Id=ctl00_Market1ContentPlaceHolder_" + Link.ClientID + "&hidId=ctl00_Market1ContentPlaceHolder_" + hidId + "&isTemp=N"
            Link.NavigateUrl = "javascript:ShowPopWindow('" + Path + "','ctl00_Market1ContentPlaceHolder_" + hidId + "')"
        Catch ex As Exception

        End Try
    End Sub

    Protected Sub HeaderTdSetting(ByVal Td As TableCell, ByVal Width As String, ByVal HeaderText As String, ByVal ColSpan As String)
        Try
            'Td.Text = HeaderText
            Td.ColumnSpan = ColSpan
            If Width <> "" Then
                Td.Style.Add("width", Width)
            End If
            Td.CssClass = "TdHeading"
            Td.Height = 20
            Td.Font.Size = 10
            Td.Font.Bold = True
            Td.HorizontalAlign = HorizontalAlign.Center
        Catch ex As Exception
            _lErrorLble.Text = "Error:HeaderTdSetting:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub InnerTdSetting(ByVal Td As TableCell, ByVal Width As String, ByVal Align As String)
        Try
            If Width <> "" Then
                Td.Style.Add("width", Width)
            End If
            Td.Style.Add("text-align", Align)
            If Align = "Left" Then
                Td.Style.Add("padding-left", "5px")
            End If
            If Align = "Right" Then
                Td.Style.Add("padding-right", "5px")
            End If
        Catch ex As Exception
            _lErrorLble.Text = "Error:InnerTdSetting:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub HeaderTdWLinkSetting(ByVal Td As TableCell, ByVal Width As String, ByVal HeaderText As String, ByVal ColSpan As String)
        Try
            Td.ColumnSpan = ColSpan
            If Width <> "" Then
                Td.Style.Add("width", Width)
            End If
            Td.CssClass = "TdHeading"
            Td.Height = 20
            Td.Font.Size = 10
            Td.Font.Bold = True
            Td.HorizontalAlign = HorizontalAlign.Center
        Catch ex As Exception
            _lErrorLble.Text = "Error:HeaderTdSetting:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub Update_Click(ByVal sender As Object, ByVal e As System.Web.UI.ImageClickEventArgs)
        Try
            'GetPageDetails()
            'GetReportDetails()
            Dim dsRp As New DataSet
            Dim objUpIns As New M1SubUpInsData.UpdateInsert()
            Dim objGetData As New Selectdata()
            dsRp = objGetData.GetReportDetails(REPId)
            If dsRp.Tables(0).Rows.Count > 0 Then
                 objUpIns.InsertLog(Session("UserId"), Session("MLogInLog"), "4", REPId.ToString(), "Pivot", dsRp.Tables(0).Rows(0).Item("RPTTYPEDES").ToString(), "13", REPId.ToString(), Session.SessionID)
                Session("UpIns") = "Y"
            End If


            Response.Redirect("PivotReport.aspx?RepID=" + Request.QueryString("RepId").ToString() + "&Type=Prop")
        Catch ex As Exception
            _lErrorLble.Text = "Error:HeaderTdSetting:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub rdbActual_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles rdbActual.CheckedChanged
        GetPageDetails()
    End Sub

    Protected Sub rdbThou_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles rdbThou.CheckedChanged
        GetPageDetails()
    End Sub

    Protected Sub rdbMil_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles rdbMil.CheckedChanged
        GetPageDetails()
    End Sub

    Protected Sub rdbBil_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles rdbBil.CheckedChanged
        GetPageDetails()
    End Sub

    Public Function GetReportData(ByVal ReportId As String) As DataSet
        Dim Dts As New DataSet()
        Dim odbUtil As New DBUtil()
        Dim StrSql As String = String.Empty
        Dim Market1Connection As String = System.Configuration.ConfigurationManager.AppSettings("Market1ConnectionString")
        Try
            StrSql = "SELECT REGIONID, UNITID, YEARID, FACTRES "
            StrSql = StrSql + "FROM TEMPREPDATA "
            StrSql = StrSql + " WHERE REPORTID=" + ReportId

            Dts = odbUtil.FillDataSet(StrSql, Market1Connection)
            Return Dts
        Catch ex As Exception
            Throw New Exception("GetReportData:" + ex.Message.ToString())
            Return Dts
        End Try
    End Function

    Public Sub UpdateTempReportData(ByVal ReportId As String, ByVal ds As DataSet)
        Dim Dts As New DataSet()
        Dim odbUtil As New DBUtil()
        Dim StrSql As String = String.Empty
        Dim Market1Connection As String = System.Configuration.ConfigurationManager.AppSettings("Market1ConnectionString")
        Try
            For i = 0 To ds.Tables(0).Rows.Count - 1
                StrSql = "INSERT INTO TEMPREPDATA(REPORTID,REGIONID,UNITID,YEARID,FACTRES) VALUES "
                StrSql = StrSql + "(" + ReportId + "," + ds.Tables(0).Rows(i).Item("REGIONID").ToString() + "," + ds.Tables(0).Rows(i).Item("UNITID").ToString() + ", "
                StrSql = StrSql + " " + ds.Tables(0).Rows(i).Item("YEARID").ToString() + "," + ds.Tables(0).Rows(i).Item("FACTRES").ToString() + ")  "
                odbUtil.UpIns(StrSql, Market1Connection)
            Next


        Catch ex As Exception
            Throw New Exception("M1SubGetData:GetRowSQL:" + ex.Message.ToString())

        End Try
    End Sub

#Region "PIVOT STRUCTURE"

    Protected Sub SetPivotRegReportFrameWorkTemp(ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Dim YearId As String = ""
        Dim UnitId As String = ""
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsUnitPref As New DataSet
        Dim dsRep As New DataSet
        Dim RowCnt As New Integer
        Dim ColCnt As New Integer
        Dim filterCnt As New Integer
        Dim GrpId As String = ""
        Dim dsGrp As New DataSet
        Dim imgUp As New ImageButton
        Dim imgDn As New ImageButton
        Dim CompId As String = ""
        Dim dsComp As New DataSet
        Try
            'Checking for Edit
            If ViewState("Edit") = "Y" Then
                Flag = True
            Else
                Flag = False
            End If

            If hidReport.Value <> "0" Then
                dsRep = Session("dsRep" + REPId.ToString())
                dsUnitPref = Session("dsPref" + REPId.ToString())
                dsRows = Session("dsRows" + REPId.ToString())
                dsCol = Session("dsColumns" + REPId.ToString())
                dsFilter = Session("dsFilters" + REPId.ToString())
            Else
                dsRep = objGetData.GetReportDetails(REPId.ToString())
                dsUnitPref = objGetData.GetPref(REPId.ToString())
                dsRows = objGetData.GetUsersDynamicReportRows(REPId.ToString())
                dsCol = objGetData.GetUsersDynamicReportCols(REPId.ToString())
                dsFilter = objGetData.GetUsersReportFilters(REPId.ToString())

                Session("dsRep" + REPId.ToString()) = dsRep
                Session("dsPref" + REPId.ToString()) = dsUnitPref
                Session("dsRows" + REPId.ToString()) = dsRows
                Session("dsColumns" + REPId.ToString()) = dsCol
                Session("dsFilters" + REPId.ToString()) = dsFilter

                hidReport.Value = "1"
            End If

            filterCnt = dsFilter.Tables(0).Rows.Count
            ColCnt = dsCol.Tables(0).Rows.Count

            For a = 0 To dsCol.Tables(0).Rows.Count - 1
                If dsCol.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    YearId = YearId + "" + dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
                End If
            Next
            YearId = YearId.Remove(YearId.Length - 1)

            UnitId = dsRows.Tables(0).Rows(0).Item("UNITID").ToString()

            dvCol = dsCol.Tables(0).DefaultView
            dvRptCols1 = dsCol.Tables(0).DefaultView
            dvRptCols2 = dsCol.Tables(0).DefaultView
            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()
                        Link.CssClass = "LinkM"
                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                    Next

                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink
                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)

            Next
            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            Dim dsTables As New DataSet
            Dim dvTables As New DataView
            Dim dtTables As New DataTable
            Dim ProdId As String = ""
            'Dim ProdTbl(11) As String
            Dim PackId As String = ""
            Dim dsProd As New DataSet
            Dim dvProd As New DataView
            Dim dtProd As New DataTable
            Dim dsPack As New DataSet
            Dim dvPack As New DataView
            Dim dtPack As New DataTable
            Dim dsOrder As New DataSet()
            Dim funflag As Boolean = False
            Dim MatId As String = ""
            Dim FactId As String = ""
            Dim dsMat As New DataSet
            Dim dsProdMat As New DataSet
            Dim arrRfilt(filterCnt) As String

            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            Dim ProdTbl(dsTables.Tables(0).Rows.Count - 1) As String

            For a = 0 To dsFilter.Tables(0).Rows.Count - 1
                If dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                    arrRfilt(a) = "PRODUCT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                            ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            RowCnt += 1
                        Next
                        dtTables = dsTables.Tables(0)
                        ProdId = ProdId.Remove(ProdId.Length - 1)
                        If MatId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackMatProducts(ProdId, PackId, MatId)
                        ElseIf CompId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackCompProducts(ProdId, PackId, CompId)
                            'New Add Started
                        ElseIf GrpId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackGRPProducts(ProdId, PackId, GrpId)
                            'New Add Ended
                        ElseIf MatId <> "" Then
                            dsProd = objGetData.GetPivotMatProducts(MatId, ProdId)
                        ElseIf CompId <> "" Then
                            dsProd = objGetData.GetPivotCompProducts(CompId, ProdId)
                        ElseIf PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)
                            'New Add Started
                        ElseIf GrpId <> "" Then
                            dsProd = objGetData.GetPivotGRPProducts(ProdId, GrpId)
                            'New Add Ended
                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                        ProdId = ""
                        For b = 0 To dsProd.Tables(0).Rows.Count - 1
                            ProdId = ProdId + "" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + ","
                        Next
                        ProdId = ProdId.Remove(ProdId.Length - 1)

                    Else
                        ProdId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                        dtTables = dvTables.ToTable()
                        ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                        RowCnt += 1
                        If MatId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackMatProducts(ProdId, PackId, MatId)

                        ElseIf CompId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackCompProducts(ProdId, PackId, CompId)

                            'New Add Started
                        ElseIf GrpId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackGRPProducts(ProdId, PackId, GrpId)
                            'New Add Ended

                        ElseIf MatId <> "" Then
                            dsProd = objGetData.GetPivotMatProducts(MatId, ProdId)

                        ElseIf CompId <> "" Then
                            dsProd = objGetData.GetPivotCompProducts(CompId, ProdId)

                        ElseIf PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts("", PackId)

                            'New Add Started
                        ElseIf GrpId <> "" Then
                            dsProd = objGetData.GetPivotPackGRPProducts(ProdId, "", GrpId)
                            'New Add Ended

                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                    End If

                    dsProd.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsProd.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsProd.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                    arrRfilt(a) = "PACKAGE"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" And MatId <> "" Then
                            dsPack = objGetData.GetPivotProdMatPackages(ProdId, MatId, "")

                        ElseIf ProdId <> "" And CompId <> "" Then
                            dsPack = objGetData.GetProdCompPackages(ProdId, CompId, "")

                            'New Add Started
                        ElseIf ProdId <> "" And GrpId <> "" Then
                            dsPack = objGetData.GetPivotPRODGRPPackages(ProdId, GrpId, "")
                            'New Add Ended

                        ElseIf ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, "")

                        Else
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            If MatId <> "" Then
                                dsPack = objGetData.GetPivotMatAllPackages(ProdId1, MatId)
                            ElseIf CompId <> "" Then
                                dsPack = objGetData.GetPivotCompAllPackages(ProdId1, CompId)
                                'New Add Started
                            ElseIf GrpId <> "" Then
                                dsPack = objGetData.GetPivotGRPAllPackages(ProdId1, GrpId, "")
                                'New Add Ended
                            Else
                                dsPack = objGetData.GetPackages(ProdId1)
                            End If
                        End If
                        For b = 0 To dsPack.Tables(0).Rows.Count - 1
                            PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("PACKAGETYPEID").ToString() + ","
                        Next
                        PackId = PackId.Remove(PackId.Length - 1)
                    Else
                        PackId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" And MatId <> "" Then
                            dsPack = objGetData.GetPivotProdMatPackages(ProdId, MatId, PackId)

                        ElseIf ProdId <> "" And CompId <> "" Then
                            dsPack = objGetData.GetProdCompPackages(ProdId, CompId, PackId)


                            'New Add Started
                        ElseIf ProdId <> "" And GrpId <> "" Then
                            dsPack = objGetData.GetPivotPRODGRPPackages(ProdId, GrpId, "")
                            'New Add Ended

                        ElseIf ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, PackId)

                        ElseIf MatId <> "" Then
                            dsPack = objGetData.GetPivotMatPackages(MatId, PackId)

                        ElseIf CompId <> "" Then
                            dsPack = objGetData.GetPivotCompPackages(PackId, CompId)

                            'New Add Started
                        ElseIf GrpId <> "" Then
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            dsPack = objGetData.GetPivotGRPAllPackages(ProdId1, GrpId, PackId)
                            'New Add Ended

                        Else
                            dsPack = objGetData.GetPivotPackages(PackId)
                        End If
                    End If

                    dsPack.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsPack.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsPack.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "MATERIAL" Then
                    arrRfilt(a) = "MATERIAL"
                    MatId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    If ProdId <> "" And PackId <> "" Then
                        dsMat = objGetData.GetPivotPackProdMaterials(ProdId, PackId, MatId)

                    ElseIf ProdId <> "" Then
                        dsMat = objGetData.GetPivotProdMaterials(ProdId, MatId)

                    ElseIf PackId <> "" Then
                        Dim ProdId1 As String = ""
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                        Next
                        ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                        dsMat = objGetData.GetPivotPackMaterials(ProdId1, PackId, MatId)

                    Else
                        dsMat = objGetData.GetPivotMaterials(MatId)
                    End If

                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COMPONENT" Then
                    arrRfilt(a) = "COMPONENT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" And PackId <> "" Then
                            dsComp = objGetData.GetPivotPackProdComponents(ProdId, PackId, "")

                        ElseIf ProdId <> "" Then
                            dsComp = objGetData.GetPivotProdComponents(ProdId, "")

                        Else
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            If PackId <> "" Then
                                dsComp = objGetData.GetPivotPackComponents(ProdId1, PackId, "")
                            Else
                                dsComp = objGetData.GetPivotAllComponents(ProdId1)
                            End If
                        End If
                        For b = 0 To dsComp.Tables(0).Rows.Count - 1
                            CompId = CompId + "" + dsComp.Tables(0).Rows(b).Item("COMPONENTID").ToString() + ","
                        Next
                        CompId = CompId.Remove(CompId.Length - 1)
                    Else
                        CompId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" And PackId <> "" Then
                            dsComp = objGetData.GetPivotPackProdComponents(ProdId, PackId, CompId)

                        ElseIf ProdId <> "" Then
                            dsComp = objGetData.GetPivotProdComponents(ProdId, CompId)

                        ElseIf PackId <> "" Then
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            dsComp = objGetData.GetPivotPackComponents(ProdId1, PackId, CompId)

                        Else
                            dsComp = objGetData.GetRepComponent(CompId)
                        End If
                    End If

                    dsComp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsComp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsComp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "GROUP" Then
                    arrRfilt(a) = "GROUP"
                    GrpId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsGrp = objGetData.GetPivotGroups(GrpId)

                    dsGrp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsGrp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsGrp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                End If
            Next

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                Else
                                    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                                End If
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        End If
                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next

            Dim dv1 As New DataView
            Dim dv2 As New DataView
            Dim dv3 As New DataView
            Dim dt1 As New DataTable
            Dim dt2 As New DataTable
            Dim dt3 As New DataTable
            Dim dsRptAct As New DataSet
            Dim dvRptAct As New DataView
            Dim dtRptAct As New DataTable
            Dim strRFilt1 As String = ""
            Dim strRFilt2 As String = ""
            Dim strRFilt3 As String = ""

            If ProdTbl(0) = "" Then
                For b = 0 To dsTables.Tables(0).Rows.Count - 1
                    ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                    RowCnt += 1
                Next
            End If

            Dim dvRpt As New DataView
            Dim dtRpt As New DataTable

            If funflag Then
                If filterCnt = 1 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                ElseIf filterCnt = 2 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                ElseIf filterCnt = 3 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                    dv3 = dsOrder.Tables(2).DefaultView
                End If

                dsRows = objGetData.GetReportRegionsByRegionSet(dsRep.Tables(0).Rows(0).Item("REGIONSETID").ToString())
                dsRptAct = objGetData.GetPivotReportData_REGION(ProdTbl, MatId, YearId, ProdId, PackId, GrpId, CompId, UnitId, dsTables.Tables(0).Rows.Count, dsRep.Tables(0).Rows(0).Item("REGIONSETID").ToString(), dsRows)
                dvRptAct = dsRptAct.Tables(0).DefaultView
                dvRpt = dsRptAct.Tables(0).DefaultView
                If dsOrder.Tables(0).Rows.Count <> 0 Then
                    For a = 0 To dsOrder.Tables(0).Rows.Count - 1
                        If arrRfilt(0) = "PRODUCT" Then
                            strRFilt1 = "CATEGORYID = " + dsOrder.Tables(0).Rows(a).Item("CATEGORYID").ToString()
                        ElseIf arrRfilt(0) = "PACKAGE" Then
                            strRFilt1 = "PACKAGETYPEID = " + dsOrder.Tables(0).Rows(a).Item("PACKAGETYPEID").ToString()
                        ElseIf arrRfilt(0) = "MATERIAL" Then
                            strRFilt1 = "MATERIALID = " + dsOrder.Tables(0).Rows(a).Item("MATERIALID").ToString()
                        ElseIf arrRfilt(0) = "GROUP" Then
                            strRFilt1 = "SUBGROUPID = " + dsOrder.Tables(0).Rows(a).Item("SUBGROUPID").ToString()
                        ElseIf arrRfilt(0) = "COMPONENT" Then
                            strRFilt1 = "COMPONENTID = " + dsOrder.Tables(0).Rows(a).Item("COMPONENTID").ToString()
                        End If
                        dvRpt.RowFilter = strRFilt1
                        dtRpt = dvRpt.ToTable()
                        If dtRpt.Rows.Count > 0 Then
                            Tr = New TableRow
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    imgUp = New ImageButton
                                    imgDn = New ImageButton
                                    imgUp.ID = "Up_Layer" + (a + 1).ToString()
                                    imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','-');"
                                    imgDn.ID = "Dn_Layer" + (a + 1).ToString()
                                    imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','+');"
                                    imgUp.Style.Add("display", "none")
                                    imgUp.ImageUrl = "~/Images/Minus.jpg"
                                    imgUp.Width = 20
                                    imgUp.Height = 12
                                    imgDn.ImageUrl = "~/Images/Plus.jpg"
                                    imgDn.Width = 20
                                    imgDn.Height = 12
                                    Td.Controls.Add(imgUp)
                                    Td.Controls.Add(imgDn)
                                    lbl.Text = dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    lbl.Width = 200
                                    lbl.Style.Add("display", "inline")
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-left", "5px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()

                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        If count1 <> 0 And count2 <> 0 Then
                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        Else
                                            lbl.Text = FormatNumber(0, 4)
                                        End If
                                    End If
                                    'Td.CssClass = "AlterNateColor2"
                                    Td.Controls.Add(lbl)
                                    Td.Font.Bold = True
                                    Td.Style.Add("text-align", "Right")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-right", "10px")
                                    HeaderTdSetting(Td, "130px", "", "1")
                                End If
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30

                            If filterCnt = 1 Then
                                tblCAGR.Controls.Add(Tr)

                                For i = 1 To dsRows.Tables(0).Rows.Count
                                    If strRFilt1 <> "" Then
                                        dvRptAct.RowFilter = strRFilt1 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND FCT<>0"
                                    Else
                                        dvRptAct.RowFilter = " REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString()
                                    End If
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Data" + i.ToString()
                                        Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("NAME").ToString()
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Font.Size = 8.5
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = False
                                                Td.Style.Add("padding-left", "25px")
                                                HeaderTdSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If
                                                    lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                    dtRptCols2 = dvRptCols2.ToTable()

                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If

                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If

                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                    If count1 <> 0 And count2 <> 0 Then
                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                    Else
                                                        lbl.Text = FormatNumber(0, 4)
                                                    End If
                                                End If
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.CssClass = "AlterNateColor2"
                                                Td.Style.Add("text-align", "Right")
                                                Td.Style.Add("padding-right", "10px")
                                            End If
                                            Td.Font.Size = 8.5
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = False
                                            Tr.Controls.Add(Td)
                                        Next
                                        Tr.Height = 30
                                        tblCAGR.Controls.Add(Tr)

                                    End If

                                Next
                            Else
                                If arrRfilt(1) <> "REGION" And arrRfilt(1) <> "COUNTRY" And arrRfilt(1) <> "GROUP" Then
                                    dv2.RowFilter = strRFilt1
                                End If
                                dt2 = dv2.ToTable()
                                If dt2.Rows.Count > 0 Then
                                    tblCAGR.Controls.Add(Tr)
                                    For b = 0 To dt2.Rows.Count - 1
                                        strRFilt2 = ""
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                        Tr.Style.Add("display", "none")
                                        If arrRfilt(1) = "PRODUCT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            Else
                                                strRFilt2 = "CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "PACKAGE" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            Else
                                                strRFilt2 = "PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "MATERIAL" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            Else
                                                strRFilt2 = "MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "GROUP" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            Else
                                                strRFilt2 = "SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "COMPONENT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND COMPONENTID = " + dt2.Rows(b).Item("COMPONENTID").ToString()
                                            Else
                                                strRFilt2 = "COMPONENTID = " + dt2.Rows(b).Item("COMPONENTID").ToString()
                                            End If
                                        End If
                                        dvRpt.RowFilter = strRFilt2
                                        dtRpt = dvRpt.ToTable()

                                        If dtRpt.Rows.Count > 0 Then
                                            For j = 0 To ColCnt
                                                Td = New TableCell()
                                                Td.ID = "Layer" + (a + 1).ToString() + "_" + (b + 1).ToString() + "_" + (j + 1).ToString()
                                                If j = 0 Then
                                                    lbl = New Label
                                                    imgUp = New ImageButton
                                                    imgDn = New ImageButton
                                                    imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','-');"
                                                    imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','+');"
                                                    imgUp.Style.Add("display", "none")
                                                    imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                    imgUp.Width = 20
                                                    imgUp.Height = 12
                                                    imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                    imgDn.Width = 20
                                                    imgDn.Height = 12
                                                    Td.Controls.Add(imgUp)
                                                    Td.Controls.Add(imgDn)
                                                    lbl.Text = dt2.Rows(b).Item("VALUE").ToString()
                                                    lbl.CssClass = "Label"
                                                    Td.Controls.Add(lbl)
                                                    Td.Font.Size = 9
                                                    Td.Font.Bold = True
                                                    Td.Style.Add("text-align", "Left")
                                                    Td.Style.Add("padding-left", "25px")
                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                Else
                                                    lbl = New Label
                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                        Dim ProdCount As New Double
                                                        If strRFilt2 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        If UnitId = 1 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    Else
                                                                        If UnitId = 1 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If
                                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                    Else
                                                        Dim count1 As New Double
                                                        Dim count2 As New Double
                                                        Dim diff As New Double
                                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                        dtRptCols1 = dvRptCols1.ToTable()
                                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                        dtRptCols2 = dvRptCols2.ToTable()

                                                        If strRFilt2 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        If UnitId = 1 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    Else
                                                                        If UnitId = 1 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If

                                                        If strRFilt2 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        If UnitId = 1 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    Else
                                                                        If UnitId = 1 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If

                                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                        If count1 <> 0 And count2 <> 0 Then
                                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                        Else
                                                            lbl.Text = FormatNumber(0, 4)
                                                        End If
                                                    End If
                                                    Td.Controls.Add(lbl)
                                                    Td.CssClass = "AlterNateColor2"
                                                    Td.Style.Add("color", "#660022")
                                                    Td.Style.Add("padding-right", "10px")
                                                    Td.Style.Add("text-align", "Right")
                                                End If
                                                Td.Font.Size = 9
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = True
                                                Tr.Controls.Add(Td)
                                            Next
                                            Tr.Height = 30
                                            tblCAGR.Controls.Add(Tr)

                                            If filterCnt = 2 Then
                                                For i = 1 To dsRows.Tables(0).Rows.Count
                                                    If strRFilt2 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt2 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND FCT<>0"
                                                    Else
                                                        dvRptAct.RowFilter = " REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        Tr = New TableRow
                                                        Tr.CssClass = "Bhavesh"
                                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Data" + i.ToString()
                                                        Tr.Style.Add("display", "none")
                                                        For j = 0 To ColCnt
                                                            If j = 0 Then
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("NAME").ToString()
                                                                lbl.CssClass = "Label"
                                                                Td.Controls.Add(lbl)
                                                                Td.Style.Add("text-align", "Left")
                                                                Td.Style.Add("padding-left", "50px")
                                                                HeaderTdSetting(Td, "180px", "", "1")
                                                            Else
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                    Dim ProdCount As New Double
                                                                    If strRFilt2 <> "" Then
                                                                        dvRptAct.RowFilter = strRFilt2 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    Else
                                                                        dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    End If
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If
                                                                    lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                Else
                                                                    Dim count1 As New Double
                                                                    Dim count2 As New Double
                                                                    Dim diff As New Double
                                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                    dtRptCols2 = dvRptCols2.ToTable()

                                                                    If strRFilt2 <> "" Then
                                                                        dvRptAct.RowFilter = strRFilt2 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    Else
                                                                        dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    End If
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If

                                                                    If strRFilt2 <> "" Then
                                                                        dvRptAct.RowFilter = strRFilt2 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    Else
                                                                        dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    End If
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If

                                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                    If count1 <> 0 And count2 <> 0 Then
                                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                    Else
                                                                        lbl.Text = FormatNumber(0, 4)
                                                                    End If
                                                                End If
                                                                lbl.CssClass = "Label"
                                                                Td.Controls.Add(lbl)
                                                                Td.CssClass = "AlterNateColor2"
                                                                Td.Style.Add("text-align", "Right")
                                                                Td.Style.Add("padding-right", "10px")
                                                            End If
                                                            Td.Font.Size = 8.5
                                                            Td.Font.Name = "Verdana"
                                                            Td.Font.Bold = False
                                                            Tr.Controls.Add(Td)
                                                        Next
                                                        Tr.Height = 30
                                                        tblCAGR.Controls.Add(Tr)

                                                    End If

                                                Next
                                            Else
                                                If arrRfilt(2) <> "REGION" And arrRfilt(2) <> "COUNTRY" And arrRfilt(2) <> "GROUP" Then
                                                    dv3.RowFilter = strRFilt2
                                                End If
                                                dt3 = dv3.ToTable()
                                                If dt3.Rows.Count > 0 Then
                                                    For c = 0 To dt3.Rows.Count - 1
                                                        strRFilt3 = ""
                                                        If arrRfilt(2) = "PRODUCT" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2 + " AND CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                            Else
                                                                strRFilt3 = "CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                            End If
                                                        ElseIf arrRfilt(2) = "PACKAGE" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2 + " AND PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                            Else
                                                                strRFilt3 = "PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                            End If
                                                        ElseIf arrRfilt(2) = "MATERIAL" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2 + " AND MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString()
                                                            Else
                                                                strRFilt3 = "MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString()
                                                            End If
                                                        ElseIf arrRfilt(2) = "GROUP" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2 + " AND SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                            Else
                                                                strRFilt3 = "SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                            End If
                                                        ElseIf arrRfilt(2) = "COMPONENT" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2 + " AND COMPONENTID = " + dt3.Rows(c).Item("COMPONENTID").ToString()
                                                            Else
                                                                strRFilt3 = "COMPONENTID = " + dt3.Rows(c).Item("COMPONENTID").ToString()
                                                            End If
                                                        End If
                                                        dvRpt.RowFilter = strRFilt3
                                                        dtRpt = dvRpt.ToTable()
                                                        If dtRpt.Rows.Count > 0 Then
                                                            Tr = New TableRow
                                                            Tr.CssClass = "Bhavesh"
                                                            Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                            Tr.Style.Add("display", "none")
                                                            For j = 0 To ColCnt
                                                                If j = 0 Then
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    imgUp = New ImageButton
                                                                    imgDn = New ImageButton
                                                                    imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                    imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','-');"
                                                                    imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                    imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','+');"
                                                                    imgUp.Style.Add("display", "none")
                                                                    imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                                    imgUp.Width = 20
                                                                    imgUp.Height = 12
                                                                    imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                                    imgDn.Width = 20
                                                                    imgDn.Height = 12
                                                                    Td.Controls.Add(imgUp)
                                                                    Td.Controls.Add(imgDn)
                                                                    lbl.Text = dt3.Rows(c).Item("VALUE").ToString()
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.Font.Size = 8.5
                                                                    Td.Font.Bold = True
                                                                    Td.Style.Add("text-align", "Left")
                                                                    Td.Style.Add("padding-left", "50px")
                                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                                Else
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                        Dim ProdCount As New Double
                                                                        If strRFilt3 <> "" Then
                                                                            dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        Else
                                                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        End If
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                        If UnitId = 1 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    Else
                                                                                        If UnitId = 1 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If
                                                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                    Else
                                                                        Dim count1 As New Double
                                                                        Dim count2 As New Double
                                                                        Dim diff As New Double
                                                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                        dtRptCols1 = dvRptCols1.ToTable()
                                                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                        dtRptCols2 = dvRptCols2.ToTable()

                                                                        If strRFilt3 <> "" Then
                                                                            dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        Else
                                                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        End If
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                        If UnitId = 1 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    Else
                                                                                        If UnitId = 1 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If

                                                                        If strRFilt3 <> "" Then
                                                                            dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        Else
                                                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        End If
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                        If UnitId = 1 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    Else
                                                                                        If UnitId = 1 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If

                                                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                        If count1 <> 0 And count2 <> 0 Then
                                                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                        Else
                                                                            lbl.Text = FormatNumber(0, 4)
                                                                        End If
                                                                    End If
                                                                    Td.Controls.Add(lbl)
                                                                    Td.CssClass = "AlterNateColor2"
                                                                    Td.Style.Add("text-align", "Right")
                                                                    Td.Style.Add("padding-right", "10px")
                                                                End If
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Name = "Verdana"
                                                                Td.Font.Bold = True
                                                                Tr.Controls.Add(Td)
                                                            Next
                                                            Tr.Height = 30
                                                            tblCAGR.Controls.Add(Tr)
                                                        End If
                                                        

                                                        For i = 1 To dsRows.Tables(0).Rows.Count
                                                            If strRFilt3 <> "" Then
                                                                dvRptAct.RowFilter = strRFilt3 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND FCT<>0"
                                                            Else
                                                                dvRptAct.RowFilter = " REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString()
                                                            End If
                                                            dtRptAct = dvRptAct.ToTable()
                                                            If dtRptAct.Rows.Count > 0 Then
                                                                Tr = New TableRow
                                                                Tr.CssClass = "Bhavesh"
                                                                Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "_Data" + i.ToString()
                                                                Tr.Style.Add("display", "none")
                                                                For j = 0 To ColCnt
                                                                    If j = 0 Then
                                                                        Td = New TableCell()
                                                                        lbl = New Label
                                                                        lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("NAME").ToString()
                                                                        lbl.CssClass = "Label"
                                                                        Td.Controls.Add(lbl)
                                                                        Td.Style.Add("text-align", "Left")
                                                                        Td.Style.Add("padding-left", "75px")
                                                                        HeaderTdSetting(Td, "180px", "", "1")
                                                                    Else
                                                                        Td = New TableCell()
                                                                        lbl = New Label
                                                                        If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                            Dim ProdCount As New Double
                                                                            If strRFilt3 <> "" Then
                                                                                dvRptAct.RowFilter = strRFilt3 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                            Else
                                                                                dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                            End If
                                                                            dtRptAct = dvRptAct.ToTable()
                                                                            If dtRptAct.Rows.Count > 0 Then
                                                                                For l = 0 To dtRptAct.Rows.Count - 1
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                            If UnitId = 1 Then
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            ElseIf UnitId = 2 Then
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            ElseIf UnitId = 4 Then
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            Else
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            End If
                                                                                        Else
                                                                                            If UnitId = 1 Then
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                            ElseIf UnitId = 2 Then
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                            ElseIf UnitId = 3 Then
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                            ElseIf UnitId = 4 Then
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            Else
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            End If
                                                                                        End If
                                                                                    End If
                                                                                Next
                                                                            End If
                                                                            lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                        Else
                                                                            Dim count1 As New Double
                                                                            Dim count2 As New Double
                                                                            Dim diff As New Double
                                                                            dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                            dtRptCols1 = dvRptCols1.ToTable()
                                                                            dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                            dtRptCols2 = dvRptCols2.ToTable()

                                                                            If strRFilt3 <> "" Then
                                                                                dvRptAct.RowFilter = strRFilt3 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                            Else
                                                                                dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                            End If
                                                                            dtRptAct = dvRptAct.ToTable()
                                                                            If dtRptAct.Rows.Count > 0 Then
                                                                                For l = 0 To dtRptAct.Rows.Count - 1
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                            If UnitId = 1 Then
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            ElseIf UnitId = 2 Then
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            ElseIf UnitId = 4 Then
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            Else
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            End If
                                                                                        Else
                                                                                            If UnitId = 1 Then
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                            ElseIf UnitId = 2 Then
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                            ElseIf UnitId = 3 Then
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                            ElseIf UnitId = 4 Then
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            Else
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            End If
                                                                                        End If
                                                                                    End If
                                                                                Next
                                                                            End If

                                                                            If strRFilt3 <> "" Then
                                                                                dvRptAct.RowFilter = strRFilt3 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                            Else
                                                                                dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                            End If
                                                                            dtRptAct = dvRptAct.ToTable()
                                                                            If dtRptAct.Rows.Count > 0 Then
                                                                                For l = 0 To dtRptAct.Rows.Count - 1
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                            If UnitId = 1 Then
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            ElseIf UnitId = 2 Then
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            ElseIf UnitId = 4 Then
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            Else
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            End If
                                                                                        Else
                                                                                            If UnitId = 1 Then
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                            ElseIf UnitId = 2 Then
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                            ElseIf UnitId = 3 Then
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                            ElseIf UnitId = 4 Then
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            Else
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            End If
                                                                                        End If
                                                                                    End If
                                                                                Next
                                                                            End If

                                                                            diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                            If count1 <> 0 And count2 <> 0 Then
                                                                                lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                            Else
                                                                                lbl.Text = FormatNumber(0, 4)
                                                                            End If
                                                                        End If
                                                                        lbl.CssClass = "Label"
                                                                        Td.Controls.Add(lbl)
                                                                        Td.CssClass = "AlterNateColor2"
                                                                        Td.Style.Add("text-align", "Right")
                                                                        Td.Style.Add("padding-right", "10px")
                                                                    End If
                                                                    Td.Font.Size = 8.5
                                                                    Td.Font.Name = "Verdana"
                                                                    Td.Font.Bold = False
                                                                    Tr.Controls.Add(Td)
                                                                Next
                                                                Tr.Height = 30
                                                                tblCAGR.Controls.Add(Tr)
                                                            End If

                                                        Next
                                                    Next
                                                End If
                                            End If
                                        End If
                                    Next
                                End If
                            End If
                        End If
                    Next

                    'Grand Total
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label
                            imgUp = New ImageButton
                            imgDn = New ImageButton
                            imgUp.ID = "Up_TotLayer"
                            imgUp.OnClientClick = "javascript:return ShowLines('TotLayer','-');"
                            imgDn.ID = "Dn_TotLayer"
                            imgDn.OnClientClick = "javascript:return ShowLines('TotLayer','+');"
                            imgUp.Style.Add("display", "none")
                            imgUp.ImageUrl = "~/Images/Minus.jpg"
                            imgUp.Width = 20
                            imgUp.Height = 12
                            imgDn.ImageUrl = "~/Images/Plus.jpg"
                            imgDn.Width = 20
                            imgDn.Height = 12
                            Td.Controls.Add(imgUp)
                            Td.Controls.Add(imgDn)
                            lbl.Text = "Grand Total" 'dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                            lbl.CssClass = "Label"
                            lbl.Width = 200
                            lbl.Style.Add("display", "inline")
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            lbl = New Label
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                Dim ProdCount As New Double
                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If
                                lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                            Else
                                Dim count1 As New Double
                                Dim count2 As New Double
                                Dim diff As New Double
                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                dtRptCols1 = dvRptCols1.ToTable()
                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                dtRptCols2 = dvRptCols2.ToTable()

                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If

                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If

                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                If count1 <> 0 And count2 <> 0 Then
                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                Else
                                    lbl.Text = FormatNumber(0, 4)
                                End If
                            End If
                            'Td.CssClass = "AlterNateColor2"
                            Td.Controls.Add(lbl)
                            Td.Font.Bold = True
                            Td.Style.Add("text-align", "Right")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-right", "10px")
                            HeaderTdSetting(Td, "130px", "", "1")
                        End If
                        Tr.Controls.Add(Td)
                    Next
                    tblCAGR.Controls.Add(Tr)

                    For i = 1 To dsRows.Tables(0).Rows.Count
                        dvRptAct.RowFilter = "REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND FCT<>0"
                        dtRptAct = dvRptAct.ToTable()
                        If dtRptAct.Rows.Count > 0 Then
                            Tr = New TableRow
                            Tr.CssClass = "Bhavesh"
                            Tr.ID = "TotLayer_Data" + i.ToString()
                            Tr.Style.Add("display", "none")
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("NAME").ToString()
                                    lbl.CssClass = "Label"
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Font.Size = 8.5
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = False
                                    Td.Style.Add("padding-left", "25px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        dvRptAct.RowFilter = "REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()

                                        dvRptAct.RowFilter = "REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        dvRptAct.RowFilter = "REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        If count1 <> 0 And count2 <> 0 Then
                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        Else
                                            lbl.Text = FormatNumber(0, 4)
                                        End If
                                    End If
                                    lbl.CssClass = "Label"
                                    Td.Controls.Add(lbl)
                                    Td.CssClass = "AlterNateColor2"
                                    Td.Style.Add("text-align", "Right")
                                    Td.Style.Add("padding-right", "10px")
                                End If
                                Td.Font.Size = 8.5
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = False
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            tblCAGR.Controls.Add(Tr)

                        End If

                    Next
                Else
                    For i = 1 To dsRows.Tables(0).Rows.Count
                        Tr = New TableRow
                        For j = 0 To ColCnt
                            If j = 0 Then
                                Td = New TableCell()
                                lbl = New Label
                                'dv.RowFilter = "ROWSEQUENCE = " + i.ToString()
                                'dt = dv.ToTable()
                                'If (dt.Rows.Count > 0) Then
                                '    If dt.Rows(0).Item("ROWVALUE").ToString() <> "" Then
                                '        lbl.Text = dt.Rows(0).Item("NAME").ToString() '+ " (" + dt.Rows(0).Item("UNITSHRT").ToString() + ")"
                                '    End If
                                'End If
                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("NAME").ToString()
                                lbl.CssClass = "Label"
                                Td.Controls.Add(lbl)
                                Td.Style.Add("text-align", "Left")
                                Td.Style.Add("padding-left", "5px")
                                HeaderTdSetting(Td, "180px", "", "1")
                            Else
                                Td = New TableCell()
                                Td.Text = "&nbsp;"
                                HeaderTdSetting(Td, "180px", "", "1")
                                Td.CssClass = "AlterNateColor2"
                            End If
                            Td.Font.Size = 8.5
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = False
                            Tr.Controls.Add(Td)
                        Next
                        Tr.Height = 30
                        tblCAGR.Controls.Add(Tr)
                    Next
                End If
            Else
                'RowCnt = objGetData.GetReportRegionCount(ddlRegionSet.SelectedValue)
                dsRows = objGetData.GetUsersReportRowsTemp(RptID)
                For i = 1 To dsRows.Tables(0).Rows.Count
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label
                            'dv.RowFilter = "ROWSEQUENCE = " + i.ToString()
                            'dt = dv.ToTable()
                            'If (dt.Rows.Count > 0) Then
                            '    If dt.Rows(0).Item("ROWVALUE").ToString() <> "" Then
                            '        lbl.Text = dt.Rows(0).Item("NAME").ToString() '+ " (" + dt.Rows(0).Item("UNITSHRT").ToString() + ")"
                            '    End If
                            'End If
                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("ROWDECRIPTION").ToString()
                            lbl.CssClass = "Label"
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            Td.Text = "&nbsp;"
                            HeaderTdSetting(Td, "180px", "", "1")
                            Td.CssClass = "AlterNateColor2"
                        End If
                        Td.Font.Size = 8.5
                        Td.Font.Name = "Verdana"
                        Td.Font.Bold = False
                        Tr.Controls.Add(Td)
                    Next
                    Tr.Height = 30
                    tblCAGR.Controls.Add(Tr)
                Next
            End If

        Catch ex As Exception
            ErrorLable.Text = "Error:SetPivotRegReportFrameWorkTemp " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub SetPivotRegReportFrameWorkTempOLD(ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Dim YearId As String = ""
        Dim UnitId As String = ""
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsUnitPref As New DataSet
        Dim dsRep As New DataSet
        Dim RowCnt As New Integer
        Dim ColCnt As New Integer
        Dim filterCnt As New Integer
        Dim GrpId As String = ""
        Dim dsGrp As New DataSet
        Try
            'Checking for Edit
            If ViewState("Edit") = "Y" Then
                Flag = True
            Else
                Flag = False
            End If

            If hidReport.Value <> "0" Then
                dsRep = Session("dsRep" + REPId.ToString())
                dsUnitPref = Session("dsPref" + REPId.ToString())
                dsRows = Session("dsRows" + REPId.ToString())
                dsCol = Session("dsColumns" + REPId.ToString())
                dsFilter = Session("dsFilters" + REPId.ToString())
            Else
                dsRep = objGetData.GetReportDetails(REPId.ToString())
                dsUnitPref = objGetData.GetPref(REPId.ToString())
                dsRows = objGetData.GetUsersDynamicReportRows(REPId.ToString())
                dsCol = objGetData.GetUsersDynamicReportCols(REPId.ToString())
                dsFilter = objGetData.GetUsersReportFilters(REPId.ToString())

                Session("dsRep" + REPId.ToString()) = dsRep
                Session("dsPref" + REPId.ToString()) = dsUnitPref
                Session("dsRows" + REPId.ToString()) = dsRows
                Session("dsColumns" + REPId.ToString()) = dsCol
                Session("dsFilters" + REPId.ToString()) = dsFilter

                hidReport.Value = "1"
            End If

            filterCnt = dsFilter.Tables(0).Rows.Count
            ColCnt = dsCol.Tables(0).Rows.Count

            For a = 0 To dsCol.Tables(0).Rows.Count - 1
                If dsCol.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    YearId = YearId + "" + dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
                End If
            Next
            YearId = YearId.Remove(YearId.Length - 1)

            UnitId = dsRows.Tables(0).Rows(0).Item("UNITID").ToString()

            dvCol = dsCol.Tables(0).DefaultView
            dvRptCols1 = dsCol.Tables(0).DefaultView
            dvRptCols2 = dsCol.Tables(0).DefaultView
            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()
                        Link.CssClass = "LinkM"
                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            ' If Flag Then
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                            'End If
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                    Next

                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink
                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)

            Next
            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            Dim dsTables As New DataSet
            Dim dvTables As New DataView
            Dim dtTables As New DataTable
            Dim ProdId As String = ""
            'Dim ProdTbl(11) As String
            Dim PackId As String = ""
            Dim dsProd As New DataSet
            Dim dvProd As New DataView
            Dim dtProd As New DataTable
            Dim dsPack As New DataSet
            Dim dvPack As New DataView
            Dim dtPack As New DataTable
            Dim dsOrder As New DataSet()
            Dim funflag As Boolean = False
            Dim MatId As String = ""
            Dim FactId As String = ""
            Dim dsMat As New DataSet
            Dim dsProdMat As New DataSet
            Dim arrRfilt(filterCnt) As String

            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            Dim ProdTbl(dsTables.Tables(0).Rows.Count - 1) As String

            For a = 0 To dsFilter.Tables(0).Rows.Count - 1
                If dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                    arrRfilt(a) = "PRODUCT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                            ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            RowCnt += 1
                        Next
                        dtTables = dsTables.Tables(0)
                        ProdId = ProdId.Remove(ProdId.Length - 1)
                        If MatId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackMatProducts(ProdId, PackId, MatId)
                        ElseIf MatId <> "" Then
                            dsProd = objGetData.GetPivotMatProducts(MatId, ProdId)
                        ElseIf PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)
                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                        ProdId = ""
                        For b = 0 To dsProd.Tables(0).Rows.Count - 1
                            ProdId = ProdId + "" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + ","
                        Next
                        ProdId = ProdId.Remove(ProdId.Length - 1)

                    Else
                        ProdId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                        dtTables = dvTables.ToTable()
                        ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                        RowCnt += 1
                        If MatId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackMatProducts(ProdId, PackId, MatId)

                        ElseIf MatId <> "" Then
                            dsProd = objGetData.GetPivotMatProducts(MatId, ProdId)

                        ElseIf PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts("", PackId)

                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                    End If

                    dsProd.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsProd.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsProd.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                    arrRfilt(a) = "PACKAGE"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" And MatId <> "" Then
                            dsPack = objGetData.GetPivotProdMatPackages(ProdId, MatId, "")

                        ElseIf ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, "")

                        Else
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                                ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                                RowCnt += 1
                            Next
                            dtTables = dsTables.Tables(0)
                            ProdId = ProdId.Remove(ProdId.Length - 1)
                            If MatId <> "" Then
                                dsPack = objGetData.GetPivotMatAllPackages(ProdId, MatId)
                            Else
                                dsPack = objGetData.GetPackages(ProdId)
                            End If
                        End If
                        For b = 0 To dsPack.Tables(0).Rows.Count - 1
                            PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("PACKAGETYPEID").ToString() + ","
                        Next
                        PackId = PackId.Remove(PackId.Length - 1)
                    Else
                        PackId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" And MatId <> "" Then
                            dsPack = objGetData.GetPivotProdMatPackages(ProdId, MatId, PackId)

                        ElseIf ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, PackId)

                        ElseIf MatId <> "" Then
                            dsPack = objGetData.GetPivotMatPackages(MatId, PackId)

                        Else
                            dsPack = objGetData.GetPivotPackages(PackId)
                        End If
                    End If

                    dsPack.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsPack.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsPack.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "MATERIAL" Then
                    arrRfilt(a) = "MATERIAL"
                    MatId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    If ProdId <> "" And PackId <> "" Then
                        dsMat = objGetData.GetPivotPackProdMaterials(ProdId, PackId, MatId)

                    ElseIf ProdId <> "" Then
                        dsMat = objGetData.GetPivotProdMaterials(ProdId, MatId)

                    ElseIf PackId <> "" Then
                        dsMat = objGetData.GetPivotPackMaterials(ProdId, PackId, MatId)

                    Else
                        dsMat = objGetData.GetPivotMaterials(MatId)
                    End If

                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "GROUP" Then
                    arrRfilt(a) = "GROUP"
                    GrpId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsGrp = objGetData.GetPivotGroups(GrpId)

                    dsGrp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsGrp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsGrp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                End If
            Next

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                Else
                                    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                                End If
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        End If
                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next

            Dim dv1 As New DataView
            Dim dv2 As New DataView
            Dim dv3 As New DataView
            Dim dt1 As New DataTable
            Dim dt2 As New DataTable
            Dim dt3 As New DataTable
            Dim dsRptAct As New DataSet
            Dim dvRptAct As New DataView
            Dim dtRptAct As New DataTable
            Dim strRFilt1 As String = ""
            Dim strRFilt2 As String = ""
            Dim strRFilt3 As String = ""

            If ProdTbl(0) = "" Then
                For b = 0 To dsTables.Tables(0).Rows.Count - 1
                    ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                    RowCnt += 1
                Next
            End If

            Dim dvRpt As New DataView
            Dim dtRpt As New DataTable

            If funflag Then
                If filterCnt = 1 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                ElseIf filterCnt = 2 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                ElseIf filterCnt = 3 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                    dv3 = dsOrder.Tables(2).DefaultView
                End If

                dsRows = objGetData.GetReportRegionsByRegionSet(dsRep.Tables(0).Rows(0).Item("REGIONSETID").ToString())
                dsRptAct = objGetData.GetPivotReportData_REGION(ProdTbl, MatId, YearId, ProdId, PackId, GrpId, "", UnitId, dsTables.Tables(0).Rows.Count, dsRep.Tables(0).Rows(0).Item("REGIONSETID").ToString(), dsRows)
                dvRptAct = dsRptAct.Tables(0).DefaultView
                dvRpt = dsRptAct.Tables(0).DefaultView
                If dsOrder.Tables(0).Rows.Count <> 0 Then
                    For a = 0 To dsOrder.Tables(0).Rows.Count - 1
                        If arrRfilt(0) = "PRODUCT" Then
                            strRFilt1 = "CATEGORYID = " + dsOrder.Tables(0).Rows(a).Item("CATEGORYID").ToString()
                        ElseIf arrRfilt(0) = "PACKAGE" Then
                            strRFilt1 = "PACKAGETYPEID = " + dsOrder.Tables(0).Rows(a).Item("PACKAGETYPEID").ToString()
                        ElseIf arrRfilt(0) = "MATERIAL" Then
                            strRFilt1 = "MATERIALID = " + dsOrder.Tables(0).Rows(a).Item("MATERIALID").ToString()
                        ElseIf arrRfilt(0) = "GROUP" Then
                            strRFilt1 = "SUBGROUPID = " + dsOrder.Tables(0).Rows(a).Item("SUBGROUPID").ToString()
                        End If
                        dvRpt.RowFilter = strRFilt1
                        dtRpt = dvRpt.ToTable()
                        If dtRpt.Rows.Count > 0 Then
                            Tr = New TableRow
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label

                                    lbl.Text = dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-left", "5px")
                                    HeaderTdSetting(Td, "150px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()

                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        If count1 <> 0 And count2 <> 0 Then
                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        Else
                                            lbl.Text = FormatNumber(0, 4)
                                        End If
                                    End If
                                    'Td.CssClass = "AlterNateColor2"
                                    Td.Controls.Add(lbl)
                                    Td.Font.Bold = True
                                    Td.Style.Add("text-align", "Right")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-right", "10px")
                                    HeaderTdSetting(Td, "130px", "", "1")
                                End If
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30

                            If filterCnt = 1 Then
                                tblCAGR.Controls.Add(Tr)

                                For i = 1 To dsRows.Tables(0).Rows.Count
                                    Tr = New TableRow
                                    For j = 0 To ColCnt
                                        If j = 0 Then
                                            Td = New TableCell()
                                            lbl = New Label
                                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("NAME").ToString()
                                            lbl.CssClass = "Label"
                                            Td.Controls.Add(lbl)
                                            Td.Style.Add("text-align", "Left")
                                            Td.Font.Size = 8.5
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = False
                                            Td.Style.Add("padding-left", "25px")
                                            HeaderTdSetting(Td, "150px", "", "1")
                                        Else
                                            Td = New TableCell()
                                            lbl = New Label
                                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                Dim ProdCount As New Double
                                                If strRFilt1 <> "" Then
                                                    dvRptAct.RowFilter = strRFilt1 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                Else
                                                    dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                End If
                                                dtRptAct = dvRptAct.ToTable()
                                                If dtRptAct.Rows.Count > 0 Then
                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                If UnitId = 1 Then
                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                ElseIf UnitId = 2 Then
                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                ElseIf UnitId = 4 Then
                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                Else
                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                End If
                                                            Else
                                                                If UnitId = 1 Then
                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                ElseIf UnitId = 2 Then
                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                ElseIf UnitId = 3 Then
                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                ElseIf UnitId = 4 Then
                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                Else
                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                End If
                                                            End If
                                                        End If
                                                    Next
                                                End If
                                                lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                            Else
                                                Dim count1 As New Double
                                                Dim count2 As New Double
                                                Dim diff As New Double
                                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                dtRptCols1 = dvRptCols1.ToTable()
                                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                dtRptCols2 = dvRptCols2.ToTable()

                                                If strRFilt1 <> "" Then
                                                    dvRptAct.RowFilter = strRFilt1 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                Else
                                                    dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                End If
                                                dtRptAct = dvRptAct.ToTable()
                                                If dtRptAct.Rows.Count > 0 Then
                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                If UnitId = 1 Then
                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                ElseIf UnitId = 2 Then
                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                ElseIf UnitId = 4 Then
                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                Else
                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                End If
                                                            Else
                                                                If UnitId = 1 Then
                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                ElseIf UnitId = 2 Then
                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                ElseIf UnitId = 3 Then
                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                ElseIf UnitId = 4 Then
                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                Else
                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                End If
                                                            End If
                                                        End If
                                                    Next
                                                End If

                                                If strRFilt1 <> "" Then
                                                    dvRptAct.RowFilter = strRFilt1 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                Else
                                                    dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                End If
                                                dtRptAct = dvRptAct.ToTable()
                                                If dtRptAct.Rows.Count > 0 Then
                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                If UnitId = 1 Then
                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                ElseIf UnitId = 2 Then
                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                ElseIf UnitId = 4 Then
                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                Else
                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                End If
                                                            Else
                                                                If UnitId = 1 Then
                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                ElseIf UnitId = 2 Then
                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                ElseIf UnitId = 3 Then
                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                ElseIf UnitId = 4 Then
                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                Else
                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                End If
                                                            End If
                                                        End If
                                                    Next
                                                End If

                                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                If count1 <> 0 And count2 <> 0 Then
                                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                Else
                                                    lbl.Text = FormatNumber(0, 4)
                                                End If
                                            End If
                                            lbl.CssClass = "Label"
                                            Td.Controls.Add(lbl)
                                            Td.CssClass = "AlterNateColor2"
                                            Td.Style.Add("text-align", "Right")
                                            Td.Style.Add("padding-right", "10px")
                                        End If
                                        Td.Font.Size = 8.5
                                        Td.Font.Name = "Verdana"
                                        Td.Font.Bold = False
                                        Tr.Controls.Add(Td)
                                    Next
                                    Tr.Height = 30
                                    tblCAGR.Controls.Add(Tr)
                                Next
                            Else
                                If arrRfilt(1) <> "REGION" And arrRfilt(1) <> "COUNTRY" And arrRfilt(1) <> "GROUP" Then
                                    dv2.RowFilter = strRFilt1
                                End If
                                dt2 = dv2.ToTable()
                                If dt2.Rows.Count > 0 Then
                                    tblCAGR.Controls.Add(Tr)
                                    For b = 0 To dt2.Rows.Count - 1
                                        strRFilt2 = ""
                                        Tr = New TableRow
                                        If arrRfilt(1) = "PRODUCT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            Else
                                                strRFilt2 = "CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "PACKAGE" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            Else
                                                strRFilt2 = "PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "MATERIAL" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            Else
                                                strRFilt2 = "MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "GROUP" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            Else
                                                strRFilt2 = "SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            End If
                                        End If
                                        dvRpt.RowFilter = strRFilt2
                                        dtRpt = dvRpt.ToTable()

                                        If dtRpt.Rows.Count > 0 Then
                                            For j = 0 To ColCnt
                                                If j = 0 Then
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    lbl.Text = dt2.Rows(b).Item("VALUE").ToString()
                                                    lbl.CssClass = "Label"
                                                    Td.Controls.Add(lbl)
                                                    Td.Font.Size = 9
                                                    Td.Font.Bold = True
                                                    Td.Style.Add("text-align", "Left")
                                                    Td.Style.Add("padding-left", "25px")
                                                    HeaderTdSetting(Td, "150px", "", "1")
                                                Else
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                        Dim ProdCount As New Double
                                                        If strRFilt2 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        If UnitId = 1 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    Else
                                                                        If UnitId = 1 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If
                                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                    Else
                                                        Dim count1 As New Double
                                                        Dim count2 As New Double
                                                        Dim diff As New Double
                                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                        dtRptCols1 = dvRptCols1.ToTable()
                                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                        dtRptCols2 = dvRptCols2.ToTable()

                                                        If strRFilt2 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        If UnitId = 1 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    Else
                                                                        If UnitId = 1 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If

                                                        If strRFilt2 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        If UnitId = 1 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    Else
                                                                        If UnitId = 1 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If

                                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                        If count1 <> 0 And count2 <> 0 Then
                                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                        Else
                                                            lbl.Text = FormatNumber(0, 4)
                                                        End If
                                                    End If
                                                    Td.Controls.Add(lbl)
                                                    Td.CssClass = "AlterNateColor2"
                                                    Td.Style.Add("color", "#660022")
                                                    Td.Style.Add("padding-right", "10px")
                                                    Td.Style.Add("text-align", "Right")
                                                End If
                                                Td.Font.Size = 9
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = True
                                                Tr.Controls.Add(Td)
                                            Next
                                            Tr.Height = 30
                                            tblCAGR.Controls.Add(Tr)
                                        End If

                                        If filterCnt = 2 Then
                                            For i = 1 To dsRows.Tables(0).Rows.Count
                                                Tr = New TableRow
                                                For j = 0 To ColCnt
                                                    If j = 0 Then
                                                        Td = New TableCell()
                                                        lbl = New Label
                                                        lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("NAME").ToString()
                                                        lbl.CssClass = "Label"
                                                        Td.Controls.Add(lbl)
                                                        Td.Style.Add("text-align", "Left")
                                                        Td.Style.Add("padding-left", "50px")
                                                        HeaderTdSetting(Td, "150px", "", "1")
                                                    Else
                                                        Td = New TableCell()
                                                        lbl = New Label
                                                        If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                            Dim ProdCount As New Double
                                                            If strRFilt2 <> "" Then
                                                                dvRptAct.RowFilter = strRFilt2 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                            Else
                                                                dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                            End If
                                                            dtRptAct = dvRptAct.ToTable()
                                                            If dtRptAct.Rows.Count > 0 Then
                                                                For l = 0 To dtRptAct.Rows.Count - 1
                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                            If UnitId = 1 Then
                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            ElseIf UnitId = 2 Then
                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            ElseIf UnitId = 4 Then
                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            Else
                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            End If
                                                                        Else
                                                                            If UnitId = 1 Then
                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                            ElseIf UnitId = 2 Then
                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                            ElseIf UnitId = 3 Then
                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                            ElseIf UnitId = 4 Then
                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            Else
                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            End If
                                                                        End If
                                                                    End If
                                                                Next
                                                            End If
                                                            lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                        Else
                                                            Dim count1 As New Double
                                                            Dim count2 As New Double
                                                            Dim diff As New Double
                                                            dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                            dtRptCols1 = dvRptCols1.ToTable()
                                                            dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                            dtRptCols2 = dvRptCols2.ToTable()

                                                            If strRFilt2 <> "" Then
                                                                dvRptAct.RowFilter = strRFilt2 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                            Else
                                                                dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                            End If
                                                            dtRptAct = dvRptAct.ToTable()
                                                            If dtRptAct.Rows.Count > 0 Then
                                                                For l = 0 To dtRptAct.Rows.Count - 1
                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                            If UnitId = 1 Then
                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            ElseIf UnitId = 2 Then
                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            ElseIf UnitId = 4 Then
                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            Else
                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            End If
                                                                        Else
                                                                            If UnitId = 1 Then
                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                            ElseIf UnitId = 2 Then
                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                            ElseIf UnitId = 3 Then
                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                            ElseIf UnitId = 4 Then
                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            Else
                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            End If
                                                                        End If
                                                                    End If
                                                                Next
                                                            End If

                                                            If strRFilt2 <> "" Then
                                                                dvRptAct.RowFilter = strRFilt2 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                            Else
                                                                dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                            End If
                                                            dtRptAct = dvRptAct.ToTable()
                                                            If dtRptAct.Rows.Count > 0 Then
                                                                For l = 0 To dtRptAct.Rows.Count - 1
                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                            If UnitId = 1 Then
                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            ElseIf UnitId = 2 Then
                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            ElseIf UnitId = 4 Then
                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            Else
                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            End If
                                                                        Else
                                                                            If UnitId = 1 Then
                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                            ElseIf UnitId = 2 Then
                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                            ElseIf UnitId = 3 Then
                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                            ElseIf UnitId = 4 Then
                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            Else
                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            End If
                                                                        End If
                                                                    End If
                                                                Next
                                                            End If

                                                            diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                            If count1 <> 0 And count2 <> 0 Then
                                                                lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                            Else
                                                                lbl.Text = FormatNumber(0, 4)
                                                            End If
                                                        End If
                                                        lbl.CssClass = "Label"
                                                        Td.Controls.Add(lbl)
                                                        Td.CssClass = "AlterNateColor2"
                                                        Td.Style.Add("text-align", "Right")
                                                        Td.Style.Add("padding-right", "10px")
                                                    End If
                                                    Td.Font.Size = 8.5
                                                    Td.Font.Name = "Verdana"
                                                    Td.Font.Bold = False
                                                    Tr.Controls.Add(Td)
                                                Next
                                                Tr.Height = 30
                                                tblCAGR.Controls.Add(Tr)
                                            Next
                                        Else
                                            If arrRfilt(2) <> "REGION" And arrRfilt(2) <> "COUNTRY" And arrRfilt(2) <> "GROUP" Then
                                                dv3.RowFilter = strRFilt2
                                            End If
                                            dt3 = dv3.ToTable()
                                            If dt3.Rows.Count > 0 Then
                                                For c = 0 To dt3.Rows.Count - 1
                                                    strRFilt3 = ""
                                                    If arrRfilt(2) = "PRODUCT" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                        Else
                                                            strRFilt3 = "CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "PACKAGE" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "MATERIAL" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString()
                                                        Else
                                                            strRFilt3 = "MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "GROUP" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                        Else
                                                            strRFilt3 = "SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                        End If
                                                    End If
                                                    dvRpt.RowFilter = strRFilt3
                                                    dtRpt = dvRpt.ToTable()
                                                    Tr = New TableRow
                                                    For j = 0 To ColCnt
                                                        If j = 0 Then
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            lbl.Text = dt3.Rows(c).Item("VALUE").ToString()
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.Font.Size = 8.5
                                                            Td.Font.Bold = True
                                                            Td.Style.Add("text-align", "Left")
                                                            Td.Style.Add("padding-left", "50px")
                                                            HeaderTdSetting(Td, "150px", "", "1")
                                                        Else
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                Dim ProdCount As New Double
                                                                If strRFilt3 <> "" Then
                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                Else
                                                                    dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                If UnitId = 1 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            Else
                                                                                If UnitId = 1 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                ElseIf UnitId = 3 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        End If
                                                                    Next
                                                                End If
                                                                lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                            Else
                                                                Dim count1 As New Double
                                                                Dim count2 As New Double
                                                                Dim diff As New Double
                                                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                dtRptCols1 = dvRptCols1.ToTable()
                                                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                dtRptCols2 = dvRptCols2.ToTable()

                                                                If strRFilt3 <> "" Then
                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                Else
                                                                    dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                If UnitId = 1 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            Else
                                                                                If UnitId = 1 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                ElseIf UnitId = 3 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        End If
                                                                    Next
                                                                End If

                                                                If strRFilt3 <> "" Then
                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                Else
                                                                    dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                If UnitId = 1 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            Else
                                                                                If UnitId = 1 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                ElseIf UnitId = 3 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        End If
                                                                    Next
                                                                End If

                                                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                If count1 <> 0 And count2 <> 0 Then
                                                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                Else
                                                                    lbl.Text = FormatNumber(0, 4)
                                                                End If
                                                            End If
                                                            Td.Controls.Add(lbl)
                                                            Td.CssClass = "AlterNateColor2"
                                                            Td.Style.Add("text-align", "Right")
                                                            Td.Style.Add("padding-right", "10px")
                                                        End If
                                                        Td.Font.Size = 8.5
                                                        Td.Font.Name = "Verdana"
                                                        Td.Font.Bold = True
                                                        Tr.Controls.Add(Td)
                                                    Next
                                                    Tr.Height = 30
                                                    tblCAGR.Controls.Add(Tr)

                                                    For i = 1 To dsRows.Tables(0).Rows.Count
                                                        Tr = New TableRow
                                                        For j = 0 To ColCnt
                                                            If j = 0 Then
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("NAME").ToString()
                                                                lbl.CssClass = "Label"
                                                                Td.Controls.Add(lbl)
                                                                Td.Style.Add("text-align", "Left")
                                                                Td.Style.Add("padding-left", "75px")
                                                                HeaderTdSetting(Td, "150px", "", "1")
                                                            Else
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                    Dim ProdCount As New Double
                                                                    If strRFilt3 <> "" Then
                                                                        dvRptAct.RowFilter = strRFilt3 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    Else
                                                                        dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    End If
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If
                                                                    lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                Else
                                                                    Dim count1 As New Double
                                                                    Dim count2 As New Double
                                                                    Dim diff As New Double
                                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                    dtRptCols2 = dvRptCols2.ToTable()

                                                                    If strRFilt3 <> "" Then
                                                                        dvRptAct.RowFilter = strRFilt3 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    Else
                                                                        dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    End If
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If

                                                                    If strRFilt3 <> "" Then
                                                                        dvRptAct.RowFilter = strRFilt3 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    Else
                                                                        dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    End If
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If

                                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                    If count1 <> 0 And count2 <> 0 Then
                                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                    Else
                                                                        lbl.Text = FormatNumber(0, 4)
                                                                    End If
                                                                End If
                                                                lbl.CssClass = "Label"
                                                                Td.Controls.Add(lbl)
                                                                Td.CssClass = "AlterNateColor2"
                                                                Td.Style.Add("text-align", "Right")
                                                                Td.Style.Add("padding-right", "10px")
                                                            End If
                                                            Td.Font.Size = 8.5
                                                            Td.Font.Name = "Verdana"
                                                            Td.Font.Bold = False
                                                            Tr.Controls.Add(Td)
                                                        Next
                                                        Tr.Height = 30
                                                        tblCAGR.Controls.Add(Tr)
                                                    Next
                                                Next
                                            End If
                                        End If
                                    Next
                                End If
                            End If
                        End If
                    Next
                Else
                    For i = 1 To dsRows.Tables(0).Rows.Count
                        Tr = New TableRow
                        For j = 0 To ColCnt
                            If j = 0 Then
                                Td = New TableCell()
                                lbl = New Label
                                'dv.RowFilter = "ROWSEQUENCE = " + i.ToString()
                                'dt = dv.ToTable()
                                'If (dt.Rows.Count > 0) Then
                                '    If dt.Rows(0).Item("ROWVALUE").ToString() <> "" Then
                                '        lbl.Text = dt.Rows(0).Item("NAME").ToString() '+ " (" + dt.Rows(0).Item("UNITSHRT").ToString() + ")"
                                '    End If
                                'End If
                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("NAME").ToString()
                                lbl.CssClass = "Label"
                                Td.Controls.Add(lbl)
                                Td.Style.Add("text-align", "Left")
                                Td.Style.Add("padding-left", "5px")
                                HeaderTdSetting(Td, "150px", "", "1")
                            Else
                                Td = New TableCell()
                                Td.Text = "&nbsp;"
                                HeaderTdSetting(Td, "150px", "", "1")
                                Td.CssClass = "AlterNateColor2"
                            End If
                            Td.Font.Size = 8.5
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = False
                            Tr.Controls.Add(Td)
                        Next
                        Tr.Height = 30
                        tblCAGR.Controls.Add(Tr)
                    Next
                End If
            Else
                'RowCnt = objGetData.GetReportRegionCount(ddlRegionSet.SelectedValue)
                dsRows = objGetData.GetUsersReportRowsTemp(RptID)
                For i = 1 To dsRows.Tables(0).Rows.Count
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label
                            'dv.RowFilter = "ROWSEQUENCE = " + i.ToString()
                            'dt = dv.ToTable()
                            'If (dt.Rows.Count > 0) Then
                            '    If dt.Rows(0).Item("ROWVALUE").ToString() <> "" Then
                            '        lbl.Text = dt.Rows(0).Item("NAME").ToString() '+ " (" + dt.Rows(0).Item("UNITSHRT").ToString() + ")"
                            '    End If
                            'End If
                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("ROWDECRIPTION").ToString()
                            lbl.CssClass = "Label"
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "150px", "", "1")
                        Else
                            Td = New TableCell()
                            Td.Text = "&nbsp;"
                            HeaderTdSetting(Td, "150px", "", "1")
                            Td.CssClass = "AlterNateColor2"
                        End If
                        Td.Font.Size = 8.5
                        Td.Font.Name = "Verdana"
                        Td.Font.Bold = False
                        Tr.Controls.Add(Td)
                    Next
                    Tr.Height = 30
                    tblCAGR.Controls.Add(Tr)
                Next
            End If

        Catch ex As Exception
            ErrorLable.Text = "Error:SetPivotRegReportFrameWorkTemp " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub SetPivotCntryReportFrameWorkTemp(ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Dim YearId As String = ""
        Dim UnitId As String = ""
        Dim RegionId As String = ""
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsUnitPref As New DataSet
        Dim dsRep As New DataSet
        Dim RowCnt As New Integer
        Dim ColCnt As New Integer
        Dim filterCnt As New Integer
        Dim imgUp As New ImageButton
        Dim imgDn As New ImageButton
        Dim CompId As String = ""
        Dim dsComp As New DataSet
        Try
            If hidReport.Value <> "0" Then
                dsRep = Session("dsRep" + REPId.ToString())
                dsUnitPref = Session("dsPref" + REPId.ToString())
                dsRows = Session("dsRows" + REPId.ToString())
                dsCol = Session("dsColumns" + REPId.ToString())
                dsFilter = Session("dsFilters" + REPId.ToString())
            Else
                dsRep = objGetData.GetUserCustomReportsByRptId(REPId.ToString())
                dsUnitPref = objGetData.GetPref(REPId.ToString())
                dsRows = objGetData.GetUsersDynamicReportRows(REPId.ToString())
                dsCol = objGetData.GetUsersDynamicReportCols(REPId.ToString())
                dsFilter = objGetData.GetUsersReportFilters(REPId.ToString())

                Session("dsRep" + REPId.ToString()) = dsRep
                Session("dsPref" + REPId.ToString()) = dsUnitPref
                Session("dsRows" + REPId.ToString()) = dsRows
                Session("dsColumns" + REPId.ToString()) = dsCol
                Session("dsFilters" + REPId.ToString()) = dsFilter

                hidReport.Value = "1"
            End If

            filterCnt = dsFilter.Tables(0).Rows.Count
            ColCnt = dsCol.Tables(0).Rows.Count

            For a = 0 To dsCol.Tables(0).Rows.Count - 1
                If dsCol.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    YearId = YearId + "" + dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
                End If
            Next
            YearId = YearId.Remove(YearId.Length - 1)
            RegionId = dsRep.Tables(0).Rows(0).Item("REGIONID").ToString()
            UnitId = dsRows.Tables(0).Rows(0).Item("UNITID").ToString()

            dvCol = dsCol.Tables(0).DefaultView
            dvRptCols1 = dsCol.Tables(0).DefaultView
            dvRptCols2 = dsCol.Tables(0).DefaultView

            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()
                        Link.CssClass = "LinkM"
                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                    Next
                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink
                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)
            Next

            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            Dim dsTables As New DataSet
            Dim dvTables As New DataView
            Dim dtTables As New DataTable
            Dim ProdId As String = ""
            'Dim ProdTbl(11) As String
            Dim PackId As String = ""
            Dim dsProd As New DataSet
            Dim dvProd As New DataView
            Dim dtProd As New DataTable
            Dim dsPack As New DataSet
            Dim dvPack As New DataView
            Dim dtPack As New DataTable
            Dim dsOrder As New DataSet()
            Dim funflag As Boolean = False
            Dim MatId As String = ""
            Dim GrpId As String = ""
            Dim FactId As String = ""
            Dim dsMat As New DataSet
            Dim dsGrp As New DataSet
            Dim dsProdMat As New DataSet
            Dim arrRfilt(filterCnt) As String

            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            Dim ProdTbl(dsTables.Tables(0).Rows.Count - 1) As String

            For a = 0 To dsFilter.Tables(0).Rows.Count - 1
                If dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                    arrRfilt(a) = "PRODUCT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                            ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            RowCnt += 1
                        Next
                        dtTables = dsTables.Tables(0)
                        ProdId = ProdId.Remove(ProdId.Length - 1)
                        If MatId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackMatProducts(ProdId, PackId, MatId)
                        ElseIf CompId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackCompProducts(ProdId, PackId, CompId)
                        ElseIf MatId <> "" Then
                            dsProd = objGetData.GetPivotMatProducts(MatId, ProdId)
                        ElseIf CompId <> "" Then
                            dsProd = objGetData.GetPivotCompProducts(CompId, ProdId)
                        ElseIf PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)
                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                        'ProdId = ""
		       

                        For b = 0 To dsProd.Tables(0).Rows.Count - 1
                            ProdId = ProdId + "" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + ","
                        Next
                        ProdId = ProdId.Remove(ProdId.Length - 1)
 		     
                    Else
                        ProdId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                        dtTables = dvTables.ToTable()
                        ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                        RowCnt += 1
                        If MatId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackMatProducts(ProdId, PackId, MatId)
                        ElseIf CompId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackCompProducts(ProdId, PackId, CompId)
                        ElseIf MatId <> "" Then
                            dsProd = objGetData.GetPivotMatProducts(MatId, ProdId)
                        ElseIf CompId <> "" Then
                            dsProd = objGetData.GetPivotCompProducts(CompId, ProdId)
                        ElseIf PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)
                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                    End If
                    dsProd.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsProd.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsProd.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                    arrRfilt(a) = "PACKAGE"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" And MatId <> "" Then
                            dsPack = objGetData.GetPivotProdMatPackages(ProdId, MatId, "")
                        ElseIf ProdId <> "" And CompId <> "" Then
                            dsPack = objGetData.GetProdCompPackages(ProdId, CompId, "")
                        ElseIf ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, "")
                        Else
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            If MatId <> "" Then
                                dsPack = objGetData.GetPivotMatAllPackages(ProdId1, MatId)
                            ElseIf CompId <> "" Then
                                dsPack = objGetData.GetPivotCompAllPackages(ProdId1, CompId)
                            Else
                                dsPack = objGetData.GetPackages(ProdId1)
                            End If
                        End If
                        For b = 0 To dsPack.Tables(0).Rows.Count - 1
                            PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("PACKAGETYPEID").ToString() + ","
                        Next
                        PackId = PackId.Remove(PackId.Length - 1)
                    Else
                        PackId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" And MatId <> "" Then
                            dsPack = objGetData.GetPivotProdMatPackages(ProdId, MatId, PackId)
                        ElseIf ProdId <> "" And CompId <> "" Then
                            dsPack = objGetData.GetProdCompPackages(ProdId, CompId, PackId)
                        ElseIf ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, PackId)
                        ElseIf MatId <> "" Then
                            dsPack = objGetData.GetPivotMatPackages(MatId, PackId)
                        ElseIf CompId <> "" Then
                            dsPack = objGetData.GetPivotCompPackages(PackId, CompId)
                        Else
                            dsPack = objGetData.GetPivotPackages(PackId)
                        End If
                    End If
                    dsPack.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsPack.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsPack.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "MATERIAL" Then
                    arrRfilt(a) = "MATERIAL"
                    MatId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    If ProdId <> "" And PackId <> "" Then
                        dsMat = objGetData.GetPivotPackProdMaterials(ProdId, PackId, MatId)
                    ElseIf ProdId <> "" Then
                        dsMat = objGetData.GetPivotProdMaterials(ProdId, MatId)
                    ElseIf PackId <> "" Then
                        Dim ProdId1 As String = ""
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdId1 = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                        Next
                        ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                        dsMat = objGetData.GetPivotPackMaterials(ProdId1, PackId, MatId)
                    Else
                        dsMat = objGetData.GetPivotMaterials(MatId)
                    End If
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COMPONENT" Then
                    arrRfilt(a) = "COMPONENT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" And PackId <> "" Then
                            dsComp = objGetData.GetPivotPackProdComponents(ProdId, PackId, "")

                        ElseIf ProdId <> "" Then
                            dsComp = objGetData.GetPivotProdComponents(ProdId, "")

                        Else
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            If PackId <> "" Then
                                dsComp = objGetData.GetPivotPackComponents(ProdId1, PackId, "")
                            Else
                                dsComp = objGetData.GetPivotAllComponents(ProdId1)
                            End If
                        End If
                        For b = 0 To dsComp.Tables(0).Rows.Count - 1
                            CompId = CompId + "" + dsComp.Tables(0).Rows(b).Item("COMPONENTID").ToString() + ","
                        Next
                        CompId = CompId.Remove(CompId.Length - 1)
                    Else
                        CompId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" And PackId <> "" Then
                            dsComp = objGetData.GetPivotPackProdComponents(ProdId, PackId, CompId)

                        ElseIf ProdId <> "" Then
                            dsComp = objGetData.GetPivotProdComponents(ProdId, CompId)

                        ElseIf PackId <> "" Then
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            dsComp = objGetData.GetPivotPackComponents(ProdId1, PackId, CompId)

                        Else
                            dsComp = objGetData.GetRepComponent(CompId)
                        End If
                    End If

                    dsComp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsComp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsComp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "GROUP" Then
                    arrRfilt(a) = "GROUP"
                    GrpId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsGrp = objGetData.GetPivotGroups(GrpId)
                    dsGrp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsGrp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsGrp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                End If
            Next

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                Else
                                    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                                End If
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        End If
                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next

            Dim dv1 As New DataView
            Dim dv2 As New DataView
            Dim dv3 As New DataView
            Dim dt1 As New DataTable
            Dim dt2 As New DataTable
            Dim dt3 As New DataTable
            Dim dsRptAct As New DataSet
            Dim dvRptAct As New DataView
            Dim dtRptAct As New DataTable
            Dim strRFilt1 As String = ""
            Dim strRFilt2 As String = ""
            Dim strRFilt3 As String = ""

            If ProdTbl(0) = "" Then
                For b = 0 To dsTables.Tables(0).Rows.Count - 1
                    ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                    RowCnt += 1
                Next
            End If

            Dim dvRpt As New DataView
            Dim dtRpt As New DataTable

            If funflag Then
                If filterCnt = 1 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                ElseIf filterCnt = 2 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                ElseIf filterCnt = 3 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                    dv3 = dsOrder.Tables(2).DefaultView
                End If

                dsRows = objGetData.GetPivotCountry(RegionId)
                dsRptAct = objGetData.GetPivotReportData_COUNTRY(ProdTbl, YearId, ProdId, PackId, MatId, GrpId, CompId, RegionId, UnitId, dsTables.Tables(0).Rows.Count)
                dvRptAct = dsRptAct.Tables(0).DefaultView
                dvRpt = dsRptAct.Tables(0).DefaultView
                If dsOrder.Tables(0).Rows.Count <> 0 Then
                    For a = 0 To dsOrder.Tables(0).Rows.Count - 1
                        strRFilt1 = ""
                        If arrRfilt(0) = "PRODUCT" Then
                            strRFilt1 = "CATEGORYID = " + dsOrder.Tables(0).Rows(a).Item("CATEGORYID").ToString()
                        ElseIf arrRfilt(0) = "PACKAGE" Then
                            strRFilt1 = "PACKAGETYPEID = " + dsOrder.Tables(0).Rows(a).Item("PACKAGETYPEID").ToString()
                        ElseIf arrRfilt(0) = "MATERIAL" Then
                            strRFilt1 = "MATERIALID = " + dsOrder.Tables(0).Rows(a).Item("MATERIALID").ToString()
                        ElseIf arrRfilt(0) = "COMPONENT" Then
                            strRFilt1 = "COMPONENTID = " + dsOrder.Tables(0).Rows(a).Item("COMPONENTID").ToString()
                        ElseIf arrRfilt(0) = "GROUP" Then
                            'strRFilt1 = "SUBGROUPID = " + dsOrder.Tables(0).Rows(a).Item("SUBGROUPID").ToString()
                        End If
                        dvRpt.RowFilter = strRFilt1
                        dtRpt = dvRpt.ToTable()
                        If dtRpt.Rows.Count > 0 Then
                            Tr = New TableRow
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    imgUp = New ImageButton
                                    imgDn = New ImageButton
                                    imgUp.ID = "Up_Layer" + (a + 1).ToString()
                                    imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','-');"
                                    imgDn.ID = "Dn_Layer" + (a + 1).ToString()
                                    imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','+');"
                                    imgUp.Style.Add("display", "none")
                                    lbl.Text = dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    imgUp.ImageUrl = "~/Images/Minus.jpg"
                                    imgUp.Width = 20
                                    imgUp.Height = 12
                                    imgDn.ImageUrl = "~/Images/Plus.jpg"
                                    imgDn.Width = 20
                                    imgDn.Height = 12
                                    Td.Controls.Add(imgUp)
                                    Td.Controls.Add(imgDn)
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-left", "5px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()

                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        If count1 <> 0 And count2 <> 0 Then
                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        Else
                                            lbl.Text = FormatNumber(0, 4)
                                        End If
                                    End If
                                    Td.Controls.Add(lbl)
                                    Td.Font.Bold = True
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("text-align", "Right")
                                    Td.Style.Add("padding-right", "10px")
                                    HeaderTdSetting(Td, "130px", "", "1")
                                End If
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            ' Tr.CssClass = "header"

                            If filterCnt = 1 Then
                                tblCAGR.Controls.Add(Tr)
                                For i = 1 To dsRows.Tables(0).Rows.Count
                                    If strRFilt1 <> "" Then
                                        dvRptAct.RowFilter = strRFilt1 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND FCT<>0"
                                    Else
                                        dvRptAct.RowFilter = " COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString()
                                    End If
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Data" + i.ToString()
                                        Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("COUNTRYDES").ToString()
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Style.Add("padding-left", "25px")
                                                HeaderTdSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If
                                                    lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                    dtRptCols2 = dvRptCols2.ToTable()

                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If

                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If

                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                    If count1 <> 0 And count2 <> 0 Then
                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                    Else
                                                        lbl.Text = FormatNumber(0, 4)
                                                    End If
                                                End If
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.CssClass = "AlterNateColor2"
                                                Td.Style.Add("text-align", "Right")
                                                Td.Style.Add("padding-right", "10px")
                                            End If
                                            Td.Font.Size = 8.5
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = False
                                            Tr.Controls.Add(Td)
                                        Next
                                        Tr.Height = 30
                                        tblCAGR.Controls.Add(Tr)
                                    End If

                                Next
                            Else
                                If arrRfilt(1) <> "REGION" And arrRfilt(1) <> "GROUP" And arrRfilt(1) <> "COUNTRY" Then
                                    dv2.RowFilter = strRFilt1
                                End If
                                dt2 = dv2.ToTable()
                                If dt2.Rows.Count > 0 Then
                                    tblCAGR.Controls.Add(Tr)
                                    For b = 0 To dt2.Rows.Count - 1
                                        strRFilt2 = ""
                                        If arrRfilt(1) = "PRODUCT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            Else
                                                strRFilt2 = "CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "PACKAGE" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            Else
                                                strRFilt2 = "PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "MATERIAL" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            Else
                                                strRFilt2 = "MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "COMPONENT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND COMPONENTID = " + dt2.Rows(b).Item("COMPONENTID").ToString()
                                            Else
                                                strRFilt2 = "COMPONENTID = " + dt2.Rows(b).Item("COMPONENTID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "GROUP" Then
                                            strRFilt2 = strRFilt1
                                            'If strRFilt1 <> "" Then
                                            '    strRFilt2 = strRFilt1 + " AND SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            'Else
                                            '    strRFilt2 = "SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            'End If
                                        End If
                                        dvRpt.RowFilter = strRFilt2
                                        dtRpt = dvRpt.ToTable()
                                        If dtRpt.Rows.Count > 0 Then
                                            Tr = New TableRow
                                            Tr.CssClass = "Bhavesh"
                                            Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                            Tr.Style.Add("display", "none")
                                            For j = 0 To ColCnt
                                                If j = 0 Then
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    imgUp = New ImageButton
                                                    imgDn = New ImageButton
                                                    imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','-');"
                                                    imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','+');"
                                                    imgUp.Style.Add("display", "none")
                                                    lbl.Text = dt2.Rows(b).Item("VALUE").ToString()
                                                    lbl.CssClass = "Label"
                                                    imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                    imgUp.Width = 20
                                                    imgUp.Height = 12
                                                    imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                    imgDn.Width = 20
                                                    imgDn.Height = 12
                                                    Td.Controls.Add(imgUp)
                                                    Td.Controls.Add(imgDn)
                                                    Td.Controls.Add(lbl)
                                                    Td.Font.Size = 9
                                                    Td.Font.Bold = True
                                                    Td.Style.Add("text-align", "Left")
                                                    Td.Style.Add("padding-left", "25px")
                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                Else
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                        Dim ProdCount As New Double
                                                        If strRFilt2 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        If UnitId = 1 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    Else
                                                                        If UnitId = 1 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If
                                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                    Else
                                                        Dim count1 As New Double
                                                        Dim count2 As New Double
                                                        Dim diff As New Double
                                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                        dtRptCols1 = dvRptCols1.ToTable()
                                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                        dtRptCols2 = dvRptCols2.ToTable()

                                                        If strRFilt2 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        If UnitId = 1 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    Else
                                                                        If UnitId = 1 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If

                                                        If strRFilt2 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        If UnitId = 1 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    Else
                                                                        If UnitId = 1 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If

                                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                        If count1 <> 0 And count2 <> 0 Then
                                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                        Else
                                                            lbl.Text = FormatNumber(0, 4)
                                                        End If
                                                    End If
                                                    Td.Controls.Add(lbl)
                                                    Td.CssClass = "AlterNateColor2"
                                                    Td.Style.Add("color", "#660022")
                                                    Td.Style.Add("padding-right", "10px")
                                                    Td.Style.Add("text-align", "Right")
                                                End If
                                                Td.Font.Size = 9
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = True
                                                Tr.Controls.Add(Td)
                                            Next
                                            Tr.Height = 30

                                            If filterCnt = 2 Then
                                                tblCAGR.Controls.Add(Tr)
                                                For i = 1 To dsRows.Tables(0).Rows.Count
                                                    If strRFilt2 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt2 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND FCT<>0"
                                                    Else
                                                        dvRptAct.RowFilter = " COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        Tr = New TableRow
                                                        Tr.CssClass = "Bhavesh"
                                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Data" + i.ToString()
                                                        Tr.Style.Add("display", "none")
                                                        For j = 0 To ColCnt
                                                            If j = 0 Then
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("COUNTRYDES").ToString()
                                                                lbl.CssClass = "Label"
                                                                Td.Controls.Add(lbl)
                                                                Td.Style.Add("text-align", "Left")
                                                                Td.Style.Add("padding-left", "50px")
                                                                HeaderTdSetting(Td, "180px", "", "1")
                                                            Else
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                    Dim ProdCount As New Double
                                                                    If strRFilt2 <> "" Then
                                                                        dvRptAct.RowFilter = strRFilt2 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    Else
                                                                        dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    End If
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If
                                                                    lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                Else
                                                                    Dim count1 As New Double
                                                                    Dim count2 As New Double
                                                                    Dim diff As New Double
                                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                    dtRptCols2 = dvRptCols2.ToTable()

                                                                    If strRFilt2 <> "" Then
                                                                        dvRptAct.RowFilter = strRFilt2 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    Else
                                                                        dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    End If
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If

                                                                    If strRFilt2 <> "" Then
                                                                        dvRptAct.RowFilter = strRFilt2 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    Else
                                                                        dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    End If
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If

                                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                    If count1 <> 0 And count2 <> 0 Then
                                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                    Else
                                                                        lbl.Text = FormatNumber(0, 4)
                                                                    End If
                                                                End If
                                                                lbl.CssClass = "Label"
                                                                Td.Controls.Add(lbl)
                                                                Td.CssClass = "AlterNateColor2"
                                                                Td.Style.Add("text-align", "Right")
                                                                Td.Style.Add("padding-right", "10px")
                                                            End If
                                                            Td.Font.Size = 8.5
                                                            Td.Font.Name = "Verdana"
                                                            Td.Font.Bold = False
                                                            Tr.Controls.Add(Td)
                                                        Next
                                                        Tr.Height = 30
                                                        tblCAGR.Controls.Add(Tr)
                                                    End If

                                                Next
                                            Else
                                                If arrRfilt(2) <> "REGION" And arrRfilt(2) <> "GROUP" And arrRfilt(2) <> "COUNTRY" Then
                                                    dv3.RowFilter = strRFilt2
                                                End If
                                                dt3 = dv3.ToTable()
                                                If dt3.Rows.Count > 0 Then
                                                    tblCAGR.Controls.Add(Tr)
                                                    For c = 0 To dt3.Rows.Count - 1
                                                        strRFilt3 = ""
                                                        Tr = New TableRow
                                                        Tr = New TableRow
                                                        Tr.CssClass = "Bhavesh"
                                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                        Tr.Style.Add("display", "none")
                                                        If arrRfilt(2) = "PRODUCT" Then
                                                            strRFilt3 = strRFilt2 + " AND CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                        ElseIf arrRfilt(2) = "PACKAGE" Then
                                                            strRFilt3 = strRFilt2 + " AND PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                        ElseIf arrRfilt(2) = "MATERIAL" Then
                                                            strRFilt3 = strRFilt2 + " AND MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString()
                                                        ElseIf arrRfilt(2) = "GROUP" Then
                                                            strRFilt3 = strRFilt2 + " AND SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                        ElseIf arrRfilt(2) = "COMPONENT" Then
                                                            strRFilt3 = strRFilt2 + " AND COMPONENTID = " + dt3.Rows(c).Item("COMPONENTID").ToString()
                                                        End If
                                                        dvRpt.RowFilter = strRFilt3
                                                        dtRpt = dvRpt.ToTable()
                                                        If dtRpt.Rows.Count > 0 Then
                                                            For j = 0 To ColCnt
                                                                If j = 0 Then
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    imgUp = New ImageButton
                                                                    imgDn = New ImageButton
                                                                    imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                    imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','-');"
                                                                    imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                    imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','+');"
                                                                    imgUp.Style.Add("display", "none")
                                                                    lbl.Text = dt3.Rows(c).Item("VALUE").ToString()
                                                                    lbl.CssClass = "Label"
                                                                    imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                                    imgUp.Width = 20
                                                                    imgUp.Height = 12
                                                                    imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                                    imgDn.Width = 20
                                                                    imgDn.Height = 12
                                                                    Td.Controls.Add(imgUp)
                                                                    Td.Controls.Add(imgDn)
                                                                    Td.Controls.Add(lbl)
                                                                    Td.Style.Add("text-align", "Left")
                                                                    Td.Style.Add("padding-left", "50px")
                                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                                Else
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                        Dim ProdCount As New Double
                                                                        If strRFilt3 <> "" Then
                                                                            dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        Else
                                                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        End If
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                        If UnitId = 1 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    Else
                                                                                        If UnitId = 1 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If
                                                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                    Else
                                                                        Dim count1 As New Double
                                                                        Dim count2 As New Double
                                                                        Dim diff As New Double
                                                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                        dtRptCols1 = dvRptCols1.ToTable()
                                                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                        dtRptCols2 = dvRptCols2.ToTable()

                                                                        If strRFilt3 <> "" Then
                                                                            dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        Else
                                                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        End If
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                        If UnitId = 1 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    Else
                                                                                        If UnitId = 1 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If

                                                                        If strRFilt3 <> "" Then
                                                                            dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        Else
                                                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        End If
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                        If UnitId = 1 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    Else
                                                                                        If UnitId = 1 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If

                                                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                        If count1 <> 0 And count2 <> 0 Then
                                                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                        Else
                                                                            lbl.Text = FormatNumber(0, 4)
                                                                        End If
                                                                    End If
                                                                    Td.Controls.Add(lbl)
                                                                    Td.CssClass = "AlterNateColor2"
                                                                    Td.Style.Add("text-align", "Right")
                                                                    Td.Style.Add("padding-right", "10px")
                                                                End If
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Name = "Verdana"
                                                                Td.Font.Bold = True
                                                                Tr.Controls.Add(Td)
                                                            Next
                                                            Tr.Height = 30
                                                            tblCAGR.Controls.Add(Tr)

                                                            For i = 1 To dsRows.Tables(0).Rows.Count
                                                                If strRFilt3 <> "" Then
                                                                    dvRptAct.RowFilter = strRFilt3 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND FCT<>0"
                                                                Else
                                                                    dvRptAct.RowFilter = " COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    Tr = New TableRow
                                                                    Tr.CssClass = "Bhavesh"
                                                                    Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "_Data" + i.ToString()
                                                                    Tr.Style.Add("display", "none")
                                                                    For j = 0 To ColCnt
                                                                        If j = 0 Then
                                                                            Td = New TableCell()
                                                                            lbl = New Label
                                                                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("COUNTRYDES").ToString()
                                                                            lbl.CssClass = "Label"
                                                                            Td.Controls.Add(lbl)
                                                                            Td.Font.Size = 8.5
                                                                            Td.Font.Bold = True
                                                                            Td.Style.Add("text-align", "Left")
                                                                            Td.Style.Add("padding-left", "75px")
                                                                            HeaderTdSetting(Td, "180px", "", "1")
                                                                        Else
                                                                            Td = New TableCell()
                                                                            lbl = New Label
                                                                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                                Dim ProdCount As New Double
                                                                                If strRFilt3 <> "" Then
                                                                                    dvRptAct.RowFilter = strRFilt3 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                                Else
                                                                                    dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                                End If
                                                                                dtRptAct = dvRptAct.ToTable()
                                                                                If dtRptAct.Rows.Count > 0 Then
                                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                                If UnitId = 1 Then
                                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                ElseIf UnitId = 2 Then
                                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                ElseIf UnitId = 4 Then
                                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                Else
                                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                End If
                                                                                            Else
                                                                                                If UnitId = 1 Then
                                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                                ElseIf UnitId = 2 Then
                                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                                ElseIf UnitId = 3 Then
                                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                                ElseIf UnitId = 4 Then
                                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                Else
                                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                End If
                                                                                            End If
                                                                                        End If
                                                                                    Next
                                                                                End If
                                                                                lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                            Else
                                                                                Dim count1 As New Double
                                                                                Dim count2 As New Double
                                                                                Dim diff As New Double
                                                                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                                dtRptCols1 = dvRptCols1.ToTable()
                                                                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                                dtRptCols2 = dvRptCols2.ToTable()

                                                                                If strRFilt3 <> "" Then
                                                                                    dvRptAct.RowFilter = strRFilt3 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                                Else
                                                                                    dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                                End If
                                                                                dtRptAct = dvRptAct.ToTable()
                                                                                If dtRptAct.Rows.Count > 0 Then
                                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                                If UnitId = 1 Then
                                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                ElseIf UnitId = 2 Then
                                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                ElseIf UnitId = 4 Then
                                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                Else
                                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                End If
                                                                                            Else
                                                                                                If UnitId = 1 Then
                                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                                ElseIf UnitId = 2 Then
                                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                                ElseIf UnitId = 3 Then
                                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                                ElseIf UnitId = 4 Then
                                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                Else
                                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                End If
                                                                                            End If
                                                                                        End If
                                                                                    Next
                                                                                End If

                                                                                If strRFilt3 <> "" Then
                                                                                    dvRptAct.RowFilter = strRFilt3 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                                Else
                                                                                    dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                                End If
                                                                                dtRptAct = dvRptAct.ToTable()
                                                                                If dtRptAct.Rows.Count > 0 Then
                                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                                If UnitId = 1 Then
                                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                ElseIf UnitId = 2 Then
                                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                ElseIf UnitId = 4 Then
                                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                Else
                                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                End If
                                                                                            Else
                                                                                                If UnitId = 1 Then
                                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                                ElseIf UnitId = 2 Then
                                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                                ElseIf UnitId = 3 Then
                                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                                ElseIf UnitId = 4 Then
                                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                Else
                                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                                End If
                                                                                            End If
                                                                                        End If
                                                                                    Next
                                                                                End If

                                                                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                                If count1 <> 0 And count2 <> 0 Then
                                                                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                                Else
                                                                                    lbl.Text = FormatNumber(0, 4)
                                                                                End If
                                                                            End If
                                                                            lbl.CssClass = "Label"
                                                                            Td.Controls.Add(lbl)
                                                                            Td.CssClass = "AlterNateColor2"
                                                                            Td.Style.Add("text-align", "Right")
                                                                            Td.Style.Add("padding-right", "10px")
                                                                        End If
                                                                        Td.Font.Size = 8.5
                                                                        Td.Font.Name = "Verdana"
                                                                        Td.Font.Bold = False
                                                                        Tr.Controls.Add(Td)
                                                                    Next
                                                                    Tr.Height = 30
                                                                    tblCAGR.Controls.Add(Tr)
                                                                End If

                                                            Next
                                                        End If
                                                    Next
                                                End If
                                            End If
                                        End If
                                    Next
                                End If
                            End If
                        End If
                    Next

                    'Grand Total
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label
                            imgUp = New ImageButton
                            imgDn = New ImageButton
                            imgUp.ID = "Up_TotLayer"
                            imgUp.OnClientClick = "javascript:return ShowLines('TotLayer','-');"
                            imgDn.ID = "Dn_TotLayer"
                            imgDn.OnClientClick = "javascript:return ShowLines('TotLayer','+');"
                            imgUp.Style.Add("display", "none")
                            imgUp.ImageUrl = "~/Images/Minus.jpg"
                            imgUp.Width = 20
                            imgUp.Height = 12
                            imgDn.ImageUrl = "~/Images/Plus.jpg"
                            imgDn.Width = 20
                            imgDn.Height = 12
                            Td.Controls.Add(imgUp)
                            Td.Controls.Add(imgDn)
                            lbl.Text = "Grand Total" 'dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                            lbl.CssClass = "Label"
                            lbl.Width = 200
                            lbl.Style.Add("display", "inline")
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            lbl = New Label
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                Dim ProdCount As New Double
                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If
                                lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                            Else
                                Dim count1 As New Double
                                Dim count2 As New Double
                                Dim diff As New Double
                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                dtRptCols1 = dvRptCols1.ToTable()
                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                dtRptCols2 = dvRptCols2.ToTable()

                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If

                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If

                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                If count1 <> 0 And count2 <> 0 Then
                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                Else
                                    lbl.Text = FormatNumber(0, 4)
                                End If
                            End If
                            'Td.CssClass = "AlterNateColor2"
                            Td.Controls.Add(lbl)
                            Td.Font.Bold = True
                            Td.Style.Add("text-align", "Right")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-right", "10px")
                            HeaderTdSetting(Td, "130px", "", "1")
                        End If
                        Tr.Controls.Add(Td)
                    Next
                    tblCAGR.Controls.Add(Tr)

                    For i = 1 To dsRows.Tables(0).Rows.Count
                        dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND FCT<>0"
                        dtRptAct = dvRptAct.ToTable()
                        If dtRptAct.Rows.Count > 0 Then
                            Tr = New TableRow
                            Tr.CssClass = "Bhavesh"
                            Tr.ID = "TotLayer_Data" + i.ToString()
                            Tr.Style.Add("display", "none")
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("COUNTRYDES").ToString()
                                    lbl.CssClass = "Label"
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Style.Add("padding-left", "25px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()

                                        dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        If count1 <> 0 And count2 <> 0 Then
                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        Else
                                            lbl.Text = FormatNumber(0, 4)
                                        End If
                                    End If
                                    lbl.CssClass = "Label"
                                    Td.Controls.Add(lbl)
                                    Td.CssClass = "AlterNateColor2"
                                    Td.Style.Add("text-align", "Right")
                                    Td.Style.Add("padding-right", "10px")
                                End If
                                Td.Font.Size = 8.5
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = False
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            tblCAGR.Controls.Add(Tr)
                        End If

                    Next
                Else
                    For i = 1 To dsRows.Tables(0).Rows.Count
                        Tr = New TableRow
                        For j = 0 To ColCnt
                            If j = 0 Then
                                Td = New TableCell()
                                lbl = New Label

                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("COUNTRYDES").ToString()
                                lbl.CssClass = "Label"
                                Td.Controls.Add(lbl)
                                Td.Style.Add("text-align", "Left")
                                Td.Style.Add("padding-left", "5px")
                                HeaderTdSetting(Td, "180px", "", "1")
                            Else
                                Td = New TableCell()
                                Td.Text = "&nbsp;"
                                HeaderTdSetting(Td, "150px", "", "1")
                                Td.CssClass = "AlterNateColor2"
                            End If
                            Td.Font.Size = 8.5
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = False
                            Tr.Controls.Add(Td)
                        Next
                        Tr.Height = 30
                        tblCAGR.Controls.Add(Tr)
                    Next
                End If
            Else
                'RowCnt = objGetData.GetReportRegionCount(ddlRegionSet.SelectedValue)
                dsRows = objGetData.GetUsersDynamicReportRows(REPId.ToString())
                For i = 1 To dsRows.Tables(0).Rows.Count
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label

                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("ROWDECRIPTION").ToString()
                            lbl.CssClass = "Label"
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            Td.Text = "&nbsp;"
                            HeaderTdSetting(Td, "150px", "", "1")
                            Td.CssClass = "AlterNateColor2"
                        End If
                        Td.Font.Size = 8.5
                        Td.Font.Name = "Verdana"
                        Td.Font.Bold = False
                        Tr.Controls.Add(Td)
                    Next
                    Tr.Height = 30
                    tblCAGR.Controls.Add(Tr)
                Next
            End If

        Catch ex As Exception
            ErrorLable.Text = "Error:SetPivotReportFrameWorkTemp " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub SetPivotMatReportFrameWorkTemp(ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Dim YearId As String = ""
        Dim UnitId As String = ""
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsUnitPref As New DataSet
        Dim dsRep As New DataSet
        Dim RowCnt As New Integer
        Dim ColCnt As New Integer
        Dim filterCnt As New Integer
        Dim GrpId As String = ""
        Dim dsGrp As New DataSet
        Dim imgUp As New ImageButton
        Dim imgDn As New ImageButton
        Try
            If hidReport.Value <> "0" Then
                dsRep = Session("dsRep" + REPId.ToString())
                dsUnitPref = Session("dsPref" + REPId.ToString())
                dsRows = Session("dsRows" + REPId.ToString())
                dsCol = Session("dsColumns" + REPId.ToString())
                dsFilter = Session("dsFilters" + REPId.ToString())
            Else
                dsRep = objGetData.GetReportDetails(REPId.ToString())
                dsUnitPref = objGetData.GetPref(REPId.ToString())
                dsRows = objGetData.GetUsersDynamicReportRows(REPId.ToString())
                dsCol = objGetData.GetUsersDynamicReportCols(REPId.ToString())
                dsFilter = objGetData.GetUsersReportFilters(REPId.ToString())

                Session("dsRep" + REPId.ToString()) = dsRep
                Session("dsPref" + REPId.ToString()) = dsUnitPref
                Session("dsRows" + REPId.ToString()) = dsRows
                Session("dsColumns" + REPId.ToString()) = dsCol
                Session("dsFilters" + REPId.ToString()) = dsFilter

                hidReport.Value = "1"
            End If

            filterCnt = dsFilter.Tables(0).Rows.Count
            ColCnt = dsCol.Tables(0).Rows.Count

            For a = 0 To dsCol.Tables(0).Rows.Count - 1
                If dsCol.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    YearId = YearId + "" + dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
                End If
            Next
            YearId = YearId.Remove(YearId.Length - 1)
            UnitId = dsRows.Tables(0).Rows(0).Item("UNITID").ToString()

            dvCol = dsCol.Tables(0).DefaultView
            dvRptCols1 = dsCol.Tables(0).DefaultView
            dvRptCols2 = dsCol.Tables(0).DefaultView

            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()
                        Link.CssClass = "LinkM"
                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdSetting(HeaderTd, "150px", "", "1")
                    Next
                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink
                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)
            Next

            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            Dim dsTables As New DataSet
            Dim dvTables As New DataView
            Dim dtTables As New DataTable
            Dim ProdId As String = ""
            'Dim ProdTbl(11) As String
            Dim PackId As String = ""
            Dim dsProd As New DataSet
            Dim dvProd As New DataView
            Dim dtProd As New DataTable
            Dim dsPack As New DataSet
            Dim dvPack As New DataView
            Dim dtPack As New DataTable
            Dim dsOrder As New DataSet()
            Dim funflag As Boolean = False
            Dim MatId As String = ""
            Dim FactId As String = ""
            Dim dsMat As New DataSet
            Dim dsProdMat As New DataSet
            Dim arrRfilt(filterCnt) As String
            Dim CountryId As String = ""
            Dim RegionId As String = ""

            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            Dim ProdTbl(dsTables.Tables(0).Rows.Count - 1) As String

            For a = 0 To dsFilter.Tables(0).Rows.Count - 1
                If dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                    arrRfilt(a) = "PRODUCT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                            ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            RowCnt += 1
                        Next
                        dtTables = dsTables.Tables(0)
                        ProdId = ProdId.Remove(ProdId.Length - 1)
                        If PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)

                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                        ProdId = ""
                        For b = 0 To dsProd.Tables(0).Rows.Count - 1
                            ProdId = ProdId + "" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + ","
                        Next
                        ProdId = ProdId.Remove(ProdId.Length - 1)

                    Else
                        ProdId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                        dtTables = dvTables.ToTable()
                        ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                        RowCnt += 1
                        If PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)
                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                    End If

                    dsProd.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsProd.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsProd.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                    arrRfilt(a) = "PACKAGE"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, "")
                        Else
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                                ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                                RowCnt += 1
                            Next
                            dtTables = dsTables.Tables(0)
                            ProdId = ProdId.Remove(ProdId.Length - 1)
                            dsPack = objGetData.GetPackages(ProdId)
                        End If
                        For b = 0 To dsPack.Tables(0).Rows.Count - 1
                            PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("PACKAGETYPEID").ToString() + ","
                        Next
                        PackId = PackId.Remove(PackId.Length - 1)
                    Else
                        PackId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, PackId)

                        Else
                            dsPack = objGetData.GetPivotPackages(PackId)
                        End If
                    End If

                    dsPack.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsPack.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsPack.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COUNTRY" Then
                    arrRfilt(a) = "COUNTRY"
                    CountryId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotCountriesByRegion(CountryId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "REGION" Then
                    arrRfilt(a) = "REGION"
                    RegionId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotRegion(RegionId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "GROUP" Then
                    arrRfilt(a) = "GROUP"
                    GrpId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsGrp = objGetData.GetPivotGroups(GrpId)
                    dsGrp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsGrp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsGrp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                End If
            Next

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                Else
                                    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                                End If
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        End If
                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next

            Dim dv1 As New DataView
            Dim dv2 As New DataView
            Dim dv3 As New DataView
            Dim dt1 As New DataTable
            Dim dt2 As New DataTable
            Dim dt3 As New DataTable
            Dim dsRptAct As New DataSet
            Dim dvRptAct As New DataView
            Dim dtRptAct As New DataTable
            Dim strRFilt As String = ""

            If ProdTbl(0) = "" Then
                For b = 0 To dsTables.Tables(0).Rows.Count - 1
                    ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                    RowCnt += 1
                Next
            End If

            Dim dvRpt As New DataView
            Dim dtRpt As New DataTable

            If funflag Then
                If filterCnt = 1 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                ElseIf filterCnt = 2 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                ElseIf filterCnt = 3 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                    dv3 = dsOrder.Tables(2).DefaultView
                End If
                dsRows = objGetData.GetPivotMaterials(ProdId, PackId)
                dsRptAct = objGetData.GetPivotReportData_MAT(ProdTbl, YearId, ProdId, PackId, GrpId, CountryId, RegionId, UnitId, dsTables.Tables(0).Rows.Count)
                dvRptAct = dsRptAct.Tables(0).DefaultView
                dvRpt = dsRptAct.Tables(0).DefaultView
                Dim strRFilt1 As String = ""
                Dim strRFilt2 As String = ""
                Dim strRFilt3 As String = ""
                If dsOrder.Tables(0).Rows.Count <> 0 Then
                    For a = 0 To dsOrder.Tables(0).Rows.Count - 1
                        strRFilt1 = ""
                        If arrRfilt(0) = "PRODUCT" Then
                            strRFilt1 = "CATEGORYID = " + dsOrder.Tables(0).Rows(a).Item("CATEGORYID").ToString()
                        ElseIf arrRfilt(0) = "PACKAGE" Then
                            strRFilt1 = "PACKAGETYPEID = " + dsOrder.Tables(0).Rows(a).Item("PACKAGETYPEID").ToString()
                        ElseIf arrRfilt(0) = "GROUP" Then
                            strRFilt1 = "SUBGROUPID = " + dsOrder.Tables(0).Rows(a).Item("SUBGROUPID").ToString()
                        ElseIf arrRfilt(0) = "COUNTRY" Then
                            'strRFilt1 = "COUNTRYID = " + dsOrder.Tables(0).Rows(a).Item("COUNTRYID").ToString()
                        ElseIf arrRfilt(0) = "REGION" Then
                            'dvRpt.RowFilter = "REGIONID = " + dsOrder.Tables(0).Rows(a).Item("REGIONID").ToString()
                        End If
                        dvRpt.RowFilter = strRFilt1
                        dtRpt = dvRpt.ToTable()
                        If dtRpt.Rows.Count > 0 Then
                            Tr = New TableRow
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    imgUp = New ImageButton
                                    imgDn = New ImageButton
                                    imgUp.ID = "Up_Layer" + (a + 1).ToString()
                                    imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','-');"
                                    imgDn.ID = "Dn_Layer" + (a + 1).ToString()
                                    imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','+');"
                                    imgUp.Style.Add("display", "none")
                                    lbl = New Label
                                    lbl.Text = dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    imgUp.ImageUrl = "~/Images/Minus.jpg"
                                    imgUp.Width = 20
                                    imgUp.Height = 12
                                    imgDn.ImageUrl = "~/Images/Plus.jpg"
                                    imgDn.Width = 20
                                    imgDn.Height = 12
                                    Td.Controls.Add(imgUp)
                                    Td.Controls.Add(imgDn)
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-left", "5px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                Else
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        lbl.Text = FormatNumber(ProdCount, 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                Else
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                Else
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                    End If
                                    Td.Controls.Add(lbl)
                                    'Td.CssClass = "AlterNateColor2"
                                    Td.Font.Bold = True
                                    Td.Style.Add("text-align", "Right")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-right", "10px")
                                    HeaderTdSetting(Td, "130px", "", "1")
                                End If
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            'Tr.CssClass = "header"

                            If filterCnt = 1 Then
                                tblCAGR.Controls.Add(Tr)
                                strRFilt = ""
                                For i = 1 To dsRows.Tables(0).Rows.Count
                                    If strRFilt1 = "" Then
                                        dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString()
                                    Else
                                        dvRptAct.RowFilter = strRFilt1 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString()
                                    End If
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Data" + i.ToString()
                                        Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Font.Size = 9
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = True
                                                Td.Style.Add("padding-left", "25px")
                                                HeaderTdSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt1 = "" Then
                                                        dvRptAct.RowFilter = "MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = strRFilt1 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            Else
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If
                                                    lbl.Text = FormatNumber(ProdCount, 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                    dtRptCols2 = dvRptCols2.ToTable()
                                                    If strRFilt1 = "" Then
                                                        dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = strRFilt1 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            Else
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If

                                                    If strRFilt1 = "" Then
                                                        dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = strRFilt1 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            Else
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If
                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                End If
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.CssClass = "AlterNateColor2"
                                                Td.Style.Add("text-align", "Right")
                                                Td.Style.Add("padding-right", "10px")
                                            End If
                                            Td.Font.Size = 8
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = False
                                            Tr.Controls.Add(Td)
                                        Next
                                        Tr.Height = 30
                                        tblCAGR.Controls.Add(Tr)
                                    End If
                                Next
                            Else
                                If arrRfilt(1) <> "REGION" And arrRfilt(1) <> "COUNTRY" And arrRfilt(1) <> "GROUP" Then
                                    dv2.RowFilter = strRFilt1
                                End If
                                dt2 = dv2.ToTable()
                                If dt2.Rows.Count > 0 Then
                                    tblCAGR.Controls.Add(Tr)
                                    For b = 0 To dt2.Rows.Count - 1
                                        strRFilt2 = ""
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                        Tr.Style.Add("display", "none")
                                        If arrRfilt(1) = "PRODUCT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            Else
                                                strRFilt2 = "CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "PACKAGE" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            Else
                                                strRFilt2 = "PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "GROUP" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            Else
                                                strRFilt2 = "SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "COUNTRY" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1
                                            End If
                                        ElseIf arrRfilt(1) = "REGION" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1
                                            End If
                                        End If
                                        dvRpt.RowFilter = strRFilt2
                                        dtRpt = dvRpt.ToTable()
                                        If dtRpt.Rows.Count > 0 Then
                                            For j = 0 To ColCnt
                                                If j = 0 Then
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    imgUp = New ImageButton
                                                    imgDn = New ImageButton
                                                    imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','-');"
                                                    imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','+');"
                                                    imgUp.Style.Add("display", "none")
                                                    lbl.Text = dt2.Rows(b).Item("VALUE").ToString()
                                                    lbl.CssClass = "Label"
                                                    imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                    imgUp.Width = 20
                                                    imgUp.Height = 12
                                                    imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                    imgDn.Width = 20
                                                    imgDn.Height = 12
                                                    Td.Controls.Add(imgUp)
                                                    Td.Controls.Add(imgDn)
                                                    Td.Controls.Add(lbl)
                                                    Td.Font.Size = 9
                                                    Td.Font.Bold = True
                                                    Td.Style.Add("text-align", "Left")
                                                    Td.Style.Add("padding-left", "25px")
                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                Else
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                        Dim ProdCount As New Double
                                                        dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        If UnitId = 1 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                Else
                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        If UnitId = 1 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If
                                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                    Else
                                                        Dim count1 As New Double
                                                        Dim count2 As New Double
                                                        Dim diff As New Double
                                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                        dtRptCols1 = dvRptCols1.ToTable()
                                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                        dtRptCols2 = dvRptCols2.ToTable()

                                                        dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        If UnitId = 1 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                Else
                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        If UnitId = 1 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If

                                                        dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        If UnitId = 1 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                Else
                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        If UnitId = 1 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If
                                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                    End If
                                                    Td.Controls.Add(lbl)
                                                    Td.CssClass = "AlterNateColor2"
                                                    Td.Style.Add("color", "#660022")
                                                    Td.Style.Add("padding-right", "10px")
                                                    Td.Style.Add("text-align", "Right")
                                                End If
                                                Td.Font.Size = 9
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = True
                                                Tr.Controls.Add(Td)
                                            Next
                                            Tr.Height = 30
                                            tblCAGR.Controls.Add(Tr)
                                        End If

                                        If filterCnt = 2 Then
                                            For i = 1 To dsRows.Tables(0).Rows.Count
                                                If strRFilt2 <> "" Then
                                                    dvRptAct.RowFilter = strRFilt2 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString()
                                                Else
                                                    dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString()
                                                End If
                                                dtRptAct = dvRptAct.ToTable()
                                                If dtRptAct.Rows.Count > 0 Then
                                                    Tr = New TableRow
                                                    Tr.CssClass = "Bhavesh"
                                                    Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Data" + i.ToString()
                                                    Tr.Style.Add("display", "none")
                                                    For j = 0 To ColCnt
                                                        If j = 0 Then
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.Style.Add("text-align", "Left")
                                                            Td.Style.Add("padding-left", "50px")
                                                            HeaderTdSetting(Td, "180px", "", "1")
                                                        Else
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                Dim ProdCount As New Double
                                                                If strRFilt2 = "" Then
                                                                    dvRptAct.RowFilter = "MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                Else
                                                                    dvRptAct.RowFilter = strRFilt2 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If UnitId = 1 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        Else
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If UnitId = 1 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                ElseIf UnitId = 3 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        End If
                                                                    Next
                                                                End If
                                                                lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                            Else
                                                                Dim count1 As New Double
                                                                Dim count2 As New Double
                                                                Dim diff As New Double
                                                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                dtRptCols1 = dvRptCols1.ToTable()
                                                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                dtRptCols2 = dvRptCols2.ToTable()
                                                                If strRFilt2 = "" Then
                                                                    dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                Else
                                                                    dvRptAct.RowFilter = strRFilt2 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If UnitId = 1 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        Else
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If UnitId = 1 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                ElseIf UnitId = 3 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        End If
                                                                    Next
                                                                End If

                                                                If strRFilt2 = "" Then
                                                                    dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                Else
                                                                    dvRptAct.RowFilter = strRFilt2 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If UnitId = 1 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        Else
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If UnitId = 1 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                ElseIf UnitId = 3 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        End If
                                                                    Next
                                                                End If
                                                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                            End If
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.CssClass = "AlterNateColor2"
                                                            Td.Style.Add("text-align", "Right")
                                                            Td.Style.Add("padding-right", "10px")
                                                        End If
                                                        Td.Font.Size = 8.5
                                                        Td.Font.Name = "Verdana"
                                                        Td.Font.Bold = False
                                                        Tr.Controls.Add(Td)
                                                    Next
                                                    Tr.Height = 30
                                                    tblCAGR.Controls.Add(Tr)
                                                End If
                                            Next
                                        Else
                                            If arrRfilt(2) <> "REGION" And arrRfilt(2) <> "COUNTRY" And arrRfilt(2) <> "GROUP" Then
                                                dv3.RowFilter = strRFilt2
                                            End If
                                            dt3 = dv3.ToTable()
                                            If dt3.Rows.Count > 0 Then
                                                For c = 0 To dt3.Rows.Count - 1
                                                    Tr = New TableRow()
                                                    Tr.CssClass = "Bhavesh"
                                                    Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                    Tr.Style.Add("display", "none")
                                                    strRFilt3 = ""
                                                    If arrRfilt(2) = "PRODUCT" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("CATEGORYID").ToString()
                                                        Else
                                                            strRFilt3 = strRFilt + "CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "PACKAGE" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "GROUP" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "COUNTRY" Then
                                                        strRFilt3 = strRFilt2
                                                    ElseIf arrRfilt(2) = "REGION" Then
                                                        strRFilt3 = strRFilt2
                                                    End If
                                                    dvRpt.RowFilter = strRFilt3
                                                    dtRpt = dvRpt.ToTable()
                                                    Dim Tot3 As New Double
                                                    If dtRpt.Rows.Count > 0 Then
                                                        For j = 0 To ColCnt
                                                            If j = 0 Then
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                imgUp = New ImageButton
                                                                imgDn = New ImageButton
                                                                imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','-');"
                                                                imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','+');"
                                                                imgUp.Style.Add("display", "none")
                                                                lbl.Text = dt3.Rows(c).Item("VALUE").ToString()
                                                                lbl.CssClass = "Label"
                                                                imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                                imgUp.Width = 20
                                                                imgUp.Height = 12
                                                                imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                                imgDn.Width = 20
                                                                imgDn.Height = 12
                                                                Td.Controls.Add(imgUp)
                                                                Td.Controls.Add(imgDn)
                                                                Td.Controls.Add(lbl)
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Bold = True
                                                                Td.Style.Add("text-align", "Left")
                                                                Td.Style.Add("padding-left", "50px")
                                                                HeaderTdSetting(Td, "180px", "", "1")
                                                            Else
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                'HeaderTdSetting(Td, "150px", "", "1")
                                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                    Dim ProdCount As New Double
                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If UnitId = 1 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            Else
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If UnitId = 1 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If
                                                                    lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                Else
                                                                    Dim count1 As New Double
                                                                    Dim count2 As New Double
                                                                    Dim diff As New Double
                                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                    dtRptCols2 = dvRptCols2.ToTable()

                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If UnitId = 1 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            Else
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If UnitId = 1 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If

                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If UnitId = 1 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            Else
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If UnitId = 1 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If
                                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                End If
                                                                Td.Controls.Add(lbl)
                                                                Td.CssClass = "AlterNateColor2"
                                                                Td.Style.Add("text-align", "Right")
                                                                Td.Style.Add("padding-right", "10px")
                                                            End If
                                                            Td.Font.Size = 8.5
                                                            Td.Font.Name = "Verdana"
                                                            Td.Font.Bold = True
                                                            Tr.Controls.Add(Td)
                                                        Next
                                                        Tr.Height = 30
                                                        tblCAGR.Controls.Add(Tr)
                                                    End If
                                                    For i = 1 To dsRows.Tables(0).Rows.Count
                                                        If strRFilt3 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt3 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            Tr = New TableRow
                                                            Tr.CssClass = "Bhavesh"
                                                            Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "_Data" + i.ToString()
                                                            Tr.Style.Add("display", "none")
                                                            Dim bFlag = False
                                                            For j = 0 To ColCnt
                                                                If j = 0 Then
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.Style.Add("text-align", "Left")
                                                                    Td.Style.Add("padding-left", "75px")
                                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                                Else
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                        Dim ProdCount As New Double
                                                                        dvRptAct.RowFilter = strRFilt3 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If UnitId = 1 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                Else
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If UnitId = 1 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If
                                                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                    Else
                                                                        Dim count1 As New Double
                                                                        Dim count2 As New Double
                                                                        Dim diff As New Double
                                                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                        dtRptCols1 = dvRptCols1.ToTable()
                                                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                        dtRptCols2 = dvRptCols2.ToTable()

                                                                        dvRptAct.RowFilter = strRFilt3 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If UnitId = 1 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                Else
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If UnitId = 1 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If

                                                                        dvRptAct.RowFilter = strRFilt3 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If UnitId = 1 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                Else
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If UnitId = 1 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If
                                                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                    End If
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.CssClass = "AlterNateColor2"
                                                                    Td.Style.Add("text-align", "Right")
                                                                    Td.Style.Add("padding-right", "10px")

                                                                    'If lbl.Text <> "0" Then
                                                                    '    bFlag = True
                                                                    'End If
                                                                End If
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Name = "Verdana"
                                                                Td.Font.Bold = False
                                                                Tr.Controls.Add(Td)
                                                            Next
                                                            Tr.Height = 30
                                                            'tblCAGR.Controls.Add(Tr)
                                                            'If bFlag = True Then
                                                            tblCAGR.Controls.Add(Tr)
                                                            ' End If
                                                        End If

                                                    Next
                                                Next
                                            End If
                                        End If
                                    Next
                                End If
                            End If
                        End If
                    Next

                    'Grand Total
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label
                            imgUp = New ImageButton
                            imgDn = New ImageButton
                            imgUp.ID = "Up_TotLayer"
                            imgUp.OnClientClick = "javascript:return ShowLines('TotLayer','-');"
                            imgDn.ID = "Dn_TotLayer"
                            imgDn.OnClientClick = "javascript:return ShowLines('TotLayer','+');"
                            imgUp.Style.Add("display", "none")
                            imgUp.ImageUrl = "~/Images/Minus.jpg"
                            imgUp.Width = 20
                            imgUp.Height = 12
                            imgDn.ImageUrl = "~/Images/Plus.jpg"
                            imgDn.Width = 20
                            imgDn.Height = 12
                            Td.Controls.Add(imgUp)
                            Td.Controls.Add(imgDn)
                            lbl.Text = "Grand Total" 'dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                            lbl.CssClass = "Label"
                            lbl.Width = 200
                            lbl.Style.Add("display", "inline")
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            lbl = New Label
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                Dim ProdCount As New Double
                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If
                                lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                            Else
                                Dim count1 As New Double
                                Dim count2 As New Double
                                Dim diff As New Double
                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                dtRptCols1 = dvRptCols1.ToTable()
                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                dtRptCols2 = dvRptCols2.ToTable()

                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If

                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If

                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                If count1 <> 0 And count2 <> 0 Then
                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                Else
                                    lbl.Text = FormatNumber(0, 4)
                                End If
                            End If
                            'Td.CssClass = "AlterNateColor2"
                            Td.Controls.Add(lbl)
                            Td.Font.Bold = True
                            Td.Style.Add("text-align", "Right")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-right", "10px")
                            HeaderTdSetting(Td, "130px", "", "1")
                        End If
                        Tr.Controls.Add(Td)
                    Next
                    tblCAGR.Controls.Add(Tr)

                    For i = 1 To dsRows.Tables(0).Rows.Count
                        dvRptAct.RowFilter = "MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString()
                        dtRptAct = dvRptAct.ToTable()
                        If dtRptAct.Rows.Count > 0 Then
                            Tr = New TableRow
                            Tr.CssClass = "Bhavesh"
                            Tr.ID = "TotLayer_Data" + i.ToString()
                            Tr.Style.Add("display", "none")
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-left", "25px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        dvRptAct.RowFilter = "MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                Else
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        lbl.Text = FormatNumber(ProdCount, 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()
                                        dvRptAct.RowFilter = "MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                Else
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        dvRptAct.RowFilter = "MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                Else
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                    End If
                                    lbl.CssClass = "Label"
                                    Td.Controls.Add(lbl)
                                    Td.CssClass = "AlterNateColor2"
                                    Td.Style.Add("text-align", "Right")
                                    Td.Style.Add("padding-right", "10px")
                                End If
                                Td.Font.Size = 8
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = False
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            tblCAGR.Controls.Add(Tr)
                        End If
                    Next
                Else
                    For i = 1 To dsRows.Tables(0).Rows.Count
                        Tr = New TableRow
                        For j = 0 To ColCnt
                            If j = 0 Then
                                Td = New TableCell()
                                lbl = New Label
                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                lbl.CssClass = "Label"
                                Td.Controls.Add(lbl)
                                Td.Style.Add("text-align", "Left")
                                Td.Style.Add("padding-left", "5px")
                                HeaderTdSetting(Td, "180px", "", "1")
                            Else
                                Td = New TableCell()
                                Td.Text = "&nbsp;"
                                HeaderTdSetting(Td, "150px", "", "1")
                                Td.CssClass = "AlterNateColor2"
                            End If
                            Td.Font.Size = 8.5
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = False
                            Tr.Controls.Add(Td)
                        Next
                        Tr.Height = 30
                        tblCAGR.Controls.Add(Tr)
                    Next
                End If
            Else
                'RowCnt = objGetData.GetReportRegionCount(ddlRegionSet.SelectedValue)
                dsRows = objGetData.GetUsersDynamicReportRows(REPId.ToString())
                For i = 1 To dsRows.Tables(0).Rows.Count
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label

                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("ROWDECRIPTION").ToString()
                            lbl.CssClass = "Label"
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            Td.Text = "&nbsp;"
                            HeaderTdSetting(Td, "150px", "", "1")
                            Td.CssClass = "AlterNateColor2"
                        End If
                        Td.Font.Size = 8.5
                        Td.Font.Name = "Verdana"
                        Td.Font.Bold = False
                        Tr.Controls.Add(Td)
                    Next
                    Tr.Height = 30
                    tblCAGR.Controls.Add(Tr)
                Next
            End If

        Catch ex As Exception
            ErrorLable.Text = "Error:SetPivotMatReportFrameWorkTemp " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub SetPivotCompReportFrameWorkTemp(ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Dim YearId As String = ""
        Dim UnitId As String = ""
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsUnitPref As New DataSet
        Dim dsRep As New DataSet
        Dim RowCnt As New Integer
        Dim ColCnt As New Integer
        Dim filterCnt As New Integer
        Dim GrpId As String = ""
        Dim dsGrp As New DataSet
        Dim imgUp As New ImageButton
        Dim imgDn As New ImageButton
        Try
            If hidReport.Value <> "0" Then
                dsRep = Session("dsRep" + REPId.ToString())
                dsUnitPref = Session("dsPref" + REPId.ToString())
                dsRows = Session("dsRows" + REPId.ToString())
                dsCol = Session("dsColumns" + REPId.ToString())
                dsFilter = Session("dsFilters" + REPId.ToString())
            Else
                dsRep = objGetData.GetReportDetails(REPId.ToString())
                dsUnitPref = objGetData.GetPref(REPId.ToString())
                dsRows = objGetData.GetUsersDynamicReportRows(REPId.ToString())
                dsCol = objGetData.GetUsersDynamicReportCols(REPId.ToString())
                dsFilter = objGetData.GetUsersReportFilters(REPId.ToString())

                Session("dsRep" + REPId.ToString()) = dsRep
                Session("dsPref" + REPId.ToString()) = dsUnitPref
                Session("dsRows" + REPId.ToString()) = dsRows
                Session("dsColumns" + REPId.ToString()) = dsCol
                Session("dsFilters" + REPId.ToString()) = dsFilter

                hidReport.Value = "1"
            End If

            filterCnt = dsFilter.Tables(0).Rows.Count
            ColCnt = dsCol.Tables(0).Rows.Count

            For a = 0 To dsCol.Tables(0).Rows.Count - 1
                If dsCol.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    YearId = YearId + "" + dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
                End If
            Next
            YearId = YearId.Remove(YearId.Length - 1)
            UnitId = dsRows.Tables(0).Rows(0).Item("UNITID").ToString()

            dvCol = dsCol.Tables(0).DefaultView
            dvRptCols1 = dsCol.Tables(0).DefaultView
            dvRptCols2 = dsCol.Tables(0).DefaultView

            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()
                        Link.CssClass = "LinkM"
                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdSetting(HeaderTd, "150px", "", "1")
                    Next
                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink
                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)
            Next

            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            Dim dsTables As New DataSet
            Dim dvTables As New DataView
            Dim dtTables As New DataTable
            Dim ProdId As String = ""
            'Dim ProdTbl(11) As String
            Dim PackId As String = ""
            Dim dsProd As New DataSet
            Dim dvProd As New DataView
            Dim dtProd As New DataTable
            Dim dsPack As New DataSet
            Dim dvPack As New DataView
            Dim dtPack As New DataTable
            Dim dsOrder As New DataSet()
            Dim funflag As Boolean = False
            Dim MatId As String = ""
            Dim FactId As String = ""
            Dim dsMat As New DataSet
            Dim dsProdMat As New DataSet
            Dim arrRfilt(filterCnt) As String
            Dim CountryId As String = ""
            Dim RegionId As String = ""

            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            Dim ProdTbl(dsTables.Tables(0).Rows.Count - 1) As String

            For a = 0 To dsFilter.Tables(0).Rows.Count - 1
                If dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                    arrRfilt(a) = "PRODUCT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                            ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            RowCnt += 1
                        Next
                        dtTables = dsTables.Tables(0)
                        ProdId = ProdId.Remove(ProdId.Length - 1)
                        If PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)

                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                        ProdId = ""
                        For b = 0 To dsProd.Tables(0).Rows.Count - 1
                            ProdId = ProdId + "" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + ","
                        Next
                        ProdId = ProdId.Remove(ProdId.Length - 1)

                    Else
                        ProdId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                        dtTables = dvTables.ToTable()
                        ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                        RowCnt += 1
                        If PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)
                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                    End If

                    dsProd.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsProd.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsProd.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                    arrRfilt(a) = "PACKAGE"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, "")
                        Else
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                                ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                                RowCnt += 1
                            Next
                            dtTables = dsTables.Tables(0)
                            ProdId = ProdId.Remove(ProdId.Length - 1)
                            dsPack = objGetData.GetPackages(ProdId)
                        End If
                        For b = 0 To dsPack.Tables(0).Rows.Count - 1
                            PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("PACKAGETYPEID").ToString() + ","
                        Next
                        PackId = PackId.Remove(PackId.Length - 1)
                    Else
                        PackId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, PackId)

                        Else
                            dsPack = objGetData.GetPivotPackages(PackId)
                        End If
                    End If

                    dsPack.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsPack.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsPack.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COUNTRY" Then
                    arrRfilt(a) = "COUNTRY"
                    CountryId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotCountriesByRegion(CountryId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "REGION" Then
                    arrRfilt(a) = "REGION"
                    RegionId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotRegion(RegionId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "GROUP" Then
                    arrRfilt(a) = "GROUP"
                    GrpId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsGrp = objGetData.GetPivotGroups(GrpId)
                    dsGrp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsGrp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsGrp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                End If
            Next

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                Else
                                    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                                End If
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        End If
                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next

            Dim dv1 As New DataView
            Dim dv2 As New DataView
            Dim dv3 As New DataView
            Dim dt1 As New DataTable
            Dim dt2 As New DataTable
            Dim dt3 As New DataTable
            Dim dsRptAct As New DataSet
            Dim dvRptAct As New DataView
            Dim dtRptAct As New DataTable
            Dim strRFilt As String = ""

            If ProdTbl(0) = "" Then
                For b = 0 To dsTables.Tables(0).Rows.Count - 1
                    ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                    RowCnt += 1
                Next
            End If

            Dim dvRpt As New DataView
            Dim dtRpt As New DataTable

            If funflag Then
                If filterCnt = 1 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                ElseIf filterCnt = 2 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                ElseIf filterCnt = 3 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                    dv3 = dsOrder.Tables(2).DefaultView
                End If
                dsRows = objGetData.GetPivotComponents(ProdId, PackId)
                dsRptAct = objGetData.GetPivotReportData_COMP(ProdTbl, YearId, ProdId, PackId, GrpId, CountryId, RegionId, UnitId, dsTables.Tables(0).Rows.Count)
                dvRptAct = dsRptAct.Tables(0).DefaultView
                dvRpt = dsRptAct.Tables(0).DefaultView
                Dim strRFilt1 As String = ""
                Dim strRFilt2 As String = ""
                Dim strRFilt3 As String = ""
                If dsOrder.Tables(0).Rows.Count <> 0 Then
                    For a = 0 To dsOrder.Tables(0).Rows.Count - 1
                        strRFilt1 = ""
                        If arrRfilt(0) = "PRODUCT" Then
                            strRFilt1 = "CATEGORYID = " + dsOrder.Tables(0).Rows(a).Item("CATEGORYID").ToString()
                        ElseIf arrRfilt(0) = "PACKAGE" Then
                            strRFilt1 = "PACKAGETYPEID = " + dsOrder.Tables(0).Rows(a).Item("PACKAGETYPEID").ToString()
                        ElseIf arrRfilt(0) = "GROUP" Then
                            strRFilt1 = "SUBGROUPID = " + dsOrder.Tables(0).Rows(a).Item("SUBGROUPID").ToString()
                        ElseIf arrRfilt(0) = "COUNTRY" Then
                            'strRFilt1 = "COUNTRYID = " + dsOrder.Tables(0).Rows(a).Item("COUNTRYID").ToString()
                        ElseIf arrRfilt(0) = "REGION" Then
                            'dvRpt.RowFilter = "REGIONID = " + dsOrder.Tables(0).Rows(a).Item("REGIONID").ToString()
                        End If
                        dvRpt.RowFilter = strRFilt1
                        dtRpt = dvRpt.ToTable()
                        If dtRpt.Rows.Count > 0 Then
                            Tr = New TableRow
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    imgUp = New ImageButton
                                    imgDn = New ImageButton
                                    imgUp.ID = "Up_Layer" + (a + 1).ToString()
                                    imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','-');"
                                    imgDn.ID = "Dn_Layer" + (a + 1).ToString()
                                    imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','+');"
                                    imgUp.Style.Add("display", "none")
                                    lbl = New Label
                                    lbl.Text = dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    imgUp.ImageUrl = "~/Images/Minus.jpg"
                                    imgUp.Width = 20
                                    imgUp.Height = 12
                                    imgDn.ImageUrl = "~/Images/Plus.jpg"
                                    imgDn.Width = 20
                                    imgDn.Height = 12
                                    Td.Controls.Add(imgUp)
                                    Td.Controls.Add(imgDn)
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-left", "5px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                Else
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        lbl.Text = FormatNumber(ProdCount, 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                Else
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                Else
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                    End If
                                    Td.Controls.Add(lbl)
                                    'Td.CssClass = "AlterNateColor2"
                                    Td.Font.Bold = True
                                    Td.Style.Add("text-align", "Right")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-right", "10px")
                                    HeaderTdSetting(Td, "130px", "", "1")
                                End If
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            'Tr.CssClass = "header"

                            If filterCnt = 1 Then
                                tblCAGR.Controls.Add(Tr)
                                strRFilt = ""
                                For i = 1 To dsRows.Tables(0).Rows.Count
                                    If strRFilt1 = "" Then
                                        dvRptAct.RowFilter = " COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString()
                                    Else
                                        dvRptAct.RowFilter = strRFilt1 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString()
                                    End If
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Data" + i.ToString()
                                        Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Font.Size = 9
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = True
                                                Td.Style.Add("padding-left", "25px")
                                                HeaderTdSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt1 = "" Then
                                                        dvRptAct.RowFilter = "COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = strRFilt1 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            Else
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If
                                                    lbl.Text = FormatNumber(ProdCount, 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                    dtRptCols2 = dvRptCols2.ToTable()
                                                    If strRFilt1 = "" Then
                                                        dvRptAct.RowFilter = " COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = strRFilt1 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            Else
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If

                                                    If strRFilt1 = "" Then
                                                        dvRptAct.RowFilter = " COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = strRFilt1 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            Else
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If
                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                End If
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.CssClass = "AlterNateColor2"
                                                Td.Style.Add("text-align", "Right")
                                                Td.Style.Add("padding-right", "10px")
                                            End If
                                            Td.Font.Size = 8
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = False
                                            Tr.Controls.Add(Td)
                                        Next
                                        Tr.Height = 30
                                        tblCAGR.Controls.Add(Tr)
                                    End If
                                Next
                            Else
                                If arrRfilt(1) <> "REGION" And arrRfilt(1) <> "COUNTRY" And arrRfilt(1) <> "GROUP" Then
                                    dv2.RowFilter = strRFilt1
                                End If
                                dt2 = dv2.ToTable()
                                If dt2.Rows.Count > 0 Then
                                    tblCAGR.Controls.Add(Tr)
                                    For b = 0 To dt2.Rows.Count - 1
                                        strRFilt2 = ""
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                        Tr.Style.Add("display", "none")
                                        If arrRfilt(1) = "PRODUCT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            Else
                                                strRFilt2 = "CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "PACKAGE" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            Else
                                                strRFilt2 = "PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "GROUP" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            Else
                                                strRFilt2 = "SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "COUNTRY" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1
                                            End If
                                        ElseIf arrRfilt(1) = "REGION" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1
                                            End If
                                        End If
                                        dvRpt.RowFilter = strRFilt2
                                        dtRpt = dvRpt.ToTable()
                                        If dtRpt.Rows.Count > 0 Then
                                            For j = 0 To ColCnt
                                                If j = 0 Then
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    imgUp = New ImageButton
                                                    imgDn = New ImageButton
                                                    imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','-');"
                                                    imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','+');"
                                                    imgUp.Style.Add("display", "none")
                                                    lbl.Text = dt2.Rows(b).Item("VALUE").ToString()
                                                    lbl.CssClass = "Label"
                                                    imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                    imgUp.Width = 20
                                                    imgUp.Height = 12
                                                    imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                    imgDn.Width = 20
                                                    imgDn.Height = 12
                                                    Td.Controls.Add(imgUp)
                                                    Td.Controls.Add(imgDn)
                                                    Td.Controls.Add(lbl)
                                                    Td.Font.Size = 9
                                                    Td.Font.Bold = True
                                                    Td.Style.Add("text-align", "Left")
                                                    Td.Style.Add("padding-left", "25px")
                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                Else
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                        Dim ProdCount As New Double
                                                        dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        If UnitId = 1 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                Else
                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        If UnitId = 1 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If
                                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                    Else
                                                        Dim count1 As New Double
                                                        Dim count2 As New Double
                                                        Dim diff As New Double
                                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                        dtRptCols1 = dvRptCols1.ToTable()
                                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                        dtRptCols2 = dvRptCols2.ToTable()

                                                        dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        If UnitId = 1 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                Else
                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        If UnitId = 1 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If

                                                        dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        If UnitId = 1 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                Else
                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        If UnitId = 1 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If
                                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                    End If
                                                    Td.Controls.Add(lbl)
                                                    Td.CssClass = "AlterNateColor2"
                                                    Td.Style.Add("color", "#660022")
                                                    Td.Style.Add("padding-right", "10px")
                                                    Td.Style.Add("text-align", "Right")
                                                End If
                                                Td.Font.Size = 9
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = True
                                                Tr.Controls.Add(Td)
                                            Next
                                            Tr.Height = 30
                                            tblCAGR.Controls.Add(Tr)
                                        End If

                                        If filterCnt = 2 Then
                                            For i = 1 To dsRows.Tables(0).Rows.Count
                                                If strRFilt2 <> "" Then
                                                    dvRptAct.RowFilter = strRFilt2 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString()
                                                Else
                                                    dvRptAct.RowFilter = " COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString()
                                                End If
                                                dtRptAct = dvRptAct.ToTable()
                                                If dtRptAct.Rows.Count > 0 Then
                                                    Tr = New TableRow
                                                    Tr.CssClass = "Bhavesh"
                                                    Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Data" + i.ToString()
                                                    Tr.Style.Add("display", "none")
                                                    For j = 0 To ColCnt
                                                        If j = 0 Then
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.Style.Add("text-align", "Left")
                                                            Td.Style.Add("padding-left", "50px")
                                                            HeaderTdSetting(Td, "180px", "", "1")
                                                        Else
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                Dim ProdCount As New Double
                                                                If strRFilt2 = "" Then
                                                                    dvRptAct.RowFilter = "COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                Else
                                                                    dvRptAct.RowFilter = strRFilt2 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If UnitId = 1 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        Else
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If UnitId = 1 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                ElseIf UnitId = 3 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        End If
                                                                    Next
                                                                End If
                                                                lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                            Else
                                                                Dim count1 As New Double
                                                                Dim count2 As New Double
                                                                Dim diff As New Double
                                                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                dtRptCols1 = dvRptCols1.ToTable()
                                                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                dtRptCols2 = dvRptCols2.ToTable()
                                                                If strRFilt2 = "" Then
                                                                    dvRptAct.RowFilter = " COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                Else
                                                                    dvRptAct.RowFilter = strRFilt2 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If UnitId = 1 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        Else
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If UnitId = 1 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                ElseIf UnitId = 3 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        End If
                                                                    Next
                                                                End If

                                                                If strRFilt2 = "" Then
                                                                    dvRptAct.RowFilter = " COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                Else
                                                                    dvRptAct.RowFilter = strRFilt2 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If UnitId = 1 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        Else
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If UnitId = 1 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                ElseIf UnitId = 3 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        End If
                                                                    Next
                                                                End If
                                                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                            End If
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.CssClass = "AlterNateColor2"
                                                            Td.Style.Add("text-align", "Right")
                                                            Td.Style.Add("padding-right", "10px")
                                                        End If
                                                        Td.Font.Size = 8.5
                                                        Td.Font.Name = "Verdana"
                                                        Td.Font.Bold = False
                                                        Tr.Controls.Add(Td)
                                                    Next
                                                    Tr.Height = 30
                                                    tblCAGR.Controls.Add(Tr)
                                                End If
                                            Next
                                        Else
                                            If arrRfilt(2) <> "REGION" And arrRfilt(2) <> "COUNTRY" And arrRfilt(2) <> "GROUP" Then
                                                dv3.RowFilter = strRFilt2
                                            End If
                                            dt3 = dv3.ToTable()
                                            If dt3.Rows.Count > 0 Then
                                                For c = 0 To dt3.Rows.Count - 1
                                                    Tr = New TableRow()
                                                    Tr.CssClass = "Bhavesh"
                                                    Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                    Tr.Style.Add("display", "none")
                                                    strRFilt3 = ""
                                                    If arrRfilt(2) = "PRODUCT" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("CATEGORYID").ToString()
                                                        Else
                                                            strRFilt3 = strRFilt + "CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "PACKAGE" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "GROUP" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "COUNTRY" Then
                                                        strRFilt3 = strRFilt2
                                                    ElseIf arrRfilt(2) = "REGION" Then
                                                        strRFilt3 = strRFilt2
                                                    End If
                                                    dvRpt.RowFilter = strRFilt3
                                                    dtRpt = dvRpt.ToTable()
                                                    Dim Tot3 As New Double
                                                    If dtRpt.Rows.Count > 0 Then
                                                        For j = 0 To ColCnt
                                                            If j = 0 Then
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                imgUp = New ImageButton
                                                                imgDn = New ImageButton
                                                                imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','-');"
                                                                imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','+');"
                                                                imgUp.Style.Add("display", "none")
                                                                lbl.Text = dt3.Rows(c).Item("VALUE").ToString()
                                                                lbl.CssClass = "Label"
                                                                imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                                imgUp.Width = 20
                                                                imgUp.Height = 12
                                                                imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                                imgDn.Width = 20
                                                                imgDn.Height = 12
                                                                Td.Controls.Add(imgUp)
                                                                Td.Controls.Add(imgDn)
                                                                Td.Controls.Add(lbl)
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Bold = True
                                                                Td.Style.Add("text-align", "Left")
                                                                Td.Style.Add("padding-left", "50px")
                                                                HeaderTdSetting(Td, "180px", "", "1")
                                                            Else
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                'HeaderTdSetting(Td, "150px", "", "1")
                                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                    Dim ProdCount As New Double
                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If UnitId = 1 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            Else
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If UnitId = 1 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If
                                                                    lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                Else
                                                                    Dim count1 As New Double
                                                                    Dim count2 As New Double
                                                                    Dim diff As New Double
                                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                    dtRptCols2 = dvRptCols2.ToTable()

                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If UnitId = 1 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            Else
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If UnitId = 1 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If

                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If UnitId = 1 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            Else
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If UnitId = 1 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If
                                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                End If
                                                                Td.Controls.Add(lbl)
                                                                Td.CssClass = "AlterNateColor2"
                                                                Td.Style.Add("text-align", "Right")
                                                                Td.Style.Add("padding-right", "10px")
                                                            End If
                                                            Td.Font.Size = 8.5
                                                            Td.Font.Name = "Verdana"
                                                            Td.Font.Bold = True
                                                            Tr.Controls.Add(Td)
                                                        Next
                                                        Tr.Height = 30
                                                        tblCAGR.Controls.Add(Tr)
                                                    End If
                                                    For i = 1 To dsRows.Tables(0).Rows.Count
                                                        If strRFilt3 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt3 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = " COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            Tr = New TableRow
                                                            Tr.CssClass = "Bhavesh"
                                                            Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "_Data" + i.ToString()
                                                            Tr.Style.Add("display", "none")
                                                            Dim bFlag = False
                                                            For j = 0 To ColCnt
                                                                If j = 0 Then
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.Style.Add("text-align", "Left")
                                                                    Td.Style.Add("padding-left", "75px")
                                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                                Else
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                        Dim ProdCount As New Double
                                                                        dvRptAct.RowFilter = strRFilt3 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If UnitId = 1 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                Else
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If UnitId = 1 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If
                                                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                    Else
                                                                        Dim count1 As New Double
                                                                        Dim count2 As New Double
                                                                        Dim diff As New Double
                                                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                        dtRptCols1 = dvRptCols1.ToTable()
                                                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                        dtRptCols2 = dvRptCols2.ToTable()

                                                                        dvRptAct.RowFilter = strRFilt3 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If UnitId = 1 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                Else
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If UnitId = 1 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If

                                                                        dvRptAct.RowFilter = strRFilt3 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If UnitId = 1 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                Else
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If UnitId = 1 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If
                                                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                    End If
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.CssClass = "AlterNateColor2"
                                                                    Td.Style.Add("text-align", "Right")
                                                                    Td.Style.Add("padding-right", "10px")

                                                                    'If lbl.Text <> "0" Then
                                                                    '    bFlag = True
                                                                    'End If
                                                                End If
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Name = "Verdana"
                                                                Td.Font.Bold = False
                                                                Tr.Controls.Add(Td)
                                                            Next
                                                            Tr.Height = 30
                                                            'tblCAGR.Controls.Add(Tr)
                                                            'If bFlag = True Then
                                                            tblCAGR.Controls.Add(Tr)
                                                            ' End If
                                                        End If

                                                    Next
                                                Next
                                            End If
                                        End If
                                    Next
                                End If
                            End If
                        End If
                    Next

                    'Grand Total
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label
                            imgUp = New ImageButton
                            imgDn = New ImageButton
                            imgUp.ID = "Up_TotLayer"
                            imgUp.OnClientClick = "javascript:return ShowLines('TotLayer','-');"
                            imgDn.ID = "Dn_TotLayer"
                            imgDn.OnClientClick = "javascript:return ShowLines('TotLayer','+');"
                            imgUp.Style.Add("display", "none")
                            imgUp.ImageUrl = "~/Images/Minus.jpg"
                            imgUp.Width = 20
                            imgUp.Height = 12
                            imgDn.ImageUrl = "~/Images/Plus.jpg"
                            imgDn.Width = 20
                            imgDn.Height = 12
                            Td.Controls.Add(imgUp)
                            Td.Controls.Add(imgDn)
                            lbl.Text = "Grand Total" 'dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                            lbl.CssClass = "Label"
                            lbl.Width = 200
                            lbl.Style.Add("display", "inline")
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            lbl = New Label
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                Dim ProdCount As New Double
                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If
                                lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                            Else
                                Dim count1 As New Double
                                Dim count2 As New Double
                                Dim diff As New Double
                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                dtRptCols1 = dvRptCols1.ToTable()
                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                dtRptCols2 = dvRptCols2.ToTable()

                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If

                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If

                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                If count1 <> 0 And count2 <> 0 Then
                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                Else
                                    lbl.Text = FormatNumber(0, 4)
                                End If
                            End If
                            'Td.CssClass = "AlterNateColor2"
                            Td.Controls.Add(lbl)
                            Td.Font.Bold = True
                            Td.Style.Add("text-align", "Right")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-right", "10px")
                            HeaderTdSetting(Td, "130px", "", "1")
                        End If
                        Tr.Controls.Add(Td)
                    Next
                    tblCAGR.Controls.Add(Tr)

                    For i = 1 To dsRows.Tables(0).Rows.Count
                        dvRptAct.RowFilter = "COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString()
                        dtRptAct = dvRptAct.ToTable()
                        If dtRptAct.Rows.Count > 0 Then
                            Tr = New TableRow
                            Tr.CssClass = "Bhavesh"
                            Tr.ID = "TotLayer_Data" + i.ToString()
                            Tr.Style.Add("display", "none")
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-left", "25px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        dvRptAct.RowFilter = "COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                Else
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        lbl.Text = FormatNumber(ProdCount, 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()
                                        dvRptAct.RowFilter = "COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                Else
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        dvRptAct.RowFilter = "COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                Else
                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                    End If
                                    lbl.CssClass = "Label"
                                    Td.Controls.Add(lbl)
                                    Td.CssClass = "AlterNateColor2"
                                    Td.Style.Add("text-align", "Right")
                                    Td.Style.Add("padding-right", "10px")
                                End If
                                Td.Font.Size = 8
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = False
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            tblCAGR.Controls.Add(Tr)
                        End If
                    Next
                Else
                    For i = 1 To dsRows.Tables(0).Rows.Count
                        Tr = New TableRow
                        For j = 0 To ColCnt
                            If j = 0 Then
                                Td = New TableCell()
                                lbl = New Label
                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                lbl.CssClass = "Label"
                                Td.Controls.Add(lbl)
                                Td.Style.Add("text-align", "Left")
                                Td.Style.Add("padding-left", "5px")
                                HeaderTdSetting(Td, "180px", "", "1")
                            Else
                                Td = New TableCell()
                                Td.Text = "&nbsp;"
                                HeaderTdSetting(Td, "150px", "", "1")
                                Td.CssClass = "AlterNateColor2"
                            End If
                            Td.Font.Size = 8.5
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = False
                            Tr.Controls.Add(Td)
                        Next
                        Tr.Height = 30
                        tblCAGR.Controls.Add(Tr)
                    Next
                End If
            Else
                'RowCnt = objGetData.GetReportRegionCount(ddlRegionSet.SelectedValue)
                dsRows = objGetData.GetUsersDynamicReportRows(REPId.ToString())
                For i = 1 To dsRows.Tables(0).Rows.Count
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label

                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("ROWDECRIPTION").ToString()
                            lbl.CssClass = "Label"
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            Td.Text = "&nbsp;"
                            HeaderTdSetting(Td, "150px", "", "1")
                            Td.CssClass = "AlterNateColor2"
                        End If
                        Td.Font.Size = 8.5
                        Td.Font.Name = "Verdana"
                        Td.Font.Bold = False
                        Tr.Controls.Add(Td)
                    Next
                    Tr.Height = 30
                    tblCAGR.Controls.Add(Tr)
                Next
            End If

        Catch ex As Exception
            ErrorLable.Text = "Error:SetPivotCompReportFrameWorkTemp " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub SetPivotPackReportFrameWorkTemp(ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Dim YearId As String = ""
        Dim UnitId As String = ""
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsUnitPref As New DataSet
        Dim dsRep As New DataSet
        Dim RowCnt As New Integer
        Dim ColCnt As New Integer
        Dim filterCnt As New Integer
        Dim GrpId As String = ""
        Dim dsGrp As New DataSet
        Dim imgUp As New ImageButton
        Dim imgDn As New ImageButton
        Dim CompId As String = ""
        Dim dsComp As New DataSet
        Try
            If hidReport.Value <> "0" Then
                dsRep = Session("dsRep" + REPId.ToString())
                dsUnitPref = Session("dsPref" + REPId.ToString())
                dsRows = Session("dsRows" + REPId.ToString())
                dsCol = Session("dsColumns" + REPId.ToString())
                dsFilter = Session("dsFilters" + REPId.ToString())
            Else
                dsRep = objGetData.GetReportDetails(REPId.ToString())
                dsUnitPref = objGetData.GetPref(REPId.ToString())
                dsRows = objGetData.GetUsersDynamicReportRows(REPId.ToString())
                dsCol = objGetData.GetUsersDynamicReportCols(REPId.ToString())
                dsFilter = objGetData.GetUsersReportFilters(REPId.ToString())

                Session("dsRep" + REPId.ToString()) = dsRep
                Session("dsPref" + REPId.ToString()) = dsUnitPref
                Session("dsRows" + REPId.ToString()) = dsRows
                Session("dsColumns" + REPId.ToString()) = dsCol
                Session("dsFilters" + REPId.ToString()) = dsFilter

                hidReport.Value = "1"
            End If

            filterCnt = dsFilter.Tables(0).Rows.Count
            ColCnt = dsCol.Tables(0).Rows.Count
            For a = 0 To dsCol.Tables(0).Rows.Count - 1
                If dsCol.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    YearId = YearId + "" + dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
                End If
            Next
            YearId = YearId.Remove(YearId.Length - 1)
            UnitId = dsRows.Tables(0).Rows(0).Item("UNITID").ToString()

            dvCol = dsCol.Tables(0).DefaultView
            dvRptCols1 = dsCol.Tables(0).DefaultView
            dvRptCols2 = dsCol.Tables(0).DefaultView

            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()
                        Link.CssClass = "LinkM"
                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdSetting(HeaderTd, "150px", "", "1")
                    Next
                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink
                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)
            Next

            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            Dim dsTables As New DataSet
            Dim dvTables As New DataView
            Dim dtTables As New DataTable
            Dim ProdId As String = ""
            'Dim ProdTbl(11) As String
            Dim PackId As String = ""
            Dim dsProd As New DataSet
            Dim dvProd As New DataView
            Dim dtProd As New DataTable
            Dim dsPack As New DataSet
            Dim dvPack As New DataView
            Dim dtPack As New DataTable
            Dim dsOrder As New DataSet()
            Dim funflag As Boolean = False
            Dim MatId As String = ""
            Dim FactId As String = ""
            Dim dsMat As New DataSet
            Dim dsProdMat As New DataSet
            Dim arrRfilt(filterCnt) As String
            Dim CountryId As String = ""
            Dim RegionId As String = ""

            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            Dim ProdTbl(dsTables.Tables(0).Rows.Count - 1) As String

            For a = 0 To dsFilter.Tables(0).Rows.Count - 1
                If dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                    arrRfilt(a) = "PRODUCT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                            ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            RowCnt += 1
                        Next
                        dtTables = dsTables.Tables(0)
                        ProdId = ProdId.Remove(ProdId.Length - 1)
                        If MatId <> "" Then
                            dsProd = objGetData.GetPivotMatProducts(MatId, ProdId)
                        ElseIf CompId <> "" Then
                            dsProd = objGetData.GetPivotCompProducts(CompId, ProdId)

                            'New Add Started
                        ElseIf GrpId <> "" Then
                            dsProd = objGetData.GetPivotGRPProducts(ProdId, GrpId)
                            'New Add Ended
                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If

                        ProdId = ""
                        For b = 0 To dsProd.Tables(0).Rows.Count - 1
                            ProdId = ProdId + "" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + ","
                        Next
                        ProdId = ProdId.Remove(ProdId.Length - 1)

                    Else
                        ProdId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                        dtTables = dvTables.ToTable()
                        ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                        RowCnt += 1
                        If MatId <> "" Then
                            dsProd = objGetData.GetPivotMatProducts(MatId, ProdId)
                        ElseIf CompId <> "" Then
                            dsProd = objGetData.GetPivotCompProducts(CompId, ProdId)
                            'New Add Started
                        ElseIf GrpId <> "" Then
                            dsProd = objGetData.GetPivotGRPProducts(ProdId, GrpId)
                            'New Add Ended
                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                    End If

                    dsProd.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsProd.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsProd.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "MATERIAL" Then
                    arrRfilt(a) = "MATERIAL"
                    MatId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    If ProdId <> "" Then
                        dsMat = objGetData.GetPivotProdMaterials(ProdId, MatId)
                    Else
                        dsMat = objGetData.GetPivotMaterials(MatId)
                    End If

                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COMPONENT" Then
                    arrRfilt(a) = "COMPONENT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" Then
                            dsComp = objGetData.GetPivotProdComponents(ProdId, "")

                        Else
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            dsComp = objGetData.GetPivotAllComponents(ProdId1)
                        End If
                        For b = 0 To dsComp.Tables(0).Rows.Count - 1
                            CompId = CompId + "" + dsComp.Tables(0).Rows(b).Item("COMPONENTID").ToString() + ","
                        Next
                        CompId = CompId.Remove(CompId.Length - 1)
                    Else
                        CompId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" Then
                            dsComp = objGetData.GetPivotProdComponents(ProdId, CompId)
                        Else
                            dsComp = objGetData.GetRepComponent(CompId)
                        End If
                    End If

                    dsComp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsComp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsComp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COUNTRY" Then
                    arrRfilt(a) = "COUNTRY"
                    CountryId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotCountriesByRegion(CountryId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "REGION" Then
                    arrRfilt(a) = "REGION"
                    RegionId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotRegion(RegionId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "GROUP" Then
                    arrRfilt(a) = "GROUP"
                    GrpId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsGrp = objGetData.GetPivotGroups(GrpId)
                    dsGrp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsGrp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsGrp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                End If
            Next

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                Else
                                    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                                End If
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        End If
                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next

            Dim dv1 As New DataView
            Dim dv2 As New DataView
            Dim dv3 As New DataView
            Dim dt1 As New DataTable
            Dim dt2 As New DataTable
            Dim dt3 As New DataTable
            Dim dsRptAct As New DataSet
            Dim dvRptAct As New DataView
            Dim dtRptAct As New DataTable
            Dim strRFilt1 As String = ""
            Dim strRFilt2 As String = ""
            Dim strRFilt3 As String = ""

            If ProdTbl(0) = "" Then
                For b = 0 To dsTables.Tables(0).Rows.Count - 1
                    ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                    ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                    RowCnt += 1
                Next
                ProdId = ProdId.Remove(ProdId.Length - 1)
            End If

            Dim dvRpt As New DataView
            Dim dtRpt As New DataTable

            If funflag Then
                If filterCnt = 1 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                ElseIf filterCnt = 2 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                ElseIf filterCnt = 3 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                    dv3 = dsOrder.Tables(2).DefaultView
                End If

                If CompId <> "" Then
                    dsRows = objGetData.GetPivotComponentsPackages(ProdId, CompId)
                Else
                    dsRows = objGetData.GetPivotPackages(ProdId, MatId)
                End If

                dsRptAct = objGetData.GetPivotReportData_PACK(ProdTbl, YearId, ProdId, MatId, GrpId, CompId, CountryId, RegionId, UnitId, dsTables.Tables(0).Rows.Count)
                dvRptAct = dsRptAct.Tables(0).DefaultView
                dvRpt = dsRptAct.Tables(0).DefaultView
                If dsOrder.Tables(0).Rows.Count <> 0 Then
                    For a = 0 To dsOrder.Tables(0).Rows.Count - 1
                        strRFilt1 = ""
                        If arrRfilt(0) = "PRODUCT" Then
                            strRFilt1 = "CATEGORYID = " + dsOrder.Tables(0).Rows(a).Item("CATEGORYID").ToString()
                        ElseIf arrRfilt(0) = "MATERIAL" Then
                            strRFilt1 = "MATERIALID = " + dsOrder.Tables(0).Rows(a).Item("MATERIALID").ToString()
                        ElseIf arrRfilt(0) = "GROUP" Then
                            strRFilt1 = "SUBGROUPID = " + dsOrder.Tables(0).Rows(a).Item("SUBGROUPID").ToString()
                        ElseIf arrRfilt(0) = "COMPONENT" Then
                            strRFilt1 = "COMPONENTID = " + dsOrder.Tables(0).Rows(a).Item("COMPONENTID").ToString()
                        ElseIf arrRfilt(0) = "COUNTRY" Then

                        ElseIf arrRfilt(0) = "REGION" Then

                        End If
                        If strRFilt1 <> "" Then
                            dvRpt.RowFilter = strRFilt1
                        End If
                        dtRpt = dvRpt.ToTable()
                        If dtRpt.Rows.Count > 0 Then
                            Tr = New TableRow
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    imgUp = New ImageButton
                                    imgDn = New ImageButton
                                    imgUp.ID = "Up_Layer" + (a + 1).ToString()
                                    imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','-');"
                                    imgDn.ID = "Dn_Layer" + (a + 1).ToString()
                                    imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','+');"
                                    imgUp.Style.Add("display", "none")
                                    lbl.Text = dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    imgUp.ImageUrl = "~/Images/Minus.jpg"
                                    imgUp.Width = 20
                                    imgUp.Height = 12
                                    imgDn.ImageUrl = "~/Images/Plus.jpg"
                                    imgDn.Width = 20
                                    imgDn.Height = 12
                                    Td.Controls.Add(imgUp)
                                    Td.Controls.Add(imgDn)
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Style.Add("padding-left", "5px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()

                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        If count1 <> 0 And count2 <> 0 Then
                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        Else
                                            lbl.Text = FormatNumber(0, 4)
                                        End If
                                    End If
                                    Td.Controls.Add(lbl)
                                    Td.Font.Bold = True
                                    Td.Style.Add("text-align", "Right")
                                    Td.Style.Add("padding-right", "10px")
                                    HeaderTdSetting(Td, "130px", "", "1")
                                End If
                                Td.Font.Size = 9
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = True
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            'Tr.CssClass = "header"

                            If filterCnt = 1 Then
                                tblCAGR.Controls.Add(Tr)
                                For i = 1 To dsRows.Tables(0).Rows.Count
                                    'dvRptAct.RowFilter = strRFilt1 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString()
				       If strRFilt1 <> "" Then
                                        dvRptAct.RowFilter = strRFilt1 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString()
                                    Else
                                        dvRptAct.RowFilter = " PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString()
                                    End If
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Data" + i.ToString()
                                        Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Style.Add("padding-left", "25px")
                                                HeaderTdSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If
                                                    lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                    dtRptCols2 = dvRptCols2.ToTable()

                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = " PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If

                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = " PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If
                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                    If count1 <> 0 And count2 <> 0 Then
                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                    Else
                                                        lbl.Text = FormatNumber(0, 4)
                                                    End If
                                                End If
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Right")
                                                Td.Style.Add("padding-right", "10px")
                                                Td.CssClass = "AlterNateColor2"
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                            End If
                                            Td.Font.Size = 8.5
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = False
                                            Tr.Controls.Add(Td)
                                        Next
                                        Tr.Height = 30
                                        tblCAGR.Controls.Add(Tr)
                                    End If
                                Next
                            Else
                                If arrRfilt(1) <> "REGION" And arrRfilt(1) <> "COUNTRY" And arrRfilt(1) <> "GROUP" Then
                                    dv2.RowFilter = strRFilt1
                                End If
                                dt2 = dv2.ToTable()
                                If dt2.Rows.Count > 0 Then
                                    tblCAGR.Controls.Add(Tr)
                                    For b = 0 To dt2.Rows.Count - 1
                                        strRFilt2 = ""
                                        If arrRfilt(1) = "PRODUCT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            Else
                                                strRFilt2 = "CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "MATERIAL" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            Else
                                                strRFilt2 = "MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "GROUP" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            Else
                                                strRFilt2 = "SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "COMPONENT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND COMPONENTID = " + dt2.Rows(b).Item("COMPONENTID").ToString()
                                            Else
                                                strRFilt2 = "COMPONENTID = " + dt2.Rows(b).Item("COMPONENTID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "COUNTRY" Then
                                            strRFilt2 = strRFilt1
                                        ElseIf arrRfilt(1) = "REGION" Then
                                            strRFilt2 = strRFilt1
                                        End If

                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                        Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                imgUp = New ImageButton
                                                imgDn = New ImageButton
                                                imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','-');"
                                                imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','+');"
                                                imgUp.Style.Add("display", "none")
                                                lbl.Text = dt2.Rows(b).Item("VALUE").ToString()
                                                lbl.CssClass = "Label"
                                                imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                imgUp.Width = 20
                                                imgUp.Height = 12
                                                imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                imgDn.Width = 20
                                                imgDn.Height = 12
                                                Td.Controls.Add(imgUp)
                                                Td.Controls.Add(imgDn)
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Style.Add("padding-left", "25px")
                                                HeaderTdSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt2 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If
                                                    lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                    dtRptCols2 = dvRptCols2.ToTable()

                                                    If strRFilt2 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If

                                                    If strRFilt2 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If
                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                    If count1 <> 0 And count2 <> 0 Then
                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                    Else
                                                        lbl.Text = FormatNumber(0, 4)
                                                    End If
                                                End If
                                                Td.Controls.Add(lbl)
                                                Td.CssClass = "AlterNateColor2"
                                                Td.Style.Add("color", "#660022")
                                                Td.Style.Add("padding-right", "10px")
                                                Td.Style.Add("text-align", "Right")
                                            End If
                                            Td.Font.Size = 9
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = True
                                            Tr.Controls.Add(Td)
                                        Next

                                        Tr.Height = 30
                                        tblCAGR.Controls.Add(Tr)
                                        If filterCnt = 2 Then
                                            For i = 1 To dsRows.Tables(0).Rows.Count

                                                If strRFilt2 <> "" Then
                                                    dvRptAct.RowFilter = strRFilt2 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString()
                                                Else
                                                    dvRptAct.RowFilter = " PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString()
                                                End If
                                                dtRptAct = dvRptAct.ToTable()
                                                If dtRptAct.Rows.Count > 0 Then
                                                    Tr = New TableRow
                                                    Tr.CssClass = "Bhavesh"
                                                    Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Data" + i.ToString()
                                                    Tr.Style.Add("display", "none")
                                                    For j = 0 To ColCnt
                                                        If j = 0 Then
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.Style.Add("text-align", "Left")
                                                            Td.Style.Add("padding-left", "50px")
                                                            HeaderTdSetting(Td, "180px", "", "1")
                                                        Else
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                Dim ProdCount As New Double
                                                                If strRFilt2 <> "" Then
                                                                    dvRptAct.RowFilter = strRFilt2 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                Else
                                                                    dvRptAct.RowFilter = " PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                If UnitId = 1 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            Else
                                                                                If UnitId = 1 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                ElseIf UnitId = 3 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        End If
                                                                    Next
                                                                End If
                                                                lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                            Else
                                                                Dim count1 As New Double
                                                                Dim count2 As New Double
                                                                Dim diff As New Double
                                                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                dtRptCols1 = dvRptCols1.ToTable()
                                                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                dtRptCols2 = dvRptCols2.ToTable()

                                                                If strRFilt2 <> "" Then
                                                                    dvRptAct.RowFilter = strRFilt2 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                Else
                                                                    dvRptAct.RowFilter = " PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                If UnitId = 1 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            Else
                                                                                If UnitId = 1 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                ElseIf UnitId = 3 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        End If
                                                                    Next
                                                                End If

                                                                If strRFilt2 <> "" Then
                                                                    dvRptAct.RowFilter = strRFilt2 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                Else
                                                                    dvRptAct.RowFilter = " PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                If UnitId = 1 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            Else
                                                                                If UnitId = 1 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                ElseIf UnitId = 3 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        End If
                                                                    Next
                                                                End If
                                                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                If count1 <> 0 And count2 <> 0 Then
                                                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                Else
                                                                    lbl.Text = FormatNumber(0, 4)
                                                                End If
                                                            End If
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.CssClass = "AlterNateColor2"
                                                            Td.Style.Add("text-align", "Right")
                                                            Td.Style.Add("padding-right", "10px")
                                                        End If
                                                        Td.Font.Size = 8.5
                                                        Td.Font.Name = "Verdana"
                                                        Td.Font.Bold = False
                                                        Tr.Controls.Add(Td)
                                                    Next
                                                    Tr.Height = 30
                                                    tblCAGR.Controls.Add(Tr)
                                                End If

                                            Next
                                        Else
                                            If arrRfilt(2) <> "REGION" And arrRfilt(2) <> "COUNTRY" And arrRfilt(2) <> "GROUP" Then
                                                dv3.RowFilter = strRFilt2
                                            End If
                                            dt3 = dv3.ToTable()
                                            If dt3.Rows.Count > 0 Then
                                                For c = 0 To dt3.Rows.Count - 1
                                                    strRFilt3 = ""
                                                    If arrRfilt(2) = "PRODUCT" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("CATEGORYID").ToString()
                                                        Else
                                                            strRFilt3 = "CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "MATERIAL" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "GROUP" Then
                                                        If strRFilt3 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "COMPONENT" Then
                                                        If strRFilt3 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND COMPONENTID = " + dt3.Rows(c).Item("COMPONENTID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "COMPONENTID = " + dt3.Rows(c).Item("COMPONENTID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "COUNTRY" Then
                                                        strRFilt3 = strRFilt2
                                                    ElseIf arrRfilt(2) = "REGION" Then
                                                        strRFilt3 = strRFilt2
                                                    End If

                                                    'New Change started
                                                    dvRpt.RowFilter = strRFilt3
                                                    dtRpt = dvRpt.ToTable()
                                                    'New change ended
                                                    If dtRpt.Rows.Count > 0 Then
                                                        Tr = New TableRow
                                                        Tr.CssClass = "Bhavesh"
                                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                        Tr.Style.Add("display", "none")
                                                        For j = 0 To ColCnt
                                                            If j = 0 Then
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                imgUp = New ImageButton
                                                                imgDn = New ImageButton
                                                                imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','-');"
                                                                imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','+');"
                                                                imgUp.Style.Add("display", "none")
                                                                lbl.Text = dt3.Rows(c).Item("VALUE").ToString()
                                                                lbl.CssClass = "Label"
                                                                imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                                imgUp.Width = 20
                                                                imgUp.Height = 12
                                                                imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                                imgDn.Width = 20
                                                                imgDn.Height = 12
                                                                Td.Controls.Add(imgUp)
                                                                Td.Controls.Add(imgDn)
                                                                Td.Controls.Add(lbl)
                                                                Td.Style.Add("text-align", "Left")
                                                                Td.Style.Add("padding-left", "50px")
                                                                HeaderTdSetting(Td, "180px", "", "1")
                                                            Else
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                    Dim ProdCount As New Double
                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If
                                                                    lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                Else
                                                                    Dim count1 As New Double
                                                                    Dim count2 As New Double
                                                                    Dim diff As New Double
                                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                    dtRptCols2 = dvRptCols2.ToTable()

                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If

                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If
                                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                    If count1 <> 0 And count2 <> 0 Then
                                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                    Else
                                                                        lbl.Text = FormatNumber(0, 4)
                                                                    End If
                                                                End If
                                                                Td.Controls.Add(lbl)
                                                                Td.CssClass = "AlterNateColor2"
                                                                Td.Style.Add("text-align", "Right")
                                                                Td.Style.Add("padding-right", "10px")
                                                            End If
                                                            Td.Font.Size = 8.5
                                                            Td.Font.Name = "Verdana"
                                                            Td.Font.Bold = True
                                                            Tr.Controls.Add(Td)
                                                        Next
                                                        Tr.Height = 30
                                                        tblCAGR.Controls.Add(Tr)
                                                    End If
                                                    

                                                    For i = 1 To dsRows.Tables(0).Rows.Count
                                                        dvRptAct.RowFilter = strRFilt3 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString()
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            Tr = New TableRow
                                                            Tr.CssClass = "Bhavesh"
                                                            Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "_Data" + i.ToString()
                                                            Tr.Style.Add("display", "none")
                                                            For j = 0 To ColCnt
                                                                If j = 0 Then
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.Style.Add("text-align", "Left")
                                                                    Td.Style.Add("padding-left", "75px")
                                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                                Else
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                        Dim ProdCount As New Double
                                                                        dvRptAct.RowFilter = strRFilt3 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                        If UnitId = 1 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    Else
                                                                                        If UnitId = 1 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If
                                                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                    Else
                                                                        Dim count1 As New Double
                                                                        Dim count2 As New Double
                                                                        Dim diff As New Double
                                                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                        dtRptCols1 = dvRptCols1.ToTable()
                                                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                        dtRptCols2 = dvRptCols2.ToTable()

                                                                        dvRptAct.RowFilter = strRFilt3 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                        If UnitId = 1 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    Else
                                                                                        If UnitId = 1 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If

                                                                        dvRptAct.RowFilter = strRFilt3 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                        If UnitId = 1 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    Else
                                                                                        If UnitId = 1 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If
                                                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                        If count1 <> 0 And count2 <> 0 Then
                                                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                        Else
                                                                            lbl.Text = FormatNumber(0, 4)
                                                                        End If
                                                                    End If
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.CssClass = "AlterNateColor2"
                                                                    Td.Style.Add("text-align", "Right")
                                                                    Td.Style.Add("padding-right", "10px")
                                                                End If
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Name = "Verdana"
                                                                Td.Font.Bold = False
                                                                Tr.Controls.Add(Td)
                                                            Next
                                                            Tr.Height = 30
                                                            tblCAGR.Controls.Add(Tr)
                                                        End If
                                                    Next
                                                Next
                                            End If
                                        End If
                                    Next
                                End If
                            End If
                        End If
                    Next

                    'Grand Total
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label
                            imgUp = New ImageButton
                            imgDn = New ImageButton
                            imgUp.ID = "Up_TotLayer"
                            imgUp.OnClientClick = "javascript:return ShowLines('TotLayer','-');"
                            imgDn.ID = "Dn_TotLayer"
                            imgDn.OnClientClick = "javascript:return ShowLines('TotLayer','+');"
                            imgUp.Style.Add("display", "none")
                            imgUp.ImageUrl = "~/Images/Minus.jpg"
                            imgUp.Width = 20
                            imgUp.Height = 12
                            imgDn.ImageUrl = "~/Images/Plus.jpg"
                            imgDn.Width = 20
                            imgDn.Height = 12
                            Td.Controls.Add(imgUp)
                            Td.Controls.Add(imgDn)
                            lbl.Text = "Grand Total" 'dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                            lbl.CssClass = "Label"
                            lbl.Width = 200
                            lbl.Style.Add("display", "inline")
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            lbl = New Label
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                Dim ProdCount As New Double
                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If
                                lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                            Else
                                Dim count1 As New Double
                                Dim count2 As New Double
                                Dim diff As New Double
                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                dtRptCols1 = dvRptCols1.ToTable()
                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                dtRptCols2 = dvRptCols2.ToTable()

                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If

                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If

                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                If count1 <> 0 And count2 <> 0 Then
                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                Else
                                    lbl.Text = FormatNumber(0, 4)
                                End If
                            End If
                            'Td.CssClass = "AlterNateColor2"
                            Td.Controls.Add(lbl)
                            Td.Font.Bold = True
                            Td.Style.Add("text-align", "Right")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-right", "10px")
                            HeaderTdSetting(Td, "130px", "", "1")
                        End If
                        Tr.Controls.Add(Td)
                    Next
                    tblCAGR.Controls.Add(Tr)

                    For i = 1 To dsRows.Tables(0).Rows.Count
                        dvRptAct.RowFilter = "PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString()
                        dtRptAct = dvRptAct.ToTable()
                        If dtRptAct.Rows.Count > 0 Then
                            Tr = New TableRow
                            Tr.CssClass = "Bhavesh"
                            Tr.ID = "TotLayer_Data" + i.ToString()
                            Tr.Style.Add("display", "none")
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Style.Add("padding-left", "25px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        dvRptAct.RowFilter = "PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()

                                        dvRptAct.RowFilter = "PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        dvRptAct.RowFilter = "PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        If count1 <> 0 And count2 <> 0 Then
                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        Else
                                            lbl.Text = FormatNumber(0, 4)
                                        End If
                                    End If
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Right")
                                    Td.Style.Add("padding-right", "10px")
                                    Td.CssClass = "AlterNateColor2"
                                    lbl.CssClass = "Label"
                                    Td.Controls.Add(lbl)
                                End If
                                Td.Font.Size = 8.5
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = False
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            tblCAGR.Controls.Add(Tr)
                        End If
                    Next
                Else
                    For i = 1 To dsRows.Tables(0).Rows.Count
                        Tr = New TableRow
                        For j = 0 To ColCnt
                            If j = 0 Then
                                Td = New TableCell()
                                lbl = New Label

                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                lbl.CssClass = "Label"
                                Td.Controls.Add(lbl)
                                Td.Style.Add("text-align", "Left")
                                Td.Style.Add("padding-left", "5px")
                                HeaderTdSetting(Td, "180px", "", "1")
                            Else
                                Td = New TableCell()
                                Td.Text = "&nbsp;"
                                HeaderTdSetting(Td, "150px", "", "1")
                                Td.CssClass = "AlterNateColor2"
                            End If
                            Td.Font.Size = 8.5
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = False
                            Tr.Controls.Add(Td)
                        Next
                        Tr.Height = 30
                        tblCAGR.Controls.Add(Tr)
                    Next
                End If
            Else
                dsRows = objGetData.GetUsersDynamicReportRows(REPId.ToString())
                For i = 1 To dsRows.Tables(0).Rows.Count
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label
                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("ROWDECRIPTION").ToString()
                            lbl.CssClass = "Label"
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            Td.Text = "&nbsp;"
                            HeaderTdSetting(Td, "150px", "", "1")
                            Td.CssClass = "AlterNateColor2"
                        End If
                        Td.Font.Size = 8.5
                        Td.Font.Name = "Verdana"
                        Td.Font.Bold = False
                        Tr.Controls.Add(Td)
                    Next
                    Tr.Height = 30
                    tblCAGR.Controls.Add(Tr)
                Next
            End If

        Catch ex As Exception
            ErrorLable.Text = "Error:SetPivotPackReportFrameWorkTemp " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub SetPivotProdReportFrameWorkTemp(ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Dim YearId As String = ""
        Dim UnitId As String = ""
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsUnitPref As New DataSet
        Dim dsRep As New DataSet
        Dim RowCnt As New Integer
        Dim ColCnt As New Integer
        Dim filterCnt As New Integer
        Dim imgUp As New ImageButton
        Dim imgDn As New ImageButton
        Dim CompId As String = ""
        Dim dsComp As New DataSet
        Try
            'Checking for Edit
            If ViewState("Edit") = "Y" Then
                Flag = True
            Else
                Flag = False
            End If

            If hidReport.Value <> "0" Then
                dsRep = Session("dsRep" + REPId.ToString())
                dsUnitPref = Session("dsPref" + REPId.ToString())
                dsRows = Session("dsRows" + REPId.ToString())
                dsCol = Session("dsColumns" + REPId.ToString())
                dsFilter = Session("dsFilters" + REPId.ToString())
            Else
                dsRep = objGetData.GetReportDetails(REPId.ToString())
                dsUnitPref = objGetData.GetPref(REPId.ToString())
                dsRows = objGetData.GetUsersDynamicReportRows(REPId.ToString())
                dsCol = objGetData.GetUsersDynamicReportCols(REPId.ToString())
                dsFilter = objGetData.GetUsersReportFilters(REPId.ToString())

                Session("dsRep" + REPId.ToString()) = dsRep
                Session("dsPref" + REPId.ToString()) = dsUnitPref
                Session("dsRows" + REPId.ToString()) = dsRows
                Session("dsColumns" + REPId.ToString()) = dsCol
                Session("dsFilters" + REPId.ToString()) = dsFilter

                hidReport.Value = "1"
            End If

            filterCnt = dsFilter.Tables(0).Rows.Count
            ColCnt = dsCol.Tables(0).Rows.Count


            For a = 0 To dsCol.Tables(0).Rows.Count - 1
                If dsCol.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    YearId = YearId + "" + dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
                End If
            Next
            YearId = YearId.Remove(YearId.Length - 1)

            UnitId = dsRows.Tables(0).Rows(0).Item("UNITID").ToString()

            dvCol = dsCol.Tables(0).DefaultView
            dvRptCols1 = dsCol.Tables(0).DefaultView
            dvRptCols2 = dsCol.Tables(0).DefaultView
            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()
                        Link.CssClass = "LinkM"
                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdSetting(HeaderTd, "150px", "", "1")
                    Next
                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink
                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)
            Next

            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            Dim dsTables As New DataSet
            Dim dvTables As New DataView
            Dim dtTables As New DataTable
            Dim ProdId As String = ""
            'Dim ProdTbl(11) As String
            Dim PackId As String = ""
            Dim dsProd As New DataSet
            Dim dvProd As New DataView
            Dim dtProd As New DataTable
            Dim dsPack As New DataSet
            Dim dvPack As New DataView
            Dim dtPack As New DataTable
            Dim dsOrder As New DataSet()
            Dim funflag As Boolean = False
            Dim MatId As String = ""
            Dim FactId As String = ""
            Dim dsMat As New DataSet
            Dim dsProdMat As New DataSet
            Dim arrRfilt(filterCnt) As String
            Dim CountryId As String = ""
            Dim RegionId As String = ""
            Dim GrpId As String = ""
            Dim dsGrp As New DataSet

            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            Dim ProdTbl(dsTables.Tables(0).Rows.Count - 1) As String

            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                RowCnt += 1
            Next
            ProdId = ProdId.Remove(ProdId.Length - 1)

            For a = 0 To dsFilter.Tables(0).Rows.Count - 1
                If dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                    arrRfilt(a) = "PACKAGE"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        'If ProdId <> "" And MatId <> "" Then
                        'dsPack = objGetData.GetPivotProdMatPackages(ProdId, MatId, "")
                        'ElseIf ProdId <> "" Then
                        'dsPack = objGetData.GetPackages(ProdId)
                        'Else
                        If MatId <> "" Then
                            dsPack = objGetData.GetPivotMatAllPackages(ProdId, MatId)
                        ElseIf CompId <> "" Then
                            dsPack = objGetData.GetPivotCompAllPackages(ProdId, CompId)
                            'New Add Started
                        ElseIf GrpId <> "" Then
                            dsPack = objGetData.GetPivotGRPAllPackages(ProdId, GrpId, "")
                            'New Add Ended
                        Else
                            dsPack = objGetData.GetPackages(ProdId)
                        End If
                        'End If
                        For b = 0 To dsPack.Tables(0).Rows.Count - 1
                            PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("PACKAGETYPEID").ToString() + ","
                        Next
                        PackId = PackId.Remove(PackId.Length - 1)
                    Else
                        PackId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If MatId <> "" Then
                            dsPack = objGetData.GetPivotMatPackages(MatId, PackId)
                        ElseIf CompId <> "" Then
                            dsPack = objGetData.GetPivotCompPackages(PackId, CompId)
                            'New Add Started
                        ElseIf GrpId <> "" Then
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            dsPack = objGetData.GetPivotGRPAllPackages(ProdId1, GrpId, PackId)
                            'New Add Ended
                        Else
                            dsPack = objGetData.GetPivotPackages(PackId)
                        End If
                    End If

                    dsPack.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsPack.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsPack.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "MATERIAL" Then
                    arrRfilt(a) = "MATERIAL"
                    MatId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    If PackId <> "" Then
                        dsMat = objGetData.GetPivotPackMaterials(ProdId, PackId, MatId)
                    Else
                        dsMat = objGetData.GetPivotMaterials(MatId)
                    End If

                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COMPONENT" Then
                    arrRfilt(a) = "COMPONENT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If PackId <> "" Then
                            dsComp = objGetData.GetPivotPackComponents(ProdId, PackId, "")
                        Else
                            dsComp = objGetData.GetPivotAllComponents(ProdId)
                        End If

                        For b = 0 To dsComp.Tables(0).Rows.Count - 1
                            CompId = CompId + "" + dsComp.Tables(0).Rows(b).Item("COMPONENTID").ToString() + ","
                        Next
                        CompId = CompId.Remove(CompId.Length - 1)
                    Else
                        CompId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If PackId <> "" Then
                            dsComp = objGetData.GetPivotPackComponents(ProdId, PackId, CompId)
                        Else
                            dsComp = objGetData.GetRepComponent(CompId)
                        End If
                    End If
                    dsComp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsComp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsComp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COUNTRY" Then
                    arrRfilt(a) = "COUNTRY"
                    CountryId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotCountriesByRegion(CountryId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "REGION" Then
                    arrRfilt(a) = "REGION"
                    RegionId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotRegion(RegionId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "GROUP" Then
                    arrRfilt(a) = "GROUP"
                    GrpId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsGrp = objGetData.GetPivotGroups(GrpId)
                    dsGrp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsGrp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsGrp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                End If
            Next

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                Else
                                    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                                End If
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        End If
                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next

            Dim dv1 As New DataView
            Dim dv2 As New DataView
            Dim dv3 As New DataView
            Dim dt1 As New DataTable
            Dim dt2 As New DataTable
            Dim dt3 As New DataTable
            Dim dsRptAct As New DataSet
            Dim dvRptAct As New DataView
            Dim dtRptAct As New DataTable
            Dim strRFilt1 As String = ""
            Dim strRFilt2 As String = ""
            Dim strRFilt3 As String = ""

            If ProdTbl(0) = "" Then
                For b = 0 To dsTables.Tables(0).Rows.Count - 1
                    ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                    RowCnt += 1
                Next
            End If

            Dim dvRpt As New DataView
            Dim dtRpt As New DataTable

            If funflag Then
                If filterCnt = 1 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                ElseIf filterCnt = 2 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                ElseIf filterCnt = 3 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                    dv3 = dsOrder.Tables(2).DefaultView
                End If
                If CompId <> "" Then
                    dsRows = objGetData.GetPivotComponentsProducts(ProdId, PackId, CompId)
                Else
                    dsRows = objGetData.GetPivotProducts(ProdId, PackId, MatId)
                End If

                dsRptAct = objGetData.GetPivotReportData_PROD(ProdTbl, YearId, PackId, MatId, GrpId, CompId, CountryId, RegionId, UnitId, dsTables.Tables(0).Rows.Count)
                dvRptAct = dsRptAct.Tables(0).DefaultView
                dvRpt = dsRptAct.Tables(0).DefaultView
                If dsOrder.Tables(0).Rows.Count <> 0 Then
                    For a = 0 To dsOrder.Tables(0).Rows.Count - 1
                        If arrRfilt(0) = "PACKAGE" Then
                            strRFilt1 = "PACKAGETYPEID = " + dsOrder.Tables(0).Rows(a).Item("PACKAGETYPEID").ToString()
                        ElseIf arrRfilt(0) = "GROUP" Then
                            strRFilt1 = "SUBGROUPID = " + dsOrder.Tables(0).Rows(a).Item("SUBGROUPID").ToString()
                        ElseIf arrRfilt(0) = "MATERIAL" Then
                            strRFilt1 = "MATERIALID = " + dsOrder.Tables(0).Rows(a).Item("MATERIALID").ToString()
                        ElseIf arrRfilt(0) = "COMPONENT" Then
                            strRFilt1 = "COMPONENTID = " + dsOrder.Tables(0).Rows(a).Item("COMPONENTID").ToString()
                        ElseIf arrRfilt(0) = "COUNTRY" Then
                            'strRFilt1 = "COUNTRYID = " + dsOrder.Tables(0).Rows(a).Item("COUNTRYID").ToString()
                        ElseIf arrRfilt(0) = "REGION" Then

                        End If
                        dvRpt.RowFilter = strRFilt1
                        dtRpt = dvRpt.ToTable()
                        If dtRpt.Rows.Count > 0 Then
                            Tr = New TableRow
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    imgUp = New ImageButton
                                    imgDn = New ImageButton
                                    imgUp.ID = "Up_Layer" + (a + 1).ToString()
                                    imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','-');"
                                    imgDn.ID = "Dn_Layer" + (a + 1).ToString()
                                    imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','+');"
                                    imgUp.Style.Add("display", "none")
                                    lbl.Text = dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    imgUp.ImageUrl = "~/Images/Minus.jpg"
                                    imgUp.Width = 20
                                    imgUp.Height = 12
                                    imgDn.ImageUrl = "~/Images/Plus.jpg"
                                    imgDn.Width = 20
                                    imgDn.Height = 12
                                    Td.Controls.Add(imgUp)
                                    Td.Controls.Add(imgDn)
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Style.Add("padding-left", "5px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()

                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                            'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                            'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                                        ElseIf UnitId = 3 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                            'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                            'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                            'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                                        ElseIf UnitId = 3 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                            'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        If count1 <> 0 And count2 <> 0 Then
                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        Else
                                            lbl.Text = FormatNumber(0, 4)
                                        End If
                                    End If
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Right")
                                    Td.Style.Add("padding-right", "10px")
                                    HeaderTdSetting(Td, "130px", "", "1")
                                End If
                                Td.Font.Size = 9
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = True
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            'Tr.CssClass = "header"

                            If filterCnt = 1 Then
                                tblCAGR.Controls.Add(Tr)
                                For i = 1 To dsRows.Tables(0).Rows.Count
                                    If strRFilt1 <> "" Then
                                        dvRptAct.RowFilter = strRFilt1 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString()
                                    Else
                                        dvRptAct.RowFilter = "CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString()
                                    End If
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Data" + i.ToString()
                                        Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Style.Add("padding-left", "25px")
                                                HeaderTdSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + " "
                                                    Else
                                                        dvRptAct.RowFilter = "CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + " "
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If
                                                    lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                    dtRptCols2 = dvRptCols2.ToTable()

                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If

                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If
                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                    If count1 <> 0 And count2 <> 0 Then
                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                    Else
                                                        lbl.Text = FormatNumber(0, 4)
                                                    End If
                                                End If
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.CssClass = "AlterNateColor2"
                                                Td.Style.Add("text-align", "Right")
                                                Td.Style.Add("padding-right", "10px")
                                            End If
                                            Td.Font.Size = 8.5
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = False
                                            Tr.Controls.Add(Td)
                                        Next
                                        Tr.Height = 30
                                        tblCAGR.Controls.Add(Tr)
                                    End If
                                Next
                            Else
                                If arrRfilt(1) <> "REGION" And arrRfilt(1) <> "COUNTRY" And arrRfilt(1) <> "GROUP" Then
                                    dv2.RowFilter = strRFilt1
                                End If
                                dt2 = dv2.ToTable()
                                If dt2.Rows.Count > 0 Then
                                    tblCAGR.Controls.Add(Tr)
                                    For b = 0 To dt2.Rows.Count - 1
                                        strRFilt2 = ""
                                        If arrRfilt(1) = "PRODUCT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            Else
                                                strRFilt2 = "CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "MATERIAL" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            Else
                                                strRFilt2 = "MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "PACKAGE" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            Else
                                                strRFilt2 = "PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "COMPONENT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND COMPONENTID = " + dt2.Rows(b).Item("COMPONENTID").ToString()
                                            Else
                                                strRFilt2 = "COMPONENTID = " + dt2.Rows(b).Item("COMPONENTID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "GROUP" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            Else
                                                strRFilt2 = "SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "COUNTRY" Then
                                            strRFilt2 = strRFilt1
                                        ElseIf arrRfilt(1) = "REGION" Then
                                            strRFilt2 = strRFilt1
                                        End If
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                        Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                imgUp = New ImageButton
                                                imgDn = New ImageButton
                                                imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','-');"
                                                imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','+');"
                                                imgUp.Style.Add("display", "none")
                                                lbl.Text = dt2.Rows(b).Item("VALUE").ToString()
                                                lbl.CssClass = "Label"
                                                imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                imgUp.Width = 20
                                                imgUp.Height = 12
                                                imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                imgDn.Width = 20
                                                imgDn.Height = 12
                                                Td.Controls.Add(imgUp)
                                                Td.Controls.Add(imgDn)
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Style.Add("padding-left", "25px")
                                                HeaderTdSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt2 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + " "
                                                    Else
                                                        dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + " "
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If
                                                    lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                    dtRptCols2 = dvRptCols2.ToTable()
                                                    If strRFilt2 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If

                                                    If strRFilt2 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If
                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                    If count1 <> 0 And count2 <> 0 Then
                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                    Else
                                                        lbl.Text = FormatNumber(0, 4)
                                                    End If
                                                End If
                                                Td.Controls.Add(lbl)
                                                Td.CssClass = "AlterNateColor2"
                                                Td.Style.Add("color", "#660022")
                                                Td.Style.Add("padding-right", "10px")
                                                Td.Style.Add("text-align", "Right")
                                            End If
                                            Td.Font.Size = 9
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = True
                                            Tr.Controls.Add(Td)
                                            Tr.Height = 30
                                            tblCAGR.Controls.Add(Tr)
                                        Next

                                        If filterCnt = 2 Then
                                            For i = 1 To dsRows.Tables(0).Rows.Count
                                                dvRptAct.RowFilter = strRFilt2 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString()
                                                dtRptAct = dvRptAct.ToTable()
                                                If dtRptAct.Rows.Count > 0 Then
                                                    Tr = New TableRow
                                                    Tr.CssClass = "Bhavesh"
                                                    Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Data" + i.ToString()
                                                    Tr.Style.Add("display", "none")
                                                    For j = 0 To ColCnt
                                                        If j = 0 Then
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.Style.Add("text-align", "Left")
                                                            Td.Style.Add("padding-left", "50px")
                                                            HeaderTdSetting(Td, "180px", "", "1")
                                                        Else
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                Dim ProdCount As New Double
                                                                dvRptAct.RowFilter = strRFilt2 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + " "
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                If UnitId = 1 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            Else
                                                                                If UnitId = 1 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                ElseIf UnitId = 3 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        End If
                                                                    Next
                                                                End If
                                                                lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                            Else
                                                                Dim count1 As New Double
                                                                Dim count2 As New Double
                                                                Dim diff As New Double
                                                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                dtRptCols1 = dvRptCols1.ToTable()
                                                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                dtRptCols2 = dvRptCols2.ToTable()

                                                                dvRptAct.RowFilter = strRFilt2 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                If UnitId = 1 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            Else
                                                                                If UnitId = 1 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                ElseIf UnitId = 3 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        End If
                                                                    Next
                                                                End If
                                                                dvRptAct.RowFilter = strRFilt2 + " AND CATEGORYID=" + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    For l = 0 To dtRptAct.Rows.Count - 1
                                                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                If UnitId = 1 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            Else
                                                                                If UnitId = 1 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                ElseIf UnitId = 2 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                ElseIf UnitId = 3 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                ElseIf UnitId = 4 Then
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                Else
                                                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                End If
                                                                            End If
                                                                        End If
                                                                    Next
                                                                End If
                                                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                If count1 <> 0 And count2 <> 0 Then
                                                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                Else
                                                                    lbl.Text = FormatNumber(0, 4)
                                                                End If
                                                            End If
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.CssClass = "AlterNateColor2"
                                                            Td.Style.Add("text-align", "Right")
                                                            Td.Style.Add("padding-right", "10px")
                                                        End If
                                                        Td.Font.Size = 8.5
                                                        Td.Font.Name = "Verdana"
                                                        Td.Font.Bold = False
                                                        Tr.Controls.Add(Td)
                                                    Next
                                                    Tr.Height = 30
                                                    tblCAGR.Controls.Add(Tr)
                                                End If
                                            Next
                                        Else
                                            If arrRfilt(2) <> "REGION" And arrRfilt(2) <> "COUNTRY" And arrRfilt(2) <> "GROUP" Then
                                                dv3.RowFilter = strRFilt2
                                            End If
                                            dt3 = dv3.ToTable()
                                            If dt3.Rows.Count > 0 Then
                                                For c = 0 To dt3.Rows.Count - 1
                                                    strRFilt3 = ""
                                                    If arrRfilt(2) = "PRODUCT" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                        Else
                                                            strRFilt3 = "CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "MATERIAL" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString()
                                                        Else
                                                            strRFilt3 = "MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "GROUP" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                        Else
                                                            strRFilt3 = "SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "COMPONENT" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND COMPONENTID = " + dt3.Rows(c).Item("COMPONENTID").ToString()
                                                        Else
                                                            strRFilt3 = "COMPONENTID = " + dt3.Rows(c).Item("COMPONENTID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "PACKAGE" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "COUNTRY" Then
                                                        strRFilt3 = strRFilt2
                                                    ElseIf arrRfilt(2) = "REGION" Then
                                                        strRFilt3 = strRFilt2
                                                    End If
                                                    dvRpt.RowFilter = strRFilt3
                                                    dtRpt = dvRpt.ToTable()
                                                    Dim tot3 As New Double
                                                    If dtRpt.Rows.Count > 1 Then
                                                        Tr = New TableRow
                                                        Tr.CssClass = "Bhavesh"
                                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                        Tr.Style.Add("display", "none")
                                                        For j = 0 To ColCnt
                                                            If j = 0 Then
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                imgUp = New ImageButton
                                                                imgDn = New ImageButton
                                                                imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','-');"
                                                                imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','+');"
                                                                imgUp.Style.Add("display", "none")
                                                                lbl.Text = dt3.Rows(c).Item("VALUE").ToString()
                                                                lbl.CssClass = "Label"
                                                                imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                                imgUp.Width = 20
                                                                imgUp.Height = 12
                                                                imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                                imgDn.Width = 20
                                                                imgDn.Height = 12
                                                                Td.Controls.Add(imgUp)
                                                                Td.Controls.Add(imgDn)
                                                                Td.Controls.Add(lbl)
                                                                Td.Style.Add("text-align", "Left")
                                                                Td.Style.Add("padding-left", "50px")
                                                                HeaderTdSetting(Td, "180px", "", "1")
                                                            Else
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                    Dim ProdCount As New Double
                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + " "
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() Then
                                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                        If UnitId = 1 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    Else
                                                                                        If UnitId = 1 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If
                                                                    lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                Else
                                                                    Dim count1 As New Double
                                                                    Dim count2 As New Double
                                                                    Dim diff As New Double
                                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                    dtRptCols2 = dvRptCols2.ToTable()

                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If
                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If
                                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                    If count1 <> 0 And count2 <> 0 Then
                                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                    Else
                                                                        lbl.Text = FormatNumber(0, 4)
                                                                    End If
                                                                End If
                                                                Td.Controls.Add(lbl)
                                                                Td.CssClass = "AlterNateColor2"
                                                                Td.Style.Add("text-align", "Right")
                                                                Td.Style.Add("padding-right", "10px")
                                                            End If
                                                            Td.Font.Size = 8.5
                                                            Td.Font.Name = "Verdana"
                                                            Td.Font.Bold = True
                                                            Tr.Controls.Add(Td)
                                                        Next
                                                        Tr.Height = 30
                                                        tblCAGR.Controls.Add(Tr)
                                                    End If

                                                    For i = 1 To dsRows.Tables(0).Rows.Count
                                                        If strRFilt3 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt3 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then

                                                            Tr = New TableRow
                                                            Tr.CssClass = "Bhavesh"
                                                            Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "_Data" + i.ToString()
                                                            Tr.Style.Add("display", "none")
                                                            For j = 0 To ColCnt
                                                                If j = 0 Then
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.Style.Add("text-align", "Left")
                                                                    Td.Style.Add("padding-left", "75px")
                                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                                Else
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    dvRptAct.RowFilter = strRFilt3 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString()
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                            Dim ProdCount As New Double
                                                                            dvRptAct.RowFilter = strRFilt3 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + " "
                                                                            dtRptAct = dvRptAct.ToTable()
                                                                            If dtRptAct.Rows.Count > 0 Then
                                                                                For l = 0 To dtRptAct.Rows.Count - 1
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                            If UnitId = 1 Then
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            ElseIf UnitId = 2 Then
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            ElseIf UnitId = 4 Then
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            Else
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            End If
                                                                                        Else
                                                                                            If UnitId = 1 Then
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                            ElseIf UnitId = 2 Then
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                            ElseIf UnitId = 3 Then
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                            ElseIf UnitId = 4 Then
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            Else
                                                                                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            End If
                                                                                        End If
                                                                                    End If
                                                                                Next
                                                                            End If
                                                                            lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                        Else
                                                                            Dim count1 As New Double
                                                                            Dim count2 As New Double
                                                                            Dim diff As New Double
                                                                            dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                            dtRptCols1 = dvRptCols1.ToTable()
                                                                            dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                            dtRptCols2 = dvRptCols2.ToTable()

                                                                            dvRptAct.RowFilter = strRFilt3 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                            dtRptAct = dvRptAct.ToTable()
                                                                            If dtRptAct.Rows.Count > 0 Then
                                                                                For l = 0 To dtRptAct.Rows.Count - 1
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                            If UnitId = 1 Then
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            ElseIf UnitId = 2 Then
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            ElseIf UnitId = 4 Then
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            Else
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            End If
                                                                                        Else
                                                                                            If UnitId = 1 Then
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                            ElseIf UnitId = 2 Then
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                            ElseIf UnitId = 3 Then
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                            ElseIf UnitId = 4 Then
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            Else
                                                                                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            End If
                                                                                        End If
                                                                                    End If
                                                                                Next
                                                                            End If
                                                                            dvRptAct.RowFilter = strRFilt3 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                            dtRptAct = dvRptAct.ToTable()
                                                                            If dtRptAct.Rows.Count > 0 Then
                                                                                For l = 0 To dtRptAct.Rows.Count - 1
                                                                                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                            If UnitId = 1 Then
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            ElseIf UnitId = 2 Then
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            ElseIf UnitId = 4 Then
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            Else
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            End If
                                                                                        Else
                                                                                            If UnitId = 1 Then
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                            ElseIf UnitId = 2 Then
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                            ElseIf UnitId = 3 Then
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                            ElseIf UnitId = 4 Then
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            Else
                                                                                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                            End If
                                                                                        End If
                                                                                    End If
                                                                                Next
                                                                            End If
                                                                            diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                            If count1 <> 0 And count2 <> 0 Then
                                                                                lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                            Else
                                                                                lbl.Text = FormatNumber(0, 4)
                                                                            End If

                                                                        End If
                                                                        'lbl.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 2)
                                                                    End If
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.CssClass = "AlterNateColor2"
                                                                    Td.Style.Add("text-align", "Right")
                                                                    Td.Style.Add("padding-right", "10px")
                                                                End If
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Name = "Verdana"
                                                                Td.Font.Bold = False
                                                                Tr.Controls.Add(Td)
                                                            Next
                                                            Tr.Height = 30
                                                            tblCAGR.Controls.Add(Tr)
                                                        End If

                                                    Next
                                                Next
                                            End If
                                        End If
                                    Next
                                End If
                            End If
                        End If
                    Next

                    'Grand Total
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label
                            imgUp = New ImageButton
                            imgDn = New ImageButton
                            imgUp.ID = "Up_TotLayer"
                            imgUp.OnClientClick = "javascript:return ShowLines('TotLayer','-');"
                            imgDn.ID = "Dn_TotLayer"
                            imgDn.OnClientClick = "javascript:return ShowLines('TotLayer','+');"
                            imgUp.Style.Add("display", "none")
                            imgUp.ImageUrl = "~/Images/Minus.jpg"
                            imgUp.Width = 20
                            imgUp.Height = 12
                            imgDn.ImageUrl = "~/Images/Plus.jpg"
                            imgDn.Width = 20
                            imgDn.Height = 12
                            Td.Controls.Add(imgUp)
                            Td.Controls.Add(imgDn)
                            lbl.Text = "Grand Total" 'dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                            lbl.CssClass = "Label"
                            lbl.Width = 200
                            lbl.Style.Add("display", "inline")
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            lbl = New Label
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                Dim ProdCount As New Double
                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If
                                lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                            Else
                                Dim count1 As New Double
                                Dim count2 As New Double
                                Dim diff As New Double
                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                dtRptCols1 = dvRptCols1.ToTable()
                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                dtRptCols2 = dvRptCols2.ToTable()

                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If

                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If

                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                If count1 <> 0 And count2 <> 0 Then
                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                Else
                                    lbl.Text = FormatNumber(0, 4)
                                End If
                            End If
                            'Td.CssClass = "AlterNateColor2"
                            Td.Controls.Add(lbl)
                            Td.Font.Bold = True
                            Td.Style.Add("text-align", "Right")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-right", "10px")
                            HeaderTdSetting(Td, "130px", "", "1")
                        End If
                        Tr.Controls.Add(Td)
                    Next
                    tblCAGR.Controls.Add(Tr)

                    For i = 1 To dsRows.Tables(0).Rows.Count
                        'If strRFilt1 <> "" Then
                            'dvRptAct.RowFilter = strRFilt1 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString()
                        'Else
                            dvRptAct.RowFilter = "CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString()
                       ' End If
                        dtRptAct = dvRptAct.ToTable()
                        If dtRptAct.Rows.Count > 0 Then
                            Tr = New TableRow
                            Tr.CssClass = "Bhavesh"
                            Tr.ID = "TotLayer_Data" + i.ToString()
                            Tr.Style.Add("display", "none")
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Style.Add("padding-left", "25px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        dvRptAct.RowFilter = "CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + " "
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()

                                        dvRptAct.RowFilter = "CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        dvRptAct.RowFilter = "CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        If count1 <> 0 And count2 <> 0 Then
                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        Else
                                            lbl.Text = FormatNumber(0, 4)
                                        End If
                                    End If
                                    lbl.CssClass = "Label"
                                    Td.Controls.Add(lbl)
                                    Td.CssClass = "AlterNateColor2"
                                    Td.Style.Add("text-align", "Right")
                                    Td.Style.Add("padding-right", "10px")
                                End If
                                Td.Font.Size = 8.5
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = False
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            tblCAGR.Controls.Add(Tr)
                        End If
                    Next
                Else
                    For i = 1 To dsRows.Tables(0).Rows.Count
                        Tr = New TableRow
                        For j = 0 To ColCnt
                            If j = 0 Then
                                Td = New TableCell()
                                lbl = New Label

                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                lbl.CssClass = "Label"
                                Td.Controls.Add(lbl)
                                Td.Style.Add("text-align", "Left")
                                Td.Style.Add("padding-left", "5px")
                                HeaderTdSetting(Td, "180px", "", "1")
                            Else
                                Td = New TableCell()
                                Td.Text = "&nbsp;"
                                HeaderTdSetting(Td, "150px", "", "1")
                                Td.CssClass = "AlterNateColor2"
                            End If
                            Td.Font.Size = 8.5
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = False
                            Tr.Controls.Add(Td)
                        Next
                        Tr.Height = 30
                        tblCAGR.Controls.Add(Tr)
                    Next
                End If
            Else
                'RowCnt = objGetData.GetReportRegionCount(ddlRegionSet.SelectedValue)
                dsRows = objGetData.GetUsersDynamicReportRows(REPId.ToString())
                For i = 1 To dsRows.Tables(0).Rows.Count
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label
                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("ROWDECRIPTION").ToString()
                            lbl.CssClass = "Label"
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            Td.Text = "&nbsp;"
                            HeaderTdSetting(Td, "150px", "", "1")
                            Td.CssClass = "AlterNateColor2"
                        End If
                        Td.Font.Size = 8.5
                        Td.Font.Name = "Verdana"
                        Td.Font.Bold = False
                        Tr.Controls.Add(Td)
                    Next
                    Tr.Height = 30
                    tblCAGR.Controls.Add(Tr)
                Next
            End If

        Catch ex As Exception
            ErrorLable.Text = "Error:SetPivotProdReportFrameWorkTemp " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub SetPivotGrpReportFrameWorkTemp(ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Dim YearId As String = ""
        Dim UnitId As String = ""
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsUnitPref As New DataSet
        Dim dsRep As New DataSet
        Dim RowCnt As New Integer
        Dim ColCnt As New Integer
        Dim filterCnt As New Integer
        Dim imgUp As New ImageButton
        Dim imgDn As New ImageButton
        Try
            'Checking for Edit
            If ViewState("Edit") = "Y" Then
                Flag = True
            Else
                Flag = False
            End If

            If hidReport.Value <> "0" Then
                dsRep = Session("dsRep" + REPId.ToString())
                dsUnitPref = Session("dsPref" + REPId.ToString())
                dsRows = Session("dsRows" + REPId.ToString())
                dsCol = Session("dsColumns" + REPId.ToString())
                dsFilter = Session("dsFilters" + REPId.ToString())
            Else
                dsRep = objGetData.GetReportDetails(REPId.ToString())
                dsUnitPref = objGetData.GetPref(REPId.ToString())
                dsRows = objGetData.GetUsersDynamicReportRows(REPId.ToString())
                dsCol = objGetData.GetUsersDynamicReportCols(REPId.ToString())
                dsFilter = objGetData.GetUsersReportFilters(REPId.ToString())

                Session("dsRep" + REPId.ToString()) = dsRep
                Session("dsPref" + REPId.ToString()) = dsUnitPref
                Session("dsRows" + REPId.ToString()) = dsRows
                Session("dsColumns" + REPId.ToString()) = dsCol
                Session("dsFilters" + REPId.ToString()) = dsFilter

                hidReport.Value = "1"
            End If

            filterCnt = dsFilter.Tables(0).Rows.Count
            ColCnt = dsCol.Tables(0).Rows.Count

            For a = 0 To dsCol.Tables(0).Rows.Count - 1
                If dsCol.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    YearId = YearId + "" + dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
                End If
            Next
            YearId = YearId.Remove(YearId.Length - 1)

            UnitId = dsRows.Tables(0).Rows(0).Item("UNITID").ToString()

            dvCol = dsCol.Tables(0).DefaultView
            dvRptCols1 = dsCol.Tables(0).DefaultView
            dvRptCols2 = dsCol.Tables(0).DefaultView
            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()
                        Link.CssClass = "LinkM"
                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdSetting(HeaderTd, "150px", "", "1")
                    Next
                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink
                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)
            Next

            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            Dim dsTables As New DataSet
            Dim dvTables As New DataView
            Dim dtTables As New DataTable
            Dim ProdId As String = ""
            'Dim ProdTbl(11) As String
            Dim PackId As String = ""
            Dim dsProd As New DataSet
            Dim dvProd As New DataView
            Dim dtProd As New DataTable
            Dim dsPack As New DataSet
            Dim dvPack As New DataView
            Dim dtPack As New DataTable
            Dim dsOrder As New DataSet()
            Dim funflag As Boolean = False
            Dim MatId As String = ""
            Dim FactId As String = ""
            Dim dsMat As New DataSet
            Dim dsProdMat As New DataSet
            Dim arrRfilt(filterCnt) As String
            Dim CountryId As String = ""
            Dim RegionId As String = ""

            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            Dim ProdTbl(dsTables.Tables(0).Rows.Count - 1) As String

            For a = 0 To dsFilter.Tables(0).Rows.Count - 1
                If dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                    arrRfilt(a) = "PRODUCT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                            ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            RowCnt += 1
                        Next
                        dtTables = dsTables.Tables(0)
                        ProdId = ProdId.Remove(ProdId.Length - 1)
                        If PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)

                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                        ProdId = ""
                        For b = 0 To dsProd.Tables(0).Rows.Count - 1
                            ProdId = ProdId + "" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + ","
                        Next
                        ProdId = ProdId.Remove(ProdId.Length - 1)

                    Else
                        ProdId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                        dtTables = dvTables.ToTable()
                        ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                        RowCnt += 1
                        If PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)
                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                    End If

                    dsProd.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsProd.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsProd.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                    arrRfilt(a) = "PACKAGE"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, "")
                        Else
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                                ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                                RowCnt += 1
                            Next
                            dtTables = dsTables.Tables(0)
                            ProdId = ProdId.Remove(ProdId.Length - 1)
                            If MatId <> "" Then
                                dsPack = objGetData.GetPivotMatAllPackages(ProdId, MatId)
                            Else
                                dsPack = objGetData.GetPackages(ProdId)
                            End If
                        End If
                        For b = 0 To dsPack.Tables(0).Rows.Count - 1
                            PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("PACKAGETYPEID").ToString() + ","
                        Next
                        PackId = PackId.Remove(PackId.Length - 1)
                    Else
                        PackId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, PackId)
                        Else
                            dsPack = objGetData.GetPivotPackages(PackId)
                        End If
                    End If

                    dsPack.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsPack.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsPack.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "MATERIAL" Then
                    arrRfilt(a) = "MATERIAL"
                    MatId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    If PackId <> "" Then
                        dsMat = objGetData.GetPivotPackMaterials(ProdId, PackId, MatId)
                    Else
                        dsMat = objGetData.GetPivotMaterials(MatId)
                    End If

                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COUNTRY" Then
                    arrRfilt(a) = "COUNTRY"
                    CountryId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotCountriesByRegion(CountryId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "REGION" Then
                    arrRfilt(a) = "REGION"
                    RegionId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotRegion(RegionId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                End If
            Next

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                Else
                                    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                                End If
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        End If
                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next

            Dim dv1 As New DataView
            Dim dv2 As New DataView
            Dim dv3 As New DataView
            Dim dt1 As New DataTable
            Dim dt2 As New DataTable
            Dim dt3 As New DataTable
            Dim dsRptAct As New DataSet
            Dim dvRptAct As New DataView
            Dim dtRptAct As New DataTable
            Dim strRFilt1 As String = ""
            Dim strRFilt2 As String = ""
            Dim strRFilt3 As String = ""

            If ProdTbl(0) = "" Then
                For b = 0 To dsTables.Tables(0).Rows.Count - 1
                    ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                    RowCnt += 1
                Next
            End If

            Dim dvRpt As New DataView
            Dim dtRpt As New DataTable

            If funflag Then
                If filterCnt = 1 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                ElseIf filterCnt = 2 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                ElseIf filterCnt = 3 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                    dv3 = dsOrder.Tables(2).DefaultView
                End If

                dsRows = objGetData.GetPivotGroupList(dsRep.Tables(0).Rows(0).Item("REGIONSETID").ToString())
                dsRptAct = objGetData.GetPivotReportData_GRP(ProdTbl, YearId, PackId, MatId, CountryId, RegionId, UnitId, dsTables.Tables(0).Rows.Count)
                dvRptAct = dsRptAct.Tables(0).DefaultView
                dvRpt = dsRptAct.Tables(0).DefaultView
                If dsOrder.Tables(0).Rows.Count <> 0 Then
                    For a = 0 To dsOrder.Tables(0).Rows.Count - 1
                        If arrRfilt(0) = "PRODUCT" Then
                            strRFilt1 = "CATEGORYID = " + dsOrder.Tables(0).Rows(a).Item("CATEGORYID").ToString()
                        ElseIf arrRfilt(0) = "PACKAGE" Then
                            strRFilt1 = "PACKAGETYPEID = " + dsOrder.Tables(0).Rows(a).Item("PACKAGETYPEID").ToString()
                        ElseIf arrRfilt(0) = "MATERIAL" Then
                            strRFilt1 = "MATERIALID = " + dsOrder.Tables(0).Rows(a).Item("MATERIALID").ToString()
                        ElseIf arrRfilt(0) = "COUNTRY" Then
                            'dvRpt.RowFilter = "COUNTRYID = " + dsOrder.Tables(0).Rows(a).Item("COUNTRYID").ToString()
                        ElseIf arrRfilt(0) = "REGION" Then
                            'dvRpt.RowFilter = "REGIONID = " + dsOrder.Tables(0).Rows(a).Item("REGIONID").ToString()
                        End If
                        dvRpt.RowFilter = strRFilt1
                        dtRpt = dvRpt.ToTable()
                        If dtRpt.Rows.Count > 0 Then
                            Tr = New TableRow
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    imgUp = New ImageButton
                                    imgDn = New ImageButton
                                    imgUp.ID = "Up_Layer" + (a + 1).ToString()
                                    imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','-');"
                                    imgDn.ID = "Dn_Layer" + (a + 1).ToString()
                                    imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','+');"
                                    imgUp.Style.Add("display", "none")
                                    lbl.Text = dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    imgUp.ImageUrl = "~/Images/Minus.jpg"
                                    imgUp.Width = 20
                                    imgUp.Height = 12
                                    imgDn.ImageUrl = "~/Images/Plus.jpg"
                                    imgDn.Width = 20
                                    imgDn.Height = 12
                                    Td.Controls.Add(imgUp)
                                    Td.Controls.Add(imgDn)
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Style.Add("padding-left", "5px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    HeaderTdSetting(Td, "130px", "", "1")
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()

                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        If count1 <> 0 And count2 <> 0 Then
                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        Else
                                            lbl.Text = FormatNumber(0, 4)
                                        End If
                                    End If
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Right")
                                    Td.Style.Add("padding-right", "10px")
                                    'Td.CssClass = "AlterNateColor2"
                                End If
                                Td.Font.Size = 9
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = True
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30

                            If filterCnt = 1 Then
                                tblCAGR.Controls.Add(Tr)
                                For i = 1 To dsRows.Tables(0).Rows.Count
                                    If strRFilt1 = "" Then
                                        dvRptAct.RowFilter = " SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString()
                                    Else
                                        dvRptAct.RowFilter = strRFilt1 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString()
                                    End If
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Data" + i.ToString()
                                        Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Style.Add("padding-left", "50px")
                                                HeaderTdSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If
                                                    lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                    dtRptCols2 = dvRptCols2.ToTable()

                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = " SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If

                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                Else
                                                                    If UnitId = 1 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    ElseIf UnitId = 2 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    ElseIf UnitId = 3 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    ElseIf UnitId = 4 Then
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    Else
                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    End If
                                                                End If
                                                            End If
                                                        Next
                                                    End If

                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                    If count1 <> 0 And count2 <> 0 Then
                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                    Else
                                                        lbl.Text = FormatNumber(0, 4)
                                                    End If
                                                End If
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.CssClass = "AlterNateColor2"
                                                Td.Style.Add("text-align", "Right")
                                                Td.Style.Add("padding-right", "10px")
                                            End If
                                            Td.Font.Size = 8.5
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = False
                                            Tr.Controls.Add(Td)
                                        Next
                                        Tr.Height = 30
                                        tblCAGR.Controls.Add(Tr)
                                    End If
                                Next
                            Else
                                If arrRfilt(1) <> "REGION" And arrRfilt(1) <> "COUNTRY" Then
                                    dv2.RowFilter = strRFilt1
                                End If
                                dt2 = dv2.ToTable()
                                If dt2.Rows.Count > 0 Then
                                    tblCAGR.Controls.Add(Tr)
                                    For b = 0 To dt2.Rows.Count - 1
                                        strRFilt2 = ""
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                        Tr.Style.Add("display", "none")
                                        If arrRfilt(1) = "PRODUCT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            Else
                                                strRFilt2 = "CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            End If

                                        ElseIf arrRfilt(1) = "PACKAGE" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            Else
                                                strRFilt2 = "PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            End If

                                        ElseIf arrRfilt(1) = "MATERIAL" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            Else
                                                strRFilt2 = "MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            End If

                                        ElseIf arrRfilt(1) = "COUNTRY" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1
                                            End If

                                        ElseIf arrRfilt(1) = "REGION" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1
                                            End If
                                        End If
                                        dvRpt.RowFilter = strRFilt2
                                        dtRpt = dvRpt.ToTable()
                                        If dtRpt.Rows.Count > 0 Then
                                            For j = 0 To ColCnt
                                                If j = 0 Then
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    imgUp = New ImageButton
                                                    imgDn = New ImageButton
                                                    imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','-');"
                                                    imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','+');"
                                                    imgUp.Style.Add("display", "none")
                                                    lbl.Text = dt2.Rows(b).Item("VALUE").ToString()
                                                    lbl.CssClass = "Label"
                                                    imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                    imgUp.Width = 20
                                                    imgUp.Height = 12
                                                    imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                    imgDn.Width = 20
                                                    imgDn.Height = 12
                                                    Td.Controls.Add(imgUp)
                                                    Td.Controls.Add(imgDn)
                                                    Td.Controls.Add(lbl)
                                                    Td.Style.Add("text-align", "Left")
                                                    Td.Style.Add("padding-left", "25px")
                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                Else
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                        Dim ProdCount As New Double
                                                        If strRFilt2 <> "" Then
                                                            dvRpt.RowFilter = strRFilt2 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        Else
                                                            dvRpt.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        If UnitId = 1 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    Else
                                                                        If UnitId = 1 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If
                                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                    Else
                                                        Dim count1 As New Double
                                                        Dim count2 As New Double
                                                        Dim diff As New Double
                                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                        dtRptCols1 = dvRptCols1.ToTable()
                                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                        dtRptCols2 = dvRptCols2.ToTable()

                                                        If strRFilt2 <> "" Then
                                                            dvRpt.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        Else
                                                            dvRpt.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        If UnitId = 1 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    Else
                                                                        If UnitId = 1 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If

                                                        If strRFilt2 <> "" Then
                                                            dvRpt.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        Else
                                                            dvRpt.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        If UnitId = 1 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    Else
                                                                        If UnitId = 1 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        ElseIf UnitId = 2 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        ElseIf UnitId = 3 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        ElseIf UnitId = 4 Then
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        Else
                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        End If
                                                                    End If
                                                                End If
                                                            Next
                                                        End If

                                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                        If count1 <> 0 And count2 <> 0 Then
                                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                        Else
                                                            lbl.Text = FormatNumber(0, 4)
                                                        End If
                                                    End If
                                                    Td.Controls.Add(lbl)
                                                    Td.CssClass = "AlterNateColor2"
                                                    Td.Style.Add("color", "#660022")
                                                    Td.Style.Add("text-align", "Right")
                                                    Td.Style.Add("padding-right", "10px")
                                                End If
                                                Td.Font.Size = 9
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = True
                                                Tr.Controls.Add(Td)
                                            Next
                                            'End If

                                            Tr.Height = 30
                                            tblCAGR.Controls.Add(Tr)
                                            If filterCnt = 2 Then
                                                For i = 1 To dsRows.Tables(0).Rows.Count
                                                    If strRFilt2 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt2 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = " SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    Dim Tot3 As New Double
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        Tr = New TableRow
                                                        Tr.CssClass = "Bhavesh"
                                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Data" + i.ToString()
                                                        Tr.Style.Add("display", "none")
                                                        For j = 0 To ColCnt
                                                            If j = 0 Then
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                                lbl.CssClass = "Label"
                                                                Td.Controls.Add(lbl)
                                                                Td.Style.Add("text-align", "Left")
                                                                Td.Style.Add("padding-left", "50px")
                                                                HeaderTdSetting(Td, "180px", "", "1")
                                                            Else
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                    Dim ProdCount As New Double
                                                                    If strRFilt2 <> "" Then
                                                                        dvRptAct.RowFilter = strRFilt2 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    Else
                                                                        dvRptAct.RowFilter = "SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    End If
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If
                                                                    lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                Else
                                                                    Dim count1 As New Double
                                                                    Dim count2 As New Double
                                                                    Dim diff As New Double
                                                                    dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                    dtRptCols1 = dvRptCols1.ToTable()
                                                                    dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                    dtRptCols2 = dvRptCols2.ToTable()

                                                                    If strRFilt2 <> "" Then
                                                                        dvRptAct.RowFilter = strRFilt2 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    Else
                                                                        dvRptAct.RowFilter = " SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    End If
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If

                                                                    If strRFilt2 <> "" Then
                                                                        dvRptAct.RowFilter = strRFilt2 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    Else
                                                                        dvRptAct.RowFilter = "SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    End If
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        For l = 0 To dtRptAct.Rows.Count - 1
                                                                            If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    If UnitId = 1 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                Else
                                                                                    If UnitId = 1 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    ElseIf UnitId = 2 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    ElseIf UnitId = 3 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    ElseIf UnitId = 4 Then
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    Else
                                                                                        count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    End If
                                                                                End If
                                                                            End If
                                                                        Next
                                                                    End If

                                                                    diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                    If count2 = 0 Or count1 = 0 Then
                                                                        lbl.Text = "0.0000"
                                                                    Else
                                                                        lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                    End If
                                                                End If
                                                                lbl.CssClass = "Label"
                                                                Td.Controls.Add(lbl)
                                                                Td.CssClass = "AlterNateColor2"
                                                                Td.Style.Add("text-align", "Right")
                                                                Td.Style.Add("padding-right", "10px")
                                                            End If
                                                            Td.Font.Size = 8.5
                                                            Td.Font.Name = "Verdana"
                                                            Td.Font.Bold = False
                                                            Tr.Controls.Add(Td)
                                                        Next
                                                        Tr.Height = 30
                                                        tblCAGR.Controls.Add(Tr)
                                                    End If
                                                Next
                                            Else
                                                If arrRfilt(2) <> "REGION" And arrRfilt(2) <> "COUNTRY" Then
                                                    dv3.RowFilter = strRFilt2
                                                End If
                                                dt3 = dv3.ToTable()
                                                If dt3.Rows.Count > 0 Then
                                                    For c = 0 To dt3.Rows.Count - 1
                                                        strRFilt3 = ""
                                                        If arrRfilt(2) = "PRODUCT" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2 + " AND CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("CATEGORYID").ToString()
                                                            Else
                                                                strRFilt3 = "CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                            End If
                                                        ElseIf arrRfilt(2) = "PACKAGE" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2 + " AND PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                            Else
                                                                strRFilt3 = "PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                            End If
                                                        ElseIf arrRfilt(2) = "MATERIAL" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2 + " AND MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                            Else
                                                                strRFilt3 = "MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString()
                                                            End If
                                                        ElseIf arrRfilt(2) = "COUNTRY" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2
                                                            End If
                                                        ElseIf arrRfilt(2) = "REGION" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2
                                                            End If
                                                        End If
                                                        dvRpt.RowFilter = strRFilt3
                                                        dtRpt = dvRpt.ToTable()
                                                        If dtRpt.Rows.Count > 0 Then
                                                            Tr = New TableRow
                                                            Tr = New TableRow
                                                            Tr.CssClass = "Bhavesh"
                                                            Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                            Tr.Style.Add("display", "none")
                                                            For j = 0 To ColCnt
                                                                If j = 0 Then
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    imgUp = New ImageButton
                                                                    imgDn = New ImageButton
                                                                    imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                    imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','-');"
                                                                    imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                    imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','+');"
                                                                    imgUp.Style.Add("display", "none")
                                                                    lbl.Text = dt3.Rows(c).Item("VALUE").ToString()
                                                                    lbl.CssClass = "Label"
                                                                    imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                                    imgUp.Width = 20
                                                                    imgUp.Height = 12
                                                                    imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                                    imgDn.Width = 20
                                                                    imgDn.Height = 12
                                                                    Td.Controls.Add(imgUp)
                                                                    Td.Controls.Add(imgDn)
                                                                    Td.Controls.Add(lbl)
                                                                    Td.Style.Add("text-align", "Left")
                                                                    Td.Style.Add("padding-left", "50px")
                                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                                Else
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                        Dim ProdCount As New Double
                                                                        dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                        If UnitId = 1 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    Else
                                                                                        If UnitId = 1 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If
                                                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                    Else
                                                                        Dim count1 As New Double
                                                                        Dim count2 As New Double
                                                                        Dim diff As New Double
                                                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                        dtRptCols1 = dvRptCols1.ToTable()
                                                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                        dtRptCols2 = dvRptCols2.ToTable()

                                                                        dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                        If UnitId = 1 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    Else
                                                                                        If UnitId = 1 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If

                                                                        dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                        If UnitId = 1 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    Else
                                                                                        If UnitId = 1 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If

                                                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                        If count1 <> 0 And count2 <> 0 Then
                                                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                        Else
                                                                            lbl.Text = FormatNumber(0, 4)
                                                                        End If
                                                                    End If
                                                                    Td.Controls.Add(lbl)
                                                                    Td.CssClass = "AlterNateColor2"
                                                                    Td.Style.Add("text-align", "Right")
                                                                    Td.Style.Add("padding-right", "10px")
                                                                End If
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Name = "Verdana"
                                                                Td.Font.Bold = True
                                                                Tr.Controls.Add(Td)
                                                            Next
                                                            Tr.Height = 30
                                                            tblCAGR.Controls.Add(Tr)
                                                        End If

                                                        For i = 1 To dsRows.Tables(0).Rows.Count
                                                            Tr = New TableRow
                                                            Tr.CssClass = "Bhavesh"
                                                            Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "_Data" + i.ToString()
                                                            Tr.Style.Add("display", "none")
                                                            For j = 0 To ColCnt
                                                                If j = 0 Then
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.Style.Add("text-align", "Left")
                                                                    Td.Style.Add("padding-left", "75px")
                                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                                Else
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                        Dim ProdCount As New Double
                                                                        dvRptAct.RowFilter = strRFilt3 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                        If UnitId = 1 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    Else
                                                                                        If UnitId = 1 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If
                                                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                                                    Else
                                                                        Dim count1 As New Double
                                                                        Dim count2 As New Double
                                                                        Dim diff As New Double
                                                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                        dtRptCols1 = dvRptCols1.ToTable()
                                                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                        dtRptCols2 = dvRptCols2.ToTable()

                                                                        dvRptAct.RowFilter = strRFilt3 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                        If UnitId = 1 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    Else
                                                                                        If UnitId = 1 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If

                                                                        dvRptAct.RowFilter = strRFilt3 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                        If UnitId = 1 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    Else
                                                                                        If UnitId = 1 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                        ElseIf UnitId = 2 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                        ElseIf UnitId = 3 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                        ElseIf UnitId = 4 Then
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        Else
                                                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                        End If
                                                                                    End If
                                                                                End If
                                                                            Next
                                                                        End If

                                                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                        If count1 <> 0 And count2 <> 0 Then
                                                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                        Else
                                                                            lbl.Text = FormatNumber(0, 4)
                                                                        End If
                                                                    End If
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.CssClass = "AlterNateColor2"
                                                                    Td.Style.Add("text-align", "Right")
                                                                    Td.Style.Add("padding-right", "10px")
                                                                End If
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Name = "Verdana"
                                                                Td.Font.Bold = False
                                                                Tr.Controls.Add(Td)
                                                            Next
                                                            Tr.Height = 30
                                                            tblCAGR.Controls.Add(Tr)
                                                        Next
                                                    Next
                                                End If
                                            End If
                                        End If
                                    Next
                                End If
                            End If
                        End If
                    Next

                    'Grand Total
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label
                            imgUp = New ImageButton
                            imgDn = New ImageButton
                            imgUp.ID = "Up_TotLayer"
                            imgUp.OnClientClick = "javascript:return ShowLines('TotLayer','-');"
                            imgDn.ID = "Dn_TotLayer"
                            imgDn.OnClientClick = "javascript:return ShowLines('TotLayer','+');"
                            imgUp.Style.Add("display", "none")
                            imgUp.ImageUrl = "~/Images/Minus.jpg"
                            imgUp.Width = 20
                            imgUp.Height = 12
                            imgDn.ImageUrl = "~/Images/Plus.jpg"
                            imgDn.Width = 20
                            imgDn.Height = 12
                            Td.Controls.Add(imgUp)
                            Td.Controls.Add(imgDn)
                            lbl.Text = "Grand Total" 'dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                            lbl.CssClass = "Label"
                            lbl.Width = 200
                            lbl.Style.Add("display", "inline")
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            lbl = New Label
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                Dim ProdCount As New Double
                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If
                                lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                            Else
                                Dim count1 As New Double
                                Dim count2 As New Double
                                Dim diff As New Double
                                dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                dtRptCols1 = dvRptCols1.ToTable()
                                dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                dtRptCols2 = dvRptCols2.ToTable()

                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If

                                'If strRFilt1 <> "" Then
                                'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                'Else
                                dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                'End If
                                dtRptAct = dvRptAct.ToTable()
                                If dtRptAct.Rows.Count > 0 Then
                                    For l = 0 To dtRptAct.Rows.Count - 1
                                        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                If UnitId = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                ElseIf UnitId = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            Else
                                                If UnitId = 1 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                ElseIf UnitId = 2 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                ElseIf UnitId = 3 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                ElseIf UnitId = 4 Then
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                Else
                                                    count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                End If
                                            End If
                                        End If
                                    Next
                                End If

                                diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                If count1 <> 0 And count2 <> 0 Then
                                    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                Else
                                    lbl.Text = FormatNumber(0, 4)
                                End If
                            End If
                            'Td.CssClass = "AlterNateColor2"
                            Td.Controls.Add(lbl)
                            Td.Font.Bold = True
                            Td.Style.Add("text-align", "Right")
                            Td.Font.Size = 9
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = True
                            Td.Style.Add("padding-right", "10px")
                            HeaderTdSetting(Td, "130px", "", "1")
                        End If
                        Tr.Controls.Add(Td)
                    Next
                    tblCAGR.Controls.Add(Tr)

                    For i = 1 To dsRows.Tables(0).Rows.Count
                        'If strRFilt1 = "" Then
                        '    dvRptAct.RowFilter = " SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString()
                        'Else
                        '    dvRptAct.RowFilter = strRFilt1 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString()
                        'End If
                        dvRptAct.RowFilter = " SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString()
                        dtRptAct = dvRptAct.ToTable()
                        If dtRptAct.Rows.Count > 0 Then
                            Tr = New TableRow
                            Tr.CssClass = "Bhavesh"
                            Tr.ID = "TotLayer_Data" + i.ToString()
                            Tr.Style.Add("display", "none")
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Style.Add("padding-left", "50px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        dvRptAct.RowFilter = "SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If
                                        lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        dtRptCols1 = dvRptCols1.ToTable()
                                        dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        dtRptCols2 = dvRptCols2.ToTable()

                                        dvRptAct.RowFilter = " SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        dvRptAct.RowFilter = "SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            For l = 0 To dtRptAct.Rows.Count - 1
                                                If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    Else
                                                        If UnitId = 1 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        ElseIf UnitId = 2 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        ElseIf UnitId = 3 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        ElseIf UnitId = 4 Then
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        Else
                                                            count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        End If
                                                    End If
                                                End If
                                            Next
                                        End If

                                        diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        If count1 <> 0 And count2 <> 0 Then
                                            lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        Else
                                            lbl.Text = FormatNumber(0, 4)
                                        End If
                                    End If
                                    lbl.CssClass = "Label"
                                    Td.Controls.Add(lbl)
                                    Td.CssClass = "AlterNateColor2"
                                    Td.Style.Add("text-align", "Right")
                                    Td.Style.Add("padding-right", "10px")
                                End If
                                Td.Font.Size = 8.5
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = False
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            tblCAGR.Controls.Add(Tr)
                        End If
                    Next
                Else
                    For i = 1 To dsRows.Tables(0).Rows.Count
                        Tr = New TableRow
                        For j = 0 To ColCnt
                            If j = 0 Then
                                Td = New TableCell()
                                lbl = New Label
                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                lbl.CssClass = "Label"
                                Td.Controls.Add(lbl)
                                Td.Style.Add("text-align", "Left")
                                Td.Style.Add("padding-left", "5px")
                                HeaderTdSetting(Td, "180px", "", "1")
                            Else
                                Td = New TableCell()
                                Td.Text = "&nbsp;"
                                HeaderTdSetting(Td, "150px", "", "1")
                                Td.CssClass = "AlterNateColor2"
                            End If
                            Td.Font.Size = 8.5
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = False
                            Tr.Controls.Add(Td)
                        Next
                        Tr.Height = 30
                        tblCAGR.Controls.Add(Tr)
                    Next
                End If
            Else
                dsRows = objGetData.GetUsersDynamicReportRows(REPId.ToString())
                For i = 1 To dsRows.Tables(0).Rows.Count
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label
                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("ROWDECRIPTION").ToString()
                            lbl.CssClass = "Label"
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            Td.Text = "&nbsp;"
                            HeaderTdSetting(Td, "150px", "", "1")
                            Td.CssClass = "AlterNateColor2"
                        End If
                        Td.Font.Size = 8.5
                        Td.Font.Name = "Verdana"
                        Td.Font.Bold = False
                        Tr.Controls.Add(Td)
                    Next
                    Tr.Height = 30
                    tblCAGR.Controls.Add(Tr)
                Next
            End If

        Catch ex As Exception
            ErrorLable.Text = "Error:SetPivotGrpReportFrameWork " + ex.Message.ToString()
        End Try
    End Sub
#End Region
End Class
